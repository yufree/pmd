<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reactomics • pmd</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Reactomics">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-58201304-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-58201304-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pmd</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/globalstd.html">Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis</a>
    </li>
    <li>
      <a href="../articles/reactomics.html">Reactomics</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/yufree/pmd/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Reactomics</h1>
                        <h4 data-toc-skip class="author">Miao Yu</h4>
            
            <h4 data-toc-skip class="date">2025-05-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/yufree/pmd/blob/master/vignettes/reactomics.Rmd" class="external-link"><code>vignettes/reactomics.Rmd</code></a></small>
      <div class="hidden name"><code>reactomics.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yufree.github.io/pmd/" class="external-link">pmd</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"spmeinvivo"</span><span class="op">)</span></span></code></pre></div>
<p>PMD based Reactomics tried to evaluate untargeted HRMS profiles at
reaction level. Reactomics is the extension of structure/reaction
directed analysis for HRMS data and PMDs are treated as relationship
unit for further discussion as compounds for metabolomics. Reaction
level evaluation could be found in PMD network analysis, Source
appointment and biomarker reaction discovery.</p>
<div class="section level2">
<h2 id="pmd-network-analysis">PMD network analysis<a class="anchor" aria-label="anchor" href="#pmd-network-analysis"></a>
</h2>
<p>In untargeted metabolites profiles from HRMS, two ions or peaks could
be treated together as long as they could be connected by relationship.
Regular untargeted workflow prefers intensity correlation between
compounds. However, PMD could also be the chemical bridge between two
compounds or ions. For example, oxidation would add oxygen atom to the
parent compound and introduce a PMD 15.995 Da. Meanwhile, One peak or
compound could be involved in multiple reactions. In this case, we could
build PMD network for certain ion or compound.</p>
<p>However, we need to the PMDs list to build such network for either
one compound or one sample. One way is using the high frequency PMDs
list from previous reported reactions and another way is using the high
frequency PMDs within certain data set such as KEGG or HMDB. The former
way try to focus on known reactions such as Phase I reactions for
exogenous compounds while the latter way is useful to explorer new
reactions or unknown reaction patterns within the data set. The latter
way is actually the structure/reaction directed analysis.</p>
<p>PMD network analysis is the analysis to check or explorer the PMD
relationship among co-existed ions from one sample or multiple samples.
The edge between ions in the network means certain PMD relationship are
valid in this data set. Meanwhile, the intensity correlation between
paired ions could also be considered to connect the vertices. Such
network is build based on local recursive search for all possible
connections.</p>
<p>PMD network analysis is useful to screen metabolites. Regular
metabolites discovery method try to predict metabolites’ MS2 spectra and
then match the data. In PMD network analysis, metabolites are predicted
by high frequency PMD or preferred PMD list within the MS1 data and such
prediction could be extended to the metabolites of metabolites. Such PMD
search will stop when no new metabolites could be connected to the
network. Such searching method is much easier and quick to get the
overview of metabolites networks. Identification could follow the
discovery from MS1 data.</p>
<p>If you have a specific compound and want to check the metabolites of
certain PMD, you could use <code>getchain</code> to extract the network
of that compounds</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r.igraph.org/" class="external-link">igraph</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'igraph'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     decompose, spectrum</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     union</span></span>
<span><span class="co"># check metabolites of C18H39NO</span></span>
<span><span class="co"># Use common PMDs for biological reactions</span></span>
<span><span class="va">chain</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getchain.html">getchain</a></span><span class="op">(</span><span class="va">spmeinvivo</span>,diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.02</span>,<span class="fl">14.02</span>,<span class="fl">15.99</span>,<span class="fl">58.04</span>,<span class="fl">13.98</span><span class="op">)</span>,mass <span class="op">=</span> <span class="fl">286.3101</span>,digits <span class="op">=</span> <span class="fl">2</span>,corcutoff <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co"># show as network</span></span>
<span><span class="va">net</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/graph_from_data_frame.html" class="external-link">graph_from_data_frame</a></span><span class="op">(</span><span class="va">chain</span><span class="op">$</span><span class="va">sdac</span>,directed <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">pal</span> <span class="op">&lt;-</span> <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">net</span>,vertex.label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">name</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>,vertex.size <span class="op">=</span><span class="fl">5</span>,edge.width <span class="op">=</span> <span class="fl">3</span>,edge.color <span class="op">=</span> <span class="va">pal</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">diff2</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>,vertex.label.dist<span class="op">=</span><span class="fl">1</span>,vertex.color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">name</span><span class="op">)</span>,<span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">286.3101</span>,<span class="st">'red'</span>,<span class="st">'black'</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">'PMD network'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>,bty <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>       legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">diff2</span><span class="op">)</span>,</span>
<span>       fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">pal</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">diff2</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, border<span class="op">=</span><span class="cn">NA</span>,horiz <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p><img src="reactomics_files/figure-html/tarnet-1.png" width="700"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Consider the correlation coefficient cutoff</span></span>
<span><span class="va">chain</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getchain.html">getchain</a></span><span class="op">(</span><span class="va">spmeinvivo</span>,diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.02</span>,<span class="fl">14.02</span>,<span class="fl">15.99</span>,<span class="fl">58.04</span>,<span class="fl">13.98</span><span class="op">)</span>,mass <span class="op">=</span> <span class="fl">286.3101</span>,digits <span class="op">=</span> <span class="fl">2</span>,corcutoff <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span>
<span><span class="co"># show as network</span></span>
<span><span class="va">net</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/graph_from_data_frame.html" class="external-link">graph_from_data_frame</a></span><span class="op">(</span><span class="va">chain</span><span class="op">$</span><span class="va">sdac</span>,directed <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">pal</span> <span class="op">&lt;-</span> <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">net</span>,vertex.label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">name</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>,vertex.size <span class="op">=</span><span class="fl">5</span>,edge.width <span class="op">=</span> <span class="fl">3</span>,edge.color <span class="op">=</span> <span class="va">pal</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">diff2</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>,vertex.label.dist<span class="op">=</span><span class="fl">1</span>,vertex.color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">name</span><span class="op">)</span>,<span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">286.3101</span>,<span class="st">'red'</span>,<span class="st">'black'</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">'PMD network'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>,bty <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>       legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">diff2</span><span class="op">)</span>,</span>
<span>       fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">pal</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">diff2</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, border<span class="op">=</span><span class="cn">NA</span>,horiz <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p><img src="reactomics_files/figure-html/tarnet-2.png" width="700"></p>
<p>Here only three PMD relationship could be found for C18H39NO. The
duplicate edges between two vertices or self-loop edges mean isomer
related PMD reactions. If we consider the correlation, the network would
be trimmed. Since reaction might not always involve correlation, PMD
network analysis could found more potential metabolites.</p>
<p>If you want to see all the independent peaks’ high frequency PMDs as
networks for certain sample, the following code will help. This part
will use the high frequency PMDs cutoff 12 from the data to build the
networks for all the independent peaks.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">std</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/globalstd.html">globalstd</a></span><span class="op">(</span><span class="va">spmeinvivo</span>,sda <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="co">#&gt; 75 retention time clusters found.</span></span>
<span><span class="co">#&gt; Using ng = 15</span></span>
<span><span class="co">#&gt; 5 unique PMDs retained.</span></span>
<span><span class="co">#&gt; The unique within RT clusters high frequency PMD(s) is(are)  28.03 21.98 44.03 17.03 18.01.</span></span>
<span><span class="co">#&gt; 409 isotope peaks found.</span></span>
<span><span class="co">#&gt; 109 multiple charged isotope peaks found.</span></span>
<span><span class="co">#&gt; 251 multiple charged peaks found.</span></span>
<span><span class="co">#&gt; 346 paired peaks found.</span></span>
<span><span class="co">#&gt; 8 group(s) have single peaks 14 23 32 33 54 55 56 75</span></span>
<span><span class="co">#&gt; 11 group(s) with multiple peaks while no isotope/paired relationship 4 5 7 8 11 ... 42 49 68 72 73</span></span>
<span><span class="co">#&gt; 9 group(s) with isotope without paired relationship 2 9 22 26 52 62 64 66 70</span></span>
<span><span class="co">#&gt; 4 group(s) with paired without isotope relationship 1 10 15 18</span></span>
<span><span class="co">#&gt; 43 group(s) with both paired and isotope relationship 3 6 12 13 16 ... 65 67 69 71 74</span></span>
<span><span class="co">#&gt; 292 standard masses identified.</span></span>
<span><span class="va">sda</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getsda.html">getsda</a></span><span class="op">(</span><span class="va">std</span>,freqcutoff <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span><span class="co">#&gt; 5 groups were found as high frequency PMD group.</span></span>
<span><span class="co">#&gt; 0 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 2.02 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 28.03 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 30.05 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 58.04 was found as high frequency PMD.</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">sda</span><span class="op">$</span><span class="va">sda</span></span>
<span><span class="va">net</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/graph_from_data_frame.html" class="external-link">graph_from_data_frame</a></span><span class="op">(</span><span class="va">df</span>,directed <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">pal</span> <span class="op">&lt;-</span> <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">diff2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">net</span>,vertex.label<span class="op">=</span><span class="cn">NA</span>,vertex.size <span class="op">=</span> <span class="fl">5</span>,edge.width <span class="op">=</span> <span class="fl">3</span>,edge.color <span class="op">=</span> <span class="va">pal</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">diff2</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>,main <span class="op">=</span> <span class="st">'PMD network'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>,bty <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>       legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">diff2</span><span class="op">)</span>,</span>
<span>       fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">pal</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">diff2</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, border<span class="op">=</span><span class="cn">NA</span>,horiz <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p><img src="reactomics_files/figure-html/net-1.png" width="700"></p>
<p>Here we could find clusters of metabolites. We could detect such
network community structure.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># network community structure detection</span></span>
<span><span class="va">ceb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/cluster_edge_betweenness.html" class="external-link">cluster_edge_betweenness</a></span><span class="op">(</span><span class="va">net</span>,weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">cor</span><span class="op">)</span>, directed <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Warning in cluster_edge_betweenness(net, weights = abs(E(net)$cor), directed =</span></span>
<span><span class="co">#&gt; F): At vendor/cigraph/src/community/edge_betweenness.c:504 : Membership vector</span></span>
<span><span class="co">#&gt; will be selected based on the highest modularity score.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ceb</span>, <span class="va">net</span>,vertex.label<span class="op">=</span><span class="cn">NA</span>,vertex.size <span class="op">=</span> <span class="fl">5</span>,edge.width <span class="op">=</span> <span class="fl">3</span>,<span class="op">)</span> </span></code></pre></div>
<p><img src="reactomics_files/figure-html/nwa-1.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># output membership</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">ceb</span><span class="op">$</span><span class="va">membership</span>,<span class="va">ceb</span><span class="op">$</span><span class="va">names</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]              </span></span>
<span><span class="co">#&gt; [1,] "1"  "146.118268664153"</span></span>
<span><span class="co">#&gt; [2,] "1"  "174.148913040161"</span></span>
<span><span class="co">#&gt; [3,] "2"  "175.148206702548"</span></span>
<span><span class="co">#&gt; [4,] "2"  "177.164038300588"</span></span>
<span><span class="co">#&gt; [5,] "2"  "177.163608624184"</span></span>
<span><span class="co">#&gt; [6,] "3"  "200.200536606252"</span></span></code></pre></div>
<p>Such network could also be build on correlation directed analysis
which use correlation between paired peaks to build network.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cbp</span> <span class="op">&lt;-</span> <span class="fu">enviGCMS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/enviGCMS/man/getfilter.html" class="external-link">getfilter</a></span><span class="op">(</span><span class="va">std</span>,rowindex <span class="op">=</span> <span class="va">std</span><span class="op">$</span><span class="va">stdmassindex</span><span class="op">)</span></span>
<span><span class="va">cda</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getcda.html">getcda</a></span><span class="op">(</span><span class="va">cbp</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">cda</span><span class="op">$</span><span class="va">cda</span></span>
<span><span class="co"># filter based on retention time differences larger than 2 mins</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">diffrt</span><span class="op">&gt;</span><span class="fl">120</span>,<span class="op">]</span></span>
<span><span class="va">netc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/graph_from_data_frame.html" class="external-link">graph_from_data_frame</a></span><span class="op">(</span><span class="va">df</span>,directed <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">netc</span>,vertex.label<span class="op">=</span><span class="cn">NA</span>,vertex.size <span class="op">=</span> <span class="fl">5</span>,edge.width <span class="op">=</span> <span class="fl">3</span>,main <span class="op">=</span> <span class="st">'Correlation network'</span><span class="op">)</span></span></code></pre></div>
<p><img src="reactomics_files/figure-html/cda-1.png" width="700"></p>
<p>As shown above, correlation network without PMD might merge into one
big network, which lose the details of chemical reactions.</p>
<div class="section level3">
<h3 id="shiny-application">Shiny application<a class="anchor" aria-label="anchor" href="#shiny-application"></a>
</h3>
<p>The PMD network for certain compound could be generated by run
<code><a href="../reference/runPMDnet.html">runPMDnet()</a></code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="source-appointment">Source appointment<a class="anchor" aria-label="anchor" href="#source-appointment"></a>
</h2>
<p>Peaks from samples could be from endogenous compounds or exogenous
compounds. However, it’s hard to tell for untargeted analysis. In terms
of PMD, if one peak belongs to a high frequency PMD network, it means a
relatively high activity. If such sample belongs to a biological
specimen, it might be endogenous compound. If a peak show no PMD network
with other peaks, the biological system might not have enzyme to make
reaction happen. Exogenous compounds will show a lower degree since they
are xenobiotics. Since most of the peaks will show a low degree, the
median of the degree could be used as cutoff. Then we could make source
appointment if the assumption is hold.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">deg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/degree.html" class="external-link">degree</a></span><span class="op">(</span><span class="va">net</span>, mode <span class="op">=</span> <span class="st">'all'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">deg</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="va">endogenous</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">deg</span><span class="op">)</span><span class="op">[</span><span class="va">deg</span><span class="op">&gt;</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">deg</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">exogenous</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">deg</span><span class="op">)</span><span class="op">[</span><span class="va">deg</span><span class="op">&lt;=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">deg</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>In this case, we will have 43 endogenous compounds while 44 exogenous
compounds. When you find a peak show differences between groups, you
could check the degree to infer its sources.</p>
<p>Another parameter would be the average network distances. Endogenous
compounds could form a larger network with long average network
distances while exogenous compounds will connected to network with small
average network distances. Such parameter could be used to determine the
source of unknown compound by checking the average network distances of
the compounds PMD network.</p>
<p>Be careful, one compound could be endogenous for one sample while
exogenous for another sample. In this case, PMD network would give hints
on the sources based on the context of the samples.</p>
</div>
<div class="section level2">
<h2 id="biomarker-reaction">Biomarker reaction<a class="anchor" aria-label="anchor" href="#biomarker-reaction"></a>
</h2>
<p>Biomarker always means biomarker compounds. However, if we could
quantify the reaction relationship, we could use biomarker reaction to
trace certain biological process. You could use <code>getreact</code> to
extract the ion pairs shared the same PMD and intensity ratio RSD% lower
than certain cutoff. Then the sum of the intensity of all PMD pairs’
ions could be used to compare the reaction level changes among
samples.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pmd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getreact.html">getreact</a></span><span class="op">(</span><span class="va">spmeinvivo</span>,pmd<span class="op">=</span><span class="fl">15.99</span><span class="op">)</span></span>
<span><span class="co"># show the ions with the same PMD</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pmd</span><span class="op">$</span><span class="va">pmd</span><span class="op">)</span></span>
<span><span class="co">#&gt;             ms1      ms2     diff     rt1     rt2  diffrt rtg1 rtg2 rtgdiff</span></span>
<span><span class="co">#&gt; 109378 174.1489 158.1546 15.99434 337.418 470.364 132.946   44   31      13</span></span>
<span><span class="co">#&gt; 114898 175.1481 159.1575 15.99055 614.413 470.364 144.049   17   31      14</span></span>
<span><span class="co">#&gt; 212776 209.1552 193.1632 15.99202 611.412 337.633 273.779   17   44      27</span></span>
<span><span class="co">#&gt; 219286 211.1695 195.1745 15.99491 614.625 594.485  20.140   17   46      29</span></span>
<span><span class="co">#&gt; 255283 228.1973 212.2025 15.99473 453.157 639.100 185.943   45   13      32</span></span>
<span><span class="co">#&gt; 290503 244.1921 228.1973 15.99486 614.842 453.157 161.685   17   45      28</span></span>
<span><span class="co">#&gt;              cor diff2        r       rh       rl</span></span>
<span><span class="co">#&gt; 109378 0.9247231 15.99 25.01946 48.53964 28.03499</span></span>
<span><span class="co">#&gt; 114898 0.9164059 15.99 18.12926 35.13135 25.48822</span></span>
<span><span class="co">#&gt; 212776 0.7567381 15.99 29.09434 38.95531 41.61674</span></span>
<span><span class="co">#&gt; 219286 0.7378409 15.99 26.62548 33.46165 61.56227</span></span>
<span><span class="co">#&gt; 255283 0.9749689 15.99  6.76019 30.01754 26.76093</span></span>
<span><span class="co">#&gt; 290503 0.9670674 15.99 17.96722 42.20945 30.01754</span></span>
<span><span class="co"># show the corresponding quantitative PMD data across samples, each row show the sum of intensity of paired masses qualified for stable mass pairs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pmd</span><span class="op">$</span><span class="va">pmddata</span><span class="op">)</span></span>
<span><span class="co">#&gt;           1405_Fish1_F1 1405_Fish1_F2 1405_Fish1_F3 1405_Fish2_F1 1405_Fish2_F2</span></span>
<span><span class="co">#&gt; 174.1/337     18327.863     11388.643     15368.711      9068.557     19759.098</span></span>
<span><span class="co">#&gt; 175.1/614      6746.288      4237.569      6581.992      3085.251      6108.837</span></span>
<span><span class="co">#&gt; 209.2/611     30644.459     19496.458     33519.253     11647.966     31169.817</span></span>
<span><span class="co">#&gt; 211.2/615      5958.334      4270.901      6285.724      2757.028      6065.346</span></span>
<span><span class="co">#&gt; 228.2/453     29245.928     21199.245     38668.407     16822.114     36020.058</span></span>
<span><span class="co">#&gt; 244.2/615     41582.379     30025.253     57302.819     20846.835     51716.437</span></span>
<span><span class="co">#&gt;           1405_Fish2_F3 1405_Fish3_F1 1405_Fish3_F2 1405_Fish3_F3</span></span>
<span><span class="co">#&gt; 174.1/337     12995.786     16878.397     18647.770     25557.292</span></span>
<span><span class="co">#&gt; 175.1/614      3420.075      6435.200      7535.579      8806.608</span></span>
<span><span class="co">#&gt; 209.2/611     14064.021     29421.515     38893.482     43313.165</span></span>
<span><span class="co">#&gt; 211.2/615      3041.366      5809.946      8795.206      8089.021</span></span>
<span><span class="co">#&gt; 228.2/453     19484.297     32281.370     36797.052     39304.713</span></span>
<span><span class="co">#&gt; 244.2/615     24315.314     45535.922     59156.064     61720.089</span></span></code></pre></div>
<p>If your data don’t have retention time, reaction level change can
also be checked.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spmeinvivo</span><span class="op">$</span><span class="va">rt</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">pmd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getreact.html">getreact</a></span><span class="op">(</span><span class="va">spmeinvivo</span>,pmd<span class="op">=</span><span class="fl">15.99</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co">#&gt; Warning in as.numeric(ratio1)/as.numeric(ratio2): longer object length is not a</span></span>
<span><span class="co">#&gt; multiple of shorter object length</span></span>
<span><span class="co"># show the ions with the same PMD</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pmd</span><span class="op">$</span><span class="va">pmd</span><span class="op">)</span></span>
<span><span class="co">#&gt;             ms1      ms2     diff       cor diff2        r       rh       rl</span></span>
<span><span class="co">#&gt; 109378 174.1489 158.1546 15.99434 0.9247231 15.99 25.01946 48.53964 28.03499</span></span>
<span><span class="co">#&gt; 114898 175.1481 159.1575 15.99055 0.9164059 15.99 18.12926 35.13135 25.48822</span></span>
<span><span class="co">#&gt; 212776 209.1552 193.1632 15.99202 0.7567381 15.99 29.09434 38.95531 41.61674</span></span>
<span><span class="co">#&gt; 219286 211.1695 195.1745 15.99491 0.7378409 15.99 26.62548 33.46165 61.56227</span></span>
<span><span class="co">#&gt; 255283 228.1973 212.2025 15.99473 0.9749689 15.99  6.76019 30.01754 26.76093</span></span>
<span><span class="co">#&gt; 290503 244.1921 228.1973 15.99486 0.9670674 15.99 17.96722 42.20945 30.01754</span></span>
<span><span class="co"># show the corresponding quantitative PMD data across samples, each row show the sum of intensity of paired masses qualified for stable mass pairs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pmd</span><span class="op">$</span><span class="va">pmddata</span><span class="op">)</span></span>
<span><span class="co">#&gt;           1405_Fish1_F1 1405_Fish1_F2 1405_Fish1_F3 1405_Fish2_F1 1405_Fish2_F2</span></span>
<span><span class="co">#&gt; 174.1/337     18327.863     11388.643     15368.711      9068.557     19759.098</span></span>
<span><span class="co">#&gt; 175.1/614      6746.288      4237.569      6581.992      3085.251      6108.837</span></span>
<span><span class="co">#&gt; 209.2/611     30644.459     19496.458     33519.253     11647.966     31169.817</span></span>
<span><span class="co">#&gt; 211.2/615      5958.334      4270.901      6285.724      2757.028      6065.346</span></span>
<span><span class="co">#&gt; 228.2/453     29245.928     21199.245     38668.407     16822.114     36020.058</span></span>
<span><span class="co">#&gt; 244.2/615     41582.379     30025.253     57302.819     20846.835     51716.437</span></span>
<span><span class="co">#&gt;           1405_Fish2_F3 1405_Fish3_F1 1405_Fish3_F2 1405_Fish3_F3</span></span>
<span><span class="co">#&gt; 174.1/337     12995.786     16878.397     18647.770     25557.292</span></span>
<span><span class="co">#&gt; 175.1/614      3420.075      6435.200      7535.579      8806.608</span></span>
<span><span class="co">#&gt; 209.2/611     14064.021     29421.515     38893.482     43313.165</span></span>
<span><span class="co">#&gt; 211.2/615      3041.366      5809.946      8795.206      8089.021</span></span>
<span><span class="co">#&gt; 228.2/453     19484.297     32281.370     36797.052     39304.713</span></span>
<span><span class="co">#&gt; 244.2/615     24315.314     45535.922     59156.064     61720.089</span></span></code></pre></div>
<p>Now we have two methods to compute the quantitative PMD responses and
user should select method depending on research purposes. ‘static’ will
only consider the stable mass pairs across samples and such reactions
will be limited by the enzyme or other factors than substrates.
‘dynamic’ will consider the unstable paired masses by normalization the
relatively unstable peak with stable peak between paired masses and such
reactions will be limited by one or both peaks in the paired masses.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"spmeinvivo"</span><span class="op">)</span></span>
<span><span class="va">pmd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getreact.html">getreact</a></span><span class="op">(</span><span class="va">spmeinvivo</span>,pmd<span class="op">=</span><span class="fl">15.99</span>,method <span class="op">=</span> <span class="st">'dynamic'</span><span class="op">)</span></span>
<span><span class="co"># show the ions with the same PMD</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pmd</span><span class="op">$</span><span class="va">pmd</span><span class="op">)</span></span>
<span><span class="co">#&gt;             ms1      ms2     diff      rt1      rt2  diffrt rtg1 rtg2 rtgdiff</span></span>
<span><span class="co">#&gt; 43332  147.9900 132.0050 15.98503 145.0880  49.4910 95.5970   20    4      16</span></span>
<span><span class="co">#&gt; 77336  162.1128 146.1183 15.99455 256.1585 288.1300 31.9715    5   23      18</span></span>
<span><span class="co">#&gt; 103842 172.1705 156.1777 15.99279 478.9360 405.3890 73.5470   43   30      13</span></span>
<span><span class="co">#&gt; 121772 177.0914 161.0967 15.99477 574.3390 490.7225 83.6165   39   37       2</span></span>
<span><span class="co">#&gt; 140886 183.0809 167.0901 15.99080 533.7950 511.2940 22.5010   48   12      36</span></span>
<span><span class="co">#&gt; 143601 184.9858 168.9988 15.98695  85.4930 135.4660 49.9730    2   41      39</span></span>
<span><span class="co">#&gt;                cor diff2         r        rh       rl</span></span>
<span><span class="co">#&gt; 43332   0.41231393 15.99  34.86972 27.176089 39.84553</span></span>
<span><span class="co">#&gt; 77336   0.95185232 15.99  30.42748 89.272157 84.24422</span></span>
<span><span class="co">#&gt; 103842  0.64609844 15.99  56.74081 50.385313 42.86262</span></span>
<span><span class="co">#&gt; 121772 -0.07743575 15.99 100.61906  8.080905 43.90465</span></span>
<span><span class="co">#&gt; 140886  0.54183684 15.99  38.29089 16.749724 42.53298</span></span>
<span><span class="co">#&gt; 143601 -0.36694067 15.99  46.87352 18.159277 40.61084</span></span>
<span><span class="co"># show the corresponding quantitative PMD data across samples, each row show the sum of intensity of paired masses qualified for stable mass pairs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pmd</span><span class="op">$</span><span class="va">pmddata</span><span class="op">)</span></span>
<span><span class="co">#&gt;   1405_Fish1_F1 1405_Fish1_F2 1405_Fish1_F3 1405_Fish2_F1 1405_Fish2_F2</span></span>
<span><span class="co">#&gt; 1    0.01999437   0.016242675    0.01880472   0.006371798   0.024304585</span></span>
<span><span class="co">#&gt; 2    1.53528194   0.962295635    1.10219074   0.982190726   1.604363528</span></span>
<span><span class="co">#&gt; 3    0.46404167   1.194387570    1.06934597   0.250054581   0.509676599</span></span>
<span><span class="co">#&gt; 4    1.20386141   1.669736528    1.32468366   1.213218611   1.083057203</span></span>
<span><span class="co">#&gt; 5    0.01461837   0.006770954    0.01055026   0.009490853   0.008958319</span></span>
<span><span class="co">#&gt; 6    9.26463385  12.763610562    3.97502609  14.657795223   4.041131973</span></span>
<span><span class="co">#&gt;   1405_Fish2_F3 1405_Fish3_F1 1405_Fish3_F2 1405_Fish3_F3</span></span>
<span><span class="co">#&gt; 1    0.01309609   0.011523649   0.011596937   0.017668097</span></span>
<span><span class="co">#&gt; 2    1.43917818   1.064822325   1.846236771   2.609787311</span></span>
<span><span class="co">#&gt; 3    1.01508469   0.406659176   0.874861257   0.621074214</span></span>
<span><span class="co">#&gt; 4    2.05169832   7.765315730   0.832736564   2.117740805</span></span>
<span><span class="co">#&gt; 5    0.01549754   0.007511291   0.005490916   0.005883117</span></span>
<span><span class="co">#&gt; 6    9.12757512   7.779539564   7.970752923   4.004298286</span></span></code></pre></div>
<p>You can also output the quantitative results of all high frequency
PMDs existing in the data.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"spmeinvivo"</span><span class="op">)</span></span>
<span><span class="co"># remove redundant peaks</span></span>
<span><span class="va">list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/globalstd.html">globalstd</a></span><span class="op">(</span><span class="va">spmeinvivo</span>,sda <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">#&gt; 75 retention time clusters found.</span></span>
<span><span class="co">#&gt; Using ng = 15</span></span>
<span><span class="co">#&gt; 5 unique PMDs retained.</span></span>
<span><span class="co">#&gt; The unique within RT clusters high frequency PMD(s) is(are)  28.03 21.98 44.03 17.03 18.01.</span></span>
<span><span class="co">#&gt; 409 isotope peaks found.</span></span>
<span><span class="co">#&gt; 109 multiple charged isotope peaks found.</span></span>
<span><span class="co">#&gt; 251 multiple charged peaks found.</span></span>
<span><span class="co">#&gt; 346 paired peaks found.</span></span>
<span><span class="co">#&gt; 8 group(s) have single peaks 14 23 32 33 54 55 56 75</span></span>
<span><span class="co">#&gt; 11 group(s) with multiple peaks while no isotope/paired relationship 4 5 7 8 11 ... 42 49 68 72 73</span></span>
<span><span class="co">#&gt; 9 group(s) with isotope without paired relationship 2 9 22 26 52 62 64 66 70</span></span>
<span><span class="co">#&gt; 4 group(s) with paired without isotope relationship 1 10 15 18</span></span>
<span><span class="co">#&gt; 43 group(s) with both paired and isotope relationship 3 6 12 13 16 ... 65 67 69 71 74</span></span>
<span><span class="co">#&gt; 292 standard masses identified.</span></span>
<span><span class="co">#&gt; PMD frequency cutoff is 9 by PMD network analysis with largest network average distance 7.26 .</span></span>
<span><span class="co">#&gt; 8 groups were found as high frequency PMD group.</span></span>
<span><span class="co">#&gt; 0 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 2.02 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 12 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 28.03 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 30.05 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 42.05 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 58.04 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 116.08 was found as high frequency PMD.</span></span>
<span><span class="va">newlist</span> <span class="op">&lt;-</span> <span class="fu">enviGCMS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/enviGCMS/man/getfilter.html" class="external-link">getfilter</a></span><span class="op">(</span><span class="va">list</span>,rowindex <span class="op">=</span> <span class="va">list</span><span class="op">$</span><span class="va">stdmassindex</span><span class="op">)</span></span>
<span><span class="co"># get high frequency pmd</span></span>
<span><span class="va">hfpmd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">newlist</span><span class="op">$</span><span class="va">sda</span><span class="op">$</span><span class="va">diff2</span><span class="op">)</span></span>
<span><span class="co"># generate quantitative results</span></span>
<span><span class="va">pmd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getreact.html">getreact</a></span><span class="op">(</span><span class="va">newlist</span>,pmd<span class="op">=</span><span class="va">hfpmd</span><span class="op">)</span></span>
<span><span class="co"># output the kegg pmd in the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">pmd</span><span class="op">$</span><span class="va">pmd</span><span class="op">$</span><span class="va">diff2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      0   2.02     12  28.03  30.05  42.05  58.04 116.08 </span></span>
<span><span class="co">#&gt;      1      5      7      2      3      1      7      6</span></span>
<span><span class="co"># output quantitative result for each PMD</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pmd</span><span class="op">$</span><span class="va">pmddata</span><span class="op">)</span></span>
<span><span class="co">#&gt;           1405_Fish1_F1 1405_Fish1_F2 1405_Fish1_F3 1405_Fish2_F1 1405_Fish2_F2</span></span>
<span><span class="co">#&gt; 170.2/639     17657.002     10935.830     15380.652      9027.136     18341.408</span></span>
<span><span class="co">#&gt; 200.2/522     76781.538     40625.840     77922.531     28510.920     79221.245</span></span>
<span><span class="co">#&gt; 175.1/453     12187.331      7656.765      9018.779      4548.020     11727.140</span></span>
<span><span class="co">#&gt; 200.2/522     61813.393     31627.099     65896.736     20760.813     63841.615</span></span>
<span><span class="co">#&gt; 177.2/639      4686.268      2755.558      4957.270      1745.660      5051.758</span></span>
<span><span class="co">#&gt; 326.3/648     13541.352      6479.068     15770.972      4922.571     13168.677</span></span>
<span><span class="co">#&gt;           1405_Fish2_F3 1405_Fish3_F1 1405_Fish3_F2 1405_Fish3_F3</span></span>
<span><span class="co">#&gt; 170.2/639     12706.833      16722.20     17964.151     23711.077</span></span>
<span><span class="co">#&gt; 200.2/522     40736.977      68844.35     83690.730     91978.112</span></span>
<span><span class="co">#&gt; 175.1/453      6574.599      13444.25     13759.136     14974.739</span></span>
<span><span class="co">#&gt; 200.2/522     29724.524      54917.81     68598.302     72047.813</span></span>
<span><span class="co">#&gt; 177.2/639      3041.635       4707.46      4765.946      5272.995</span></span>
<span><span class="co">#&gt; 326.3/648      6065.289      11440.63     14695.065     16218.608</span></span>
<span><span class="co"># output quantitative result for unique PMD</span></span>
<span><span class="va">upmd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">pmd</span><span class="op">$</span><span class="va">pmddata</span>, by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">pmd</span><span class="op">$</span><span class="va">pmd</span><span class="op">$</span><span class="va">diff2</span><span class="op">)</span>,<span class="va">sum</span><span class="op">)</span></span>
<span><span class="co"># column for samples and row for unique PMD</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">upmd</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Group.1 1405_Fish1_F1 1405_Fish1_F2 1405_Fish1_F3 1405_Fish2_F1 1405_Fish2_F2</span></span>
<span><span class="co">#&gt; 1    0.00      53022.83      23456.56      20941.85      14903.71      63222.37</span></span>
<span><span class="co">#&gt; 2    2.02    7636291.25    6153071.05    7977403.59    4868105.03    7982139.69</span></span>
<span><span class="co">#&gt; 3   12.00   15486878.05   12519952.24   16356055.31    9935017.30   16237029.99</span></span>
<span><span class="co">#&gt; 4   28.03      37091.72      31173.62      56537.52      21134.78      53606.36</span></span>
<span><span class="co">#&gt; 5   30.05      77903.78      50845.03      94997.88      33333.63      93912.86</span></span>
<span><span class="co">#&gt; 6   42.05      76781.54      40625.84      77922.53      28510.92      79221.24</span></span>
<span><span class="co">#&gt;   1405_Fish2_F3 1405_Fish3_F1 1405_Fish3_F2 1405_Fish3_F3</span></span>
<span><span class="co">#&gt; 1      26320.58      65507.97      59418.19      44340.68</span></span>
<span><span class="co">#&gt; 2    5841264.15    7414502.27    8077803.96    8736106.60</span></span>
<span><span class="co">#&gt; 3   11909674.43   15053630.97   16433254.95   17779902.00</span></span>
<span><span class="co">#&gt; 4      26536.18      35353.86      54167.11      60799.07</span></span>
<span><span class="co">#&gt; 5      45257.00      72396.51      99610.92     104228.58</span></span>
<span><span class="co">#&gt; 6      40736.98      68844.35      83690.73      91978.11</span></span></code></pre></div>
<p>You can also output the quantitative results of all PMDs existing in
current KEGG database.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># output all existing PMD in KEGG</span></span>
<span><span class="va">keggpmd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">keggrall</span><span class="op">$</span><span class="va">pmd</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"spmeinvivo"</span><span class="op">)</span></span>
<span><span class="co"># remove redundant peaks</span></span>
<span><span class="va">list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/globalstd.html">globalstd</a></span><span class="op">(</span><span class="va">spmeinvivo</span><span class="op">)</span></span>
<span><span class="co">#&gt; 75 retention time clusters found.</span></span>
<span><span class="co">#&gt; Using ng = 15</span></span>
<span><span class="co">#&gt; 5 unique PMDs retained.</span></span>
<span><span class="co">#&gt; The unique within RT clusters high frequency PMD(s) is(are)  28.03 21.98 44.03 17.03 18.01.</span></span>
<span><span class="co">#&gt; 409 isotope peaks found.</span></span>
<span><span class="co">#&gt; 109 multiple charged isotope peaks found.</span></span>
<span><span class="co">#&gt; 251 multiple charged peaks found.</span></span>
<span><span class="co">#&gt; 346 paired peaks found.</span></span>
<span><span class="co">#&gt; 8 group(s) have single peaks 14 23 32 33 54 55 56 75</span></span>
<span><span class="co">#&gt; 11 group(s) with multiple peaks while no isotope/paired relationship 4 5 7 8 11 ... 42 49 68 72 73</span></span>
<span><span class="co">#&gt; 9 group(s) with isotope without paired relationship 2 9 22 26 52 62 64 66 70</span></span>
<span><span class="co">#&gt; 4 group(s) with paired without isotope relationship 1 10 15 18</span></span>
<span><span class="co">#&gt; 43 group(s) with both paired and isotope relationship 3 6 12 13 16 ... 65 67 69 71 74</span></span>
<span><span class="co">#&gt; 292 standard masses identified.</span></span>
<span><span class="va">newlist</span> <span class="op">&lt;-</span> <span class="fu">enviGCMS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/enviGCMS/man/getfilter.html" class="external-link">getfilter</a></span><span class="op">(</span><span class="va">list</span>,rowindex <span class="op">=</span> <span class="va">list</span><span class="op">$</span><span class="va">stdmassindex</span><span class="op">)</span></span>
<span><span class="co"># generate quantitative results</span></span>
<span><span class="va">pmd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getreact.html">getreact</a></span><span class="op">(</span><span class="va">newlist</span>,pmd<span class="op">=</span><span class="va">keggpmd</span><span class="op">)</span></span>
<span><span class="co"># output the kegg pmd in the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">pmd</span><span class="op">$</span><span class="va">pmd</span><span class="op">$</span><span class="va">diff2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      0   0.04      1   1.98   2.02   2.04   2.05   2.98   3.02   3.05      6 </span></span>
<span><span class="co">#&gt;      1      1      1      1      5      1      1      1      1      2      1 </span></span>
<span><span class="co">#&gt;   6.05   7.06   7.08    7.2   9.98     12  12.07  12.95  14.02  14.05     15 </span></span>
<span><span class="co">#&gt;      1      1      1      1      2      7      1      1      4      4      1 </span></span>
<span><span class="co">#&gt;  15.05  15.22  15.99  16.03  16.93     17  17.03  17.99  18.06  19.04  19.87 </span></span>
<span><span class="co">#&gt;      1      1      3      2      1      2      1      1      1      1      1 </span></span>
<span><span class="co">#&gt;  19.91  20.06  21.98  22.02  22.76   22.8  23.95  23.98     24  26.02     28 </span></span>
<span><span class="co">#&gt;      1      1      3      1      1      1      1      1      2      4      1 </span></span>
<span><span class="co">#&gt;  28.01  28.03  28.07   28.1  28.26  28.99  29.96  29.97  31.01  31.06  31.99 </span></span>
<span><span class="co">#&gt;      1      2      1      1      1      1      1      1      1      1      2 </span></span>
<span><span class="co">#&gt;  33.93  33.99  34.01  34.02  34.93  35.02     36  38.02  39.99  42.05  43.01 </span></span>
<span><span class="co">#&gt;      1      1      1      1      1      1      1      1      1      1      1 </span></span>
<span><span class="co">#&gt;  44.21  45.02  45.03  45.96  46.16  47.94  47.98     48  50.02  50.12  51.05 </span></span>
<span><span class="co">#&gt;      1      1      1      1      1      1      2      2      2      1      1 </span></span>
<span><span class="co">#&gt;  51.89  52.01  52.07   53.9  55.92  56.27  57.97  58.04  58.08  58.85  59.04 </span></span>
<span><span class="co">#&gt;      1      1      1      1      2      1      1      7      1      1      1 </span></span>
<span><span class="co">#&gt;  60.08  61.02  63.96  64.02  66.05  67.03  67.25  69.94  70.99  71.98  72.07 </span></span>
<span><span class="co">#&gt;      1      1      1      1      1      1      1      1      1      1      1 </span></span>
<span><span class="co">#&gt;  72.97  75.05  75.34  77.05  78.96  80.03  80.06  81.06  81.95  81.97  82.04 </span></span>
<span><span class="co">#&gt;      1      1      2      2      2      1      1      1      1      1      1 </span></span>
<span><span class="co">#&gt;  84.02  84.08  85.05  86.11  90.05  90.55  92.03  92.06  93.02  94.02  97.05 </span></span>
<span><span class="co">#&gt;      2      2      1      1      2      1      1      1      1      1      1 </span></span>
<span><span class="co">#&gt;  98.07 100.95 102.03 102.25 102.97 103.83 103.91 103.99 104.06 109.03 110.83 </span></span>
<span><span class="co">#&gt;      1      1      1      1      1      1      1      1      1      1      1 </span></span>
<span><span class="co">#&gt; 112.12 113.07 115.83 117.06 117.92 118.03 119.04 119.06 120.02 121.87 122.01 </span></span>
<span><span class="co">#&gt;      1      1      1      1      1      1      1      1      1      1      1 </span></span>
<span><span class="co">#&gt; 122.94 123.01 123.99 125.88 126.03 126.08 126.96 128.01 131.05 132.94 135.96 </span></span>
<span><span class="co">#&gt;      1      2      1      2      1      1      1      1      1      1      2 </span></span>
<span><span class="co">#&gt; 142.75 143.94 144.04 144.05 145.01 146.06 147.16 149.94 150.07 151.04 152.05 </span></span>
<span><span class="co">#&gt;      1      1      1      1      1      1      1      1      1      1      1 </span></span>
<span><span class="co">#&gt; 153.07 156.19 157.01 158.13 160.16 161.15 161.95 165.06 169.12    170 172.06 </span></span>
<span><span class="co">#&gt;      1      1      1      2      1      2      1      1      1      1      1 </span></span>
<span><span class="co">#&gt; 173.01 178.18 183.06 185.76 195.02 195.03 196.06 199.06 201.04 204.19 207.02 </span></span>
<span><span class="co">#&gt;      1      1      1      1      1      1      1      1      1      2      1 </span></span>
<span><span class="co">#&gt; 215.05 217.03 217.07 218.17 226.19 236.93 241.05 249.09 252.92 260.93 265.03 </span></span>
<span><span class="co">#&gt;      1      1      1      1      1      1      1      2      1      1      1 </span></span>
<span><span class="co">#&gt; 268.87 272.12 275.12 278.02 278.16 291.84    297 300.08 301.91 311.87 315.18 </span></span>
<span><span class="co">#&gt;      1      1      1      1      1      1      1      1      1      1      1 </span></span>
<span><span class="co">#&gt;  339.1 343.71    344 344.95 345.86 346.74 360.75  369.8 405.02 409.03 431.06 </span></span>
<span><span class="co">#&gt;      1      1      1      1      2      1      1      1      1      1      1 </span></span>
<span><span class="co">#&gt; 437.11 440.89 441.41 447.07 450.27 455.01  466.1 467.04 474.07 476.07 488.07 </span></span>
<span><span class="co">#&gt;      1      1      1      1      1      1      1      1      1      2      1 </span></span>
<span><span class="co">#&gt; 501.08 505.13 517.06 526.05 535.07 540.06 546.98 552.06 </span></span>
<span><span class="co">#&gt;      1      1      1      1      1      1      1      1</span></span>
<span><span class="co"># output quantitative result for each PMD</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pmd</span><span class="op">$</span><span class="va">pmddata</span><span class="op">)</span></span>
<span><span class="co">#&gt;           1405_Fish1_F1 1405_Fish1_F2 1405_Fish1_F3 1405_Fish2_F1 1405_Fish2_F2</span></span>
<span><span class="co">#&gt; 175.1/261      6811.033      5313.499     11989.849      6239.471     12202.445</span></span>
<span><span class="co">#&gt; 205.1/584      8190.765      7581.643     12945.959      5684.228     13445.629</span></span>
<span><span class="co">#&gt; 299.1/448     21559.233     15267.362     21692.940     14084.394     26372.907</span></span>
<span><span class="co">#&gt; 577.1/820      5329.327      3406.066      7295.058      3550.973      7588.165</span></span>
<span><span class="co">#&gt; 159/155       35181.202     38958.595     32009.376     51346.078     28559.260</span></span>
<span><span class="co">#&gt; 159/155       25512.422     38824.191     33660.574     48794.630     20651.311</span></span>
<span><span class="co">#&gt;           1405_Fish2_F3 1405_Fish3_F1 1405_Fish3_F2 1405_Fish3_F3</span></span>
<span><span class="co">#&gt; 175.1/261      7860.593      4272.374      8637.834     14184.899</span></span>
<span><span class="co">#&gt; 205.1/584      7120.687      8085.563     12970.200     14168.461</span></span>
<span><span class="co">#&gt; 299.1/448     15676.912     16914.835     22297.457     26320.967</span></span>
<span><span class="co">#&gt; 577.1/820      3965.134      4078.607      6897.387      8676.138</span></span>
<span><span class="co">#&gt; 159/155       41888.784     29068.087     25006.374     33043.005</span></span>
<span><span class="co">#&gt; 159/155       40127.066     35015.350     29515.079     30543.740</span></span>
<span><span class="co"># output quantitative result for unique PMD</span></span>
<span><span class="va">upmd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">pmd</span><span class="op">$</span><span class="va">pmddata</span>, by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">pmd</span><span class="op">$</span><span class="va">pmd</span><span class="op">$</span><span class="va">diff2</span><span class="op">)</span>,<span class="va">sum</span><span class="op">)</span></span>
<span><span class="co"># column for samples and row for unique PMD</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">upmd</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Group.1 1405_Fish1_F1 1405_Fish1_F2 1405_Fish1_F3 1405_Fish2_F1 1405_Fish2_F2</span></span>
<span><span class="co">#&gt; 1    0.00     53022.833     23456.563     20941.848     14903.714     63222.368</span></span>
<span><span class="co">#&gt; 2    0.04     12058.283      5683.830     14155.755      4274.170     12110.012</span></span>
<span><span class="co">#&gt; 3    1.00      5209.173      3512.233      4942.192      1756.098      6346.882</span></span>
<span><span class="co">#&gt; 4    1.98      5971.194      3458.283      8176.808      2771.773      7712.713</span></span>
<span><span class="co">#&gt; 5    2.02   7636291.255   6153071.046   7977403.589   4868105.031   7982139.691</span></span>
<span><span class="co">#&gt; 6    2.04      5588.112      2835.595      6882.802      1988.072      4584.455</span></span>
<span><span class="co">#&gt;   1405_Fish2_F3 1405_Fish3_F1 1405_Fish3_F2 1405_Fish3_F3</span></span>
<span><span class="co">#&gt; 1     26320.581     65507.970     59418.194     44340.680</span></span>
<span><span class="co">#&gt; 2      5375.740     10158.037     12830.564     14487.791</span></span>
<span><span class="co">#&gt; 3      3539.207      4923.479      5443.136      7125.664</span></span>
<span><span class="co">#&gt; 4      4512.221      5893.853      5002.987      5038.237</span></span>
<span><span class="co">#&gt; 5   5841264.153   7414502.267   8077803.958   8736106.602</span></span>
<span><span class="co">#&gt; 6      2931.107      4411.049      5688.054      5438.388</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="reactomics-analysis-for-ms-only-data">Reactomics analysis for MS only data<a class="anchor" aria-label="anchor" href="#reactomics-analysis-for-ms-only-data"></a>
</h2>
<p>When retention time is not provided, m/z vector can still be used to
check reaction level changes. You might use <code>getrda</code> to find
the high frequency PMDs.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">spmeinvivo</span><span class="op">)</span></span>
<span><span class="co"># get the m/z</span></span>
<span><span class="va">mz</span> <span class="op">&lt;-</span> <span class="va">spmeinvivo</span><span class="op">$</span><span class="va">mz</span></span>
<span><span class="co"># get the m/z intensity for all m/z, the row order is the same with mz</span></span>
<span><span class="va">insms</span> <span class="op">&lt;-</span> <span class="va">spmeinvivo</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="co"># check high frequency pmd</span></span>
<span><span class="va">sda</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getrda.html">getrda</a></span><span class="op">(</span><span class="va">mz</span><span class="op">)</span></span>
<span><span class="co">#&gt; 164462 pmd found.</span></span>
<span><span class="co">#&gt; 20 pmd used.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">sda</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "0"       "1.001"   "1.002"   "1.003"   "1.004"   "2.015"   "2.016"  </span></span>
<span><span class="co">#&gt;  [8] "14.015"  "17.026"  "18.011"  "21.982"  "28.031"  "28.032"  "44.026" </span></span>
<span><span class="co">#&gt; [15] "67.987"  "67.988"  "88.052"  "116.192" "135.974" "135.975"</span></span>
<span><span class="co"># save them as numeric vector</span></span>
<span><span class="va">hfpmd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">sda</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Then <code>getpmddf</code> function can be used to extract all the
paired ions for certain PMD.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get details for certain pmd</span></span>
<span><span class="va">pmddf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getpmddf.html">getpmddf</a></span><span class="op">(</span><span class="va">mz</span>,pmd<span class="op">=</span><span class="fl">18.011</span>,digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co"># add intensity for all the paired ions</span></span>
<span><span class="va">mz1ins</span> <span class="op">&lt;-</span> <span class="va">insms</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">pmddf</span><span class="op">$</span><span class="va">ms1</span>,<span class="va">mz</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">mz2ins</span> <span class="op">&lt;-</span> <span class="va">insms</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">pmddf</span><span class="op">$</span><span class="va">ms2</span>,<span class="va">mz</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="co"># get the pmd pair intensity</span></span>
<span><span class="va">pmdins</span> <span class="op">&lt;-</span> <span class="va">mz1ins</span><span class="op">+</span><span class="va">mz2ins</span></span>
<span><span class="co"># get the pmd total intensity across samples</span></span>
<span><span class="va">pmdinsall</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">pmdins</span>,<span class="fl">2</span>,<span class="va">sum</span><span class="op">)</span></span>
<span><span class="co"># show the PMD intensity</span></span>
<span><span class="va">pmdinsall</span></span>
<span><span class="co">#&gt; 1405_Fish1_F1 1405_Fish1_F2 1405_Fish1_F3 1405_Fish2_F1 1405_Fish2_F2 </span></span>
<span><span class="co">#&gt;       9898514       7801273      10363201       5847334      10479551 </span></span>
<span><span class="co">#&gt; 1405_Fish2_F3 1405_Fish3_F1 1405_Fish3_F2 1405_Fish3_F3 </span></span>
<span><span class="co">#&gt;       7021375      10584976      12989961      12559649</span></span></code></pre></div>
<p>You can also calculate the static or dynamic PMD intensity for m/z
only data.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the ratio of larger m/z over smaller m/z</span></span>
<span><span class="va">ratio</span> <span class="op">&lt;-</span> <span class="va">mz2ins</span><span class="op">/</span><span class="va">mz1ins</span></span>
<span><span class="co"># filter PMD based on RSD% across samples</span></span>
<span><span class="co"># cutoff 30%</span></span>
<span><span class="va">cutoff</span> <span class="op">&lt;-</span> <span class="fl">0.3</span></span>
<span><span class="co"># get index for static PMD</span></span>
<span><span class="va">rsdidx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">ratio</span>,<span class="fl">1</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">&lt;</span><span class="va">cutoff</span><span class="op">)</span></span>
<span><span class="co"># get static PMD</span></span>
<span><span class="va">pmddfstatic</span> <span class="op">&lt;-</span> <span class="va">pmddf</span><span class="op">[</span><span class="va">rsdidx</span>,<span class="op">]</span></span>
<span><span class="co"># get static intensity</span></span>
<span><span class="va">pmdinsstatic</span> <span class="op">&lt;-</span> <span class="va">pmdins</span><span class="op">[</span><span class="va">rsdidx</span>,<span class="op">]</span></span>
<span><span class="co"># normalize the ions pair intensity to avoid influences from large response factors</span></span>
<span><span class="va">pmdinsstaticscale</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">pmdinsstatic</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># get the pmd static intensity across samples</span></span>
<span><span class="va">pmdinsstaticall</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">pmdinsstaticscale</span>,<span class="fl">2</span>,<span class="va">sum</span><span class="op">)</span></span>
<span><span class="co"># show the PMD static intensity for each sample</span></span>
<span><span class="va">pmdinsstaticall</span></span>
<span><span class="co">#&gt; 1405_Fish1_F1 1405_Fish1_F2 1405_Fish1_F3 1405_Fish2_F1 1405_Fish2_F2 </span></span>
<span><span class="co">#&gt;      1.027100    -16.703628      2.373645    -27.241358     12.433566 </span></span>
<span><span class="co">#&gt; 1405_Fish2_F3 1405_Fish3_F1 1405_Fish3_F2 1405_Fish3_F3 </span></span>
<span><span class="co">#&gt;    -17.757951      7.924290     19.802820     18.141514</span></span>
<span></span>
<span><span class="co"># get index for dynamic PMD</span></span>
<span><span class="va">rsdidx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">ratio</span>,<span class="fl">1</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">&gt;=</span><span class="va">cutoff</span><span class="op">)</span></span>
<span><span class="co"># get dynamic PMD</span></span>
<span><span class="va">pmddfdynamic</span> <span class="op">&lt;-</span> <span class="va">pmddf</span><span class="op">[</span><span class="va">rsdidx</span>,<span class="op">]</span></span>
<span><span class="co"># get dynamic intensity for ms1 and ms2</span></span>
<span><span class="va">pmdinsdynamicms1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">mz1ins</span><span class="op">[</span><span class="va">rsdidx</span>,<span class="op">]</span>,<span class="fl">1</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pmdinsdynamicms2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">mz2ins</span><span class="op">[</span><span class="va">rsdidx</span>,<span class="op">]</span>,<span class="fl">1</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># find the stable ms and use ratio as intensity</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="va">pmdinsdynamicms1</span><span class="op">&gt;</span><span class="va">pmdinsdynamicms2</span></span>
<span><span class="va">pmdinsdynamic</span> <span class="op">&lt;-</span> <span class="va">ratio</span><span class="op">[</span><span class="va">rsdidx</span>,<span class="op">]</span></span>
<span><span class="va">pmdinsdynamic</span><span class="op">[</span><span class="va">idx</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">ratio</span><span class="op">[</span><span class="va">rsdidx</span>,<span class="op">]</span><span class="op">[</span><span class="va">idx</span>,<span class="op">]</span></span>
<span><span class="co"># get the pmd dynamic intensity across samples</span></span>
<span><span class="va">pmdinsdynamicall</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">pmdinsdynamic</span>,<span class="fl">2</span>,<span class="va">sum</span><span class="op">)</span></span>
<span><span class="co"># show the PMD dynamic intensity for each sample</span></span>
<span><span class="va">pmdinsdynamicall</span></span>
<span><span class="co">#&gt; 1405_Fish1_F1 1405_Fish1_F2 1405_Fish1_F3 1405_Fish2_F1 1405_Fish2_F2 </span></span>
<span><span class="co">#&gt;      374.1957      315.6090      388.0063      207.8236      233.4380 </span></span>
<span><span class="co">#&gt; 1405_Fish2_F3 1405_Fish3_F1 1405_Fish3_F2 1405_Fish3_F3 </span></span>
<span><span class="co">#&gt;      199.9064      283.4682      327.9651      256.2044</span></span></code></pre></div>
<p>You can also use <code>getpmddf</code> function extract all the
paired ions for multiple PMDs. Then you could generate the network based
on the output.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get details for certain pmd</span></span>
<span><span class="va">pmddf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getpmddf.html">getpmddf</a></span><span class="op">(</span><span class="va">mz</span>,pmd<span class="op">=</span><span class="va">hfpmd</span>,digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co"># viz by igraph package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r.igraph.org/" class="external-link">igraph</a></span><span class="op">)</span></span>
<span><span class="va">net</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/graph_from_data_frame.html" class="external-link">graph_from_data_frame</a></span><span class="op">(</span><span class="va">pmddf</span>,directed <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">pal</span> <span class="op">&lt;-</span> <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">diff2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">net</span>,vertex.label<span class="op">=</span><span class="cn">NA</span>,vertex.size <span class="op">=</span> <span class="fl">5</span>,edge.width <span class="op">=</span> <span class="fl">3</span>,edge.color <span class="op">=</span> <span class="va">pal</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">diff2</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>,main <span class="op">=</span> <span class="st">'PMD network'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>,bty <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>       legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">diff2</span><span class="op">)</span>,</span>
<span>       fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">pal</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">diff2</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, border<span class="op">=</span><span class="cn">NA</span>,horiz <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p><img src="reactomics_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>If you prefer to get a pmd network for a specific mass. You can still
use <code>getchain</code> function.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">spmeinvivo</span><span class="op">)</span></span>
<span><span class="va">spmeinvivo</span><span class="op">$</span><span class="va">rt</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">chain</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getchain.html">getchain</a></span><span class="op">(</span><span class="va">spmeinvivo</span>,diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.02</span>,<span class="fl">14.02</span>,<span class="fl">15.99</span>,<span class="fl">58.04</span>,<span class="fl">13.98</span><span class="op">)</span>,mass <span class="op">=</span> <span class="fl">286.3101</span>,digits <span class="op">=</span> <span class="fl">2</span>,corcutoff <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co"># show as network</span></span>
<span><span class="va">net</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/graph_from_data_frame.html" class="external-link">graph_from_data_frame</a></span><span class="op">(</span><span class="va">chain</span><span class="op">$</span><span class="va">sdac</span>,directed <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">pal</span> <span class="op">&lt;-</span> <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">net</span>,vertex.label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">name</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>,vertex.size <span class="op">=</span><span class="fl">5</span>,edge.width <span class="op">=</span> <span class="fl">3</span>,edge.color <span class="op">=</span> <span class="va">pal</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">diff2</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>,vertex.label.dist<span class="op">=</span><span class="fl">1</span>,vertex.color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">name</span><span class="op">)</span>,<span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">286.3101</span>,<span class="st">'red'</span>,<span class="st">'black'</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">'PMD network'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>,bty <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>       legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">diff2</span><span class="op">)</span>,</span>
<span>       fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">pal</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">diff2</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, border<span class="op">=</span><span class="cn">NA</span>,horiz <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p><img src="reactomics_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="pmd-reaction-database">PMD Reaction Database<a class="anchor" aria-label="anchor" href="#pmd-reaction-database"></a>
</h2>
<p>To check the pmd reaction database:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># all reaction</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"omics"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">omics</span><span class="op">)</span></span>
<span><span class="co">#&gt;   X   KEGG RHEA_ID DIRECTION MASTER_ID   ec ecocyc macie</span></span>
<span><span class="co">#&gt; 1 1 R00001   22455        BI     22452 &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2 2 R00004   24579        BI     24576 &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3 3 R00005   19032        BI     19029 &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4 4 R00008   22751        BI     22748 &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 5 5 R00009   20312        BI     20309 &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6 6 R00010   20871        BI     20868 &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;</span></span>
<span><span class="co">#&gt;                   metacyc reactome</span></span>
<span><span class="co">#&gt; 1 ENDOPOLYPHOSPHATASE-RXN     &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2   INORGPYROPHOSPHAT-RXN     &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3                    &lt;NA&gt;     &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4                    &lt;NA&gt;     &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 5                    &lt;NA&gt;     &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6                    &lt;NA&gt;     &lt;NA&gt;</span></span>
<span><span class="co">#&gt;                                                compounds     pmd</span></span>
<span><span class="co">#&gt; 1  [phosphate](n+1) + n H2O &lt;=&gt; n H(+) + (n+1) phosphate      NA</span></span>
<span><span class="co">#&gt; 2               diphosphate + H2O &lt;=&gt; H(+) + 2 phosphate      NA</span></span>
<span><span class="co">#&gt; 3 3 H(+) + H2O + urea-1-carboxylate &lt;=&gt; 2 CO2 + 2 NH4(+)      NA</span></span>
<span><span class="co">#&gt; 4       4-hydroxy-4-methyl-2-oxoglutarate &lt;=&gt; 2 pyruvate      NA</span></span>
<span><span class="co">#&gt; 5                                  2 H2O2 &lt;=&gt; 2 H2O + O2      NA</span></span>
<span><span class="co">#&gt; 6            alpha,alpha-trehalose + H2O &lt;=&gt; 2 D-glucose 162.053</span></span>
<span><span class="co"># kegg reaction</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"keggrall"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">keggrall</span><span class="op">)</span></span>
<span><span class="co">#&gt;      rid              rc                      ez      ms1      formula1</span></span>
<span><span class="co">#&gt; 1 R00002         RC00002                1.18.6.1 506.9957 C10H16N5O13P3</span></span>
<span><span class="co">#&gt; 2 R00010         RC00049                3.2.1.28 342.1162     C12H22O11</span></span>
<span><span class="co">#&gt; 3 R00012         RC00002                2.7.7.45 522.9907 C10H16N5O14P3</span></span>
<span><span class="co">#&gt; 4 R00014 RC00027;RC02744 1.2.4.1;2.2.1.6;4.1.1.1 425.0450 C12H19N4O7P2S</span></span>
<span><span class="co">#&gt; 5 R00015 RC00077;RC00247                2.4.1.99 342.1162     C12H22O11</span></span>
<span><span class="co">#&gt; 6 R00015 RC00077;RC00247                2.4.1.99 342.1162     C12H22O11</span></span>
<span><span class="co">#&gt;        ms2       formula2     pmd  C  H O N P S</span></span>
<span><span class="co">#&gt; 1 427.0294  C10H15N5O10P2  79.966  0  1 3 0 1 0</span></span>
<span><span class="co">#&gt; 2 180.0634        C6H12O6 162.053  6 10 5 0 0 0</span></span>
<span><span class="co">#&gt; 3 868.0381 C20H28N10O21P4 345.047 10 12 7 5 1 0</span></span>
<span><span class="co">#&gt; 4 469.0712  C14H23N4O8P2S  44.026  2  4 1 0 0 0</span></span>
<span><span class="co">#&gt; 5 180.0634        C6H12O6 162.053  6 10 5 0 0 0</span></span>
<span><span class="co">#&gt; 6 504.1690      C18H32O16 162.053  6 10 5 0 0 0</span></span>
<span><span class="co"># literature reaction for mass spectrometry</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"sda"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sda</span><span class="op">)</span></span>
<span><span class="co">#&gt;         PMD                                                          origin</span></span>
<span><span class="co">#&gt; 1  0.984016                    OH ↔ NH2, e.g. de-amidiation, CHNO compounds</span></span>
<span><span class="co">#&gt; 2  1.995663 F ↔ OH, halogen exchange with hydroxy group (typically -F + OH)</span></span>
<span><span class="co">#&gt; 3  2.015650                         ± 2H, opening or forming of double bond</span></span>
<span><span class="co">#&gt; 4  7.004671                       F ↔ CN, halogen exchange with cyano group</span></span>
<span><span class="co">#&gt; 5  8.965779                      Cl ↔ CN, halogen exchange with cyano group</span></span>
<span><span class="co">#&gt; 6 13.979265               O ↔ 2H, e.g. Oxidation follwed by H2O elimination</span></span>
<span><span class="co">#&gt;                                            Ref. mode</span></span>
<span><span class="co">#&gt; 1 https://doi.org/10.1016/S1044-0305(99)00090-2    b</span></span>
<span><span class="co">#&gt; 2 https://doi.org/10.1016/S1044-0305(99)00090-2    e</span></span>
<span><span class="co">#&gt; 3 https://doi.org/10.1016/S1044-0305(99)00090-2    b</span></span>
<span><span class="co">#&gt; 4 https://doi.org/10.1016/S1044-0305(99)00090-2    e</span></span>
<span><span class="co">#&gt; 5 https://doi.org/10.1016/S1044-0305(99)00090-2    e</span></span>
<span><span class="co">#&gt; 6 https://doi.org/10.1016/S1044-0305(99)00090-2    b</span></span></code></pre></div>
<p>To check the HMDB pmd database:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"hmdb"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">hmdb</span><span class="op">)</span></span>
<span><span class="co">#&gt;    C  H  O N P S   pmd pmd2 percentage</span></span>
<span><span class="co">#&gt; 1 -3  4  2 0 0 0 0.021 0.02  0.9623060</span></span>
<span><span class="co">#&gt; 2  1  4 -1 0 0 0 0.036 0.04  0.9503645</span></span>
<span><span class="co">#&gt; 3  5  4 -4 0 0 0 0.052 0.05  0.9412861</span></span>
<span><span class="co">#&gt; 4  2  8 -2 0 0 0 0.073 0.07  0.9617834</span></span>
<span><span class="co">#&gt; 5  6  8 -5 0 0 0 0.088 0.09  0.9247730</span></span>
<span><span class="co">#&gt; 6 -1 12  0 0 0 0 0.094 0.09  0.9648936</span></span></code></pre></div>
<p>To extract any compound KEGG compound’s pmd network with known
PMD:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotcn.html">plotcn</a></span><span class="op">(</span><span class="st">'C6H12O6'</span>,<span class="st">'Glucose'</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.016</span>,<span class="fl">14.016</span>,<span class="fl">15.995</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Average distance of PMD network is 9.42710759198882</span></span>
<span><span class="co">#&gt; Average degree 2.8421052631579</span></span></code></pre></div>
<p><img src="reactomics_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Miao YU.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

      </footer>
</div>






  </body>
</html>
