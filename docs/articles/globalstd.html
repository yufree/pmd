<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis • pmd</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis">
<meta property="og:description" content="pmd">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-58201304-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-58201304-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pmd</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/globalstd.html">Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis</a>
    </li>
    <li>
      <a href="../articles/reactomics.html">Reactomics</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/yufree/pmd/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Paired Mass Distance(PMD) analysis for GC/LC-MS
based non-targeted analysis</h1>
                        <h4 data-toc-skip class="author">Miao Yu</h4>
            
            <h4 data-toc-skip class="date">2024-04-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/yufree/pmd/blob/HEAD/vignettes/globalstd.Rmd" class="external-link"><code>vignettes/globalstd.Rmd</code></a></small>
      <div class="hidden name"><code>globalstd.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction-of-paired-mass-distance-analysis">Introduction of Paired Mass Distance analysis<a class="anchor" aria-label="anchor" href="#introduction-of-paired-mass-distance-analysis"></a>
</h2>
<p><code>pmd</code> package use Paired Mass Distance (PMD) relationship
to analysis the GC/LC-MS based non-targeted data. PMD means the distance
between two masses or mass to charge ratios. In mass spectrometry, PMD
would keep the same value between two masses and two mass to charge
ratios(m/z). There are two kinds of PMD involved in this package: PMD
from the same compound and PMD from different compounds. In GC/LC-MS or
XCMS based non-targeted data analysis, peaks could be separated by
chronograph and same compound means ions from similar retention times or
ions co-eluted by certain column.</p>
<div class="section level3">
<h3 id="pmd-from-the-same-compound">PMD from the same compound<a class="anchor" aria-label="anchor" href="#pmd-from-the-same-compound"></a>
</h3>
<p>For MS1 full scan data, we could build retention time(RT) bins to
assign peaks into different RT groups by retention time hierarchical
clustering analysis. For each RT group, the peaks should come from same
compounds or co-elutes. If certain PMD appeared in multiple RT groups,
it would be related to the relationship about adducts, neutral loss,
isotopologues or common fragments ions.</p>
</div>
<div class="section level3">
<h3 id="pmd-from-different-compounds">PMD from different compounds<a class="anchor" aria-label="anchor" href="#pmd-from-different-compounds"></a>
</h3>
<p>The peaks from different retention time groups would like to be
different compounds separated by chronograph. The PMD would reflect the
relationship about homologous series or chemical reactions.</p>
<p>GlobalStd algorithm use the PMD within same RT group to find
independent peaks among certain data set. Then, structure/reaction
directed analysis use PMD from different RT groups to screen important
compounds or reactions.</p>
</div>
</div>
<div class="section level2">
<h2 id="data-format">Data format<a class="anchor" aria-label="anchor" href="#data-format"></a>
</h2>
<p>The input data should be a <code>list</code> object with at least two
elements from a peaks list:</p>
<ul>
<li>mass to charge ratio with name of <code>mz</code>, high resolution
mass spectrometry is required</li>
<li>retention time with name of <code>rt</code>
</li>
</ul>
<p>However, I suggested to add intensity and group information to the
list for validation of PMD analysis.</p>
<p>In this package, a data set from <em>in vivo</em> solid phase
micro-extraction(SPME) was attached. This data set contain 9 samples
from 3 fish with triplicates samples for each fish. Here is the data
structure:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yufree.github.io/pmd/" class="external-link">pmd</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"spmeinvivo"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">spmeinvivo</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 4</span></span>
<span><span class="co">#&gt;  $ data : num [1:1459, 1:9] 1095 10439 10154 2797 90211 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:1459] "100.1/170" "100.5/86" "101/85" "103.1/348" ...</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:9] "1405_Fish1_F1" "1405_Fish1_F2" "1405_Fish1_F3" "1405_Fish2_F1" ...</span></span>
<span><span class="co">#&gt;  $ group:'data.frame':   9 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   ..$ sample_name : chr [1:9] "1405_Fish1_F1" "1405_Fish1_F2" "1405_Fish1_F3" "1405_Fish2_F1" ...</span></span>
<span><span class="co">#&gt;   ..$ sample_group: chr [1:9] "fish1" "fish1" "fish1" "fish2" ...</span></span>
<span><span class="co">#&gt;  $ mz   : num [1:1459] 100 101 101 103 104 ...</span></span>
<span><span class="co">#&gt;  $ rt   : num [1:1459] 170.2 86.3 84.9 348.1 48.8 ...</span></span></code></pre></div>
<p>You could build this <code>list</code> or <code>mzrt</code> object
from the <code>xcms</code> objects via <code>enviGCMS</code> package.
When you have a <code>xcmsSet</code> object or <code>XCMSnExp</code>
object named <code>xset</code>, you could use
<code>enviGCMS::getmzrt(xset)</code> to get such list. Of course you
could build such list by yourself.</p>
</div>
<div class="section level2">
<h2 id="globalstd-algorithm">GlobalStd algorithm<a class="anchor" aria-label="anchor" href="#globalstd-algorithm"></a>
</h2>
<p>GlobalStd algorithm try to find independent peaks among certain peaks
list. The first step is retention time hierarchical clustering analysis.
The second step is to find the relationship among adducts, neutral loss,
isotopologues and common fragments ions. The third step is to screen the
independent peaks.</p>
<p>Here is a workflow for this algorithm:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html" class="external-link">include_graphics</a></span><span class="op">(</span><span class="st">'https://yufree.github.io/presentation/figure/GlobalStd.png'</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://yufree.github.io/presentation/figure/GlobalStd.png"><!-- --></p>
<div class="section level3">
<h3 id="step1-retention-time-hierarchical-clustering">STEP1: Retention time hierarchical clustering<a class="anchor" aria-label="anchor" href="#step1-retention-time-hierarchical-clustering"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pmd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getpaired.html">getpaired</a></span><span class="op">(</span><span class="va">spmeinvivo</span><span class="op">)</span></span>
<span><span class="co">#&gt; 75 retention time cluster found.</span></span>
<span><span class="co">#&gt; 369 paired masses found</span></span>
<span><span class="co">#&gt; 5 unique within RT clusters high frequency PMD(s) used for further investigation.</span></span>
<span><span class="co">#&gt; The unique within RT clusters high frequency PMD(s) is(are)  28.03 21.98 44.03 17.03 18.01.</span></span>
<span><span class="co">#&gt; 719 isotopologue(s) related paired mass found.</span></span>
<span><span class="co">#&gt; 492 multi-charger(s) related paired mass found.</span></span>
<span><span class="fu"><a href="../reference/plotrtg.html">plotrtg</a></span><span class="op">(</span><span class="va">pmd</span><span class="op">)</span></span></code></pre></div>
<p><img src="globalstd_files/figure-html/rtg-1.png" width="700"></p>
<p>This plot would show the distribution of RT groups. The
<code>rtcutoff</code> in function <code>getpaired</code> could be used
to set the cutoff of the distances in retention time hierarchical
clustering analysis. Retention time cluster cutoff should fit the peak
picking algorithm. For HPLC, 10 is suggested and 5 could be used for
UPLC.</p>
<p>Global PMD’s retention time group numbers should be around 20 percent
of the retention time cluster numbers. For example, if you find 100
retention time clusters, I suggested you use 20 as the cutoff of
empirical global PMD’s retention time group numbers. If you don’t
specifically assign a value to <code>ng</code>, the algorithm will
select such recommendation by default setting.</p>
<p>Take care of the retention time cluster with lots of peaks. In this
case, such cluster could be co-eluted compounds on certain column. It
would be wise to trim the retention time window for high quality peaks.
Another important hint is that pre-filter your peak list by black
samples or other quality control samples. Otherwise the running time
would be long and lots of pmd relationship would be just from noise.</p>
</div>
<div class="section level3">
<h3 id="step2-relationship-among-adducts-neutral-loss-isotopologues-and-common-fragments-ions">STEP2: Relationship among adducts, neutral loss, isotopologues and
common fragments ions<a class="anchor" aria-label="anchor" href="#step2-relationship-among-adducts-neutral-loss-isotopologues-and-common-fragments-ions"></a>
</h3>
<p>The <code>ng</code> in function <code>getpaired</code> could be used
to set cutoff of global PMD’s retention time group numbers. If
<code>ng</code> is 10, at least 10 of the retention time groups should
contain the shown PMD relationship. You could use
<code>plotpaired</code> to show the distribution.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotpaired.html">plotpaired</a></span><span class="op">(</span><span class="va">pmd</span><span class="op">)</span></span></code></pre></div>
<p><img src="globalstd_files/figure-html/pmd-1.png" width="700"></p>
<p>You could also show the distribution of PMD relationship by
index:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># show the unique PMD found by getpaired function</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">pmd</span><span class="op">$</span><span class="va">paired</span><span class="op">$</span><span class="va">diff2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">pmd</span><span class="op">$</span><span class="va">paired</span><span class="op">$</span><span class="va">diff2</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>        <span class="va">index</span> <span class="op">&lt;-</span> <span class="va">pmd</span><span class="op">$</span><span class="va">paired</span><span class="op">$</span><span class="va">diff2</span> <span class="op">==</span> <span class="va">diff</span></span>
<span>        <span class="fu"><a href="../reference/plotpaired.html">plotpaired</a></span><span class="op">(</span><span class="va">pmd</span>,<span class="va">index</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="globalstd_files/figure-html/pmdindex-1.png" width="700"><img src="globalstd_files/figure-html/pmdindex-2.png" width="700"><img src="globalstd_files/figure-html/pmdindex-3.png" width="700"><img src="globalstd_files/figure-html/pmdindex-4.png" width="700"><img src="globalstd_files/figure-html/pmdindex-5.png" width="700"></p>
<p>This is an easy way to find potential adducts of the data by high
frequency PMD from the same compound. For example, 21.98 Da could be the
mass distances between <span class="math inline">\([M+H]^+\)</span> and
<span class="math inline">\([M+Na]^+\)</span>. In this case, user could
find the potential adducts or neutral loss even when they have no
preferred adducts list. If one adduct exist in certain analytical
system, the high frequency PMD will reveal such relationship. The high
frequency PMD list could also be used to check the fragmental pattern of
in-source reactions as long as such patterns are popular among all
collected ions.</p>
</div>
<div class="section level3">
<h3 id="step3-screen-the-independent-peaks">STEP3: Screen the independent peaks<a class="anchor" aria-label="anchor" href="#step3-screen-the-independent-peaks"></a>
</h3>
<p>You could use <code>getstd</code> function to get the independent
peaks. Independent peaks mean the peaks list removing the redundant
peaks such as adducts, neutral loss, isotopologues and comment fragments
ions found by PMD analysis in STEP2. Ideally, those peaks could be
molecular ions while they might still contain redundant peaks.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">std</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getstd.html">getstd</a></span><span class="op">(</span><span class="va">pmd</span><span class="op">)</span></span>
<span><span class="co">#&gt; 8 retention group(s) have single peaks. 14 23 32 33 54 55 56 75</span></span>
<span><span class="co">#&gt; 11 group(s) with multiple peaks while no isotope/paired relationship 4 5 7 8 11 41 42 49 68 72 73</span></span>
<span><span class="co">#&gt; 9 group(s) with multiple peaks with isotope without paired relationship 2 9 22 26 52 62 64 66 70</span></span>
<span><span class="co">#&gt; 4 group(s) with paired relationship without isotope 1 10 15 18</span></span>
<span><span class="co">#&gt; 43 group(s) with paired relationship and isotope 3 6 12 13 16 17 19 20 21 24 25 27 28 29 30 31 34 35 36 37 38 39 40 43 44 45 46 47 48 50 51 53 57 58 59 60 61 63 65 67 69 71 74</span></span>
<span><span class="co">#&gt; 291 std mass found.</span></span></code></pre></div>
<p>Here you could plot the peaks by <code>plotstd</code> function to
show the distribution of independent peaks:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotstd.html">plotstd</a></span><span class="op">(</span><span class="va">std</span><span class="op">)</span></span></code></pre></div>
<p><img src="globalstd_files/figure-html/stdplot-1.png" width="700"></p>
<p>You could also plot the peaks distribution by assign a retention time
group via <code>plotstdrt</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotstdrt.html">plotstdrt</a></span><span class="op">(</span><span class="va">std</span>,rtcluster <span class="op">=</span> <span class="fl">23</span>,main <span class="op">=</span> <span class="st">'Retention time group 23'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotstdrt.html">plotstdrt</a></span><span class="op">(</span><span class="va">std</span>,rtcluster <span class="op">=</span> <span class="fl">9</span>,main <span class="op">=</span> <span class="st">'Retention time group 9'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotstdrt.html">plotstdrt</a></span><span class="op">(</span><span class="va">std</span>,rtcluster <span class="op">=</span> <span class="fl">18</span>,main <span class="op">=</span> <span class="st">'Retention time group 18'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotstdrt.html">plotstdrt</a></span><span class="op">(</span><span class="va">std</span>,rtcluster <span class="op">=</span> <span class="fl">67</span>,main <span class="op">=</span> <span class="st">'Retention time group 67'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotstdrt.html">plotstdrt</a></span><span class="op">(</span><span class="va">std</span>,rtcluster <span class="op">=</span> <span class="fl">49</span>,main <span class="op">=</span> <span class="st">'Retention time group 49'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotstdrt.html">plotstdrt</a></span><span class="op">(</span><span class="va">std</span>,rtcluster <span class="op">=</span> <span class="fl">6</span>,main <span class="op">=</span> <span class="st">'Retention time group 6'</span><span class="op">)</span></span></code></pre></div>
<p><img src="globalstd_files/figure-html/stdrtplot-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="extra-filter-with-correlation-coefficient-cutoff">Extra filter with correlation coefficient cutoff<a class="anchor" aria-label="anchor" href="#extra-filter-with-correlation-coefficient-cutoff"></a>
</h3>
<p>Original GlobalStd algorithm only use mass to charge ratio and
retention time of peaks to select independent peaks. However, if
intensity data across samples are available, correlation coefficient of
paired ions could be used to further filter the random noise in high
frequency PMDs. You could set up cutoff of Pearson Correlation
Coefficient between peaks to refine the peaks selected by GlobalStd
within same retention time groups. In this case, the numbers of selected
independent peaks will be further reduced. When you use this parameter,
make sure the intensity data are from real samples instead of blank
samples, which will affect the calculation of correlation
coefficient.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">std2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getstd.html">getstd</a></span><span class="op">(</span><span class="va">pmd</span>,corcutoff <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span>
<span><span class="co">#&gt; 8 retention group(s) have single peaks. 14 23 32 33 54 55 56 75</span></span>
<span><span class="co">#&gt; 23 group(s) with multiple peaks while no isotope/paired relationship 2 4 5 7 8 10 11 15 18 26 35 39 41 42 49 50 59 62 68 69 70 72 73</span></span>
<span><span class="co">#&gt; 14 group(s) with multiple peaks with isotope without paired relationship 9 12 22 24 27 28 34 51 52 57 60 64 66 71</span></span>
<span><span class="co">#&gt; 3 group(s) with paired relationship without isotope 1 53 74</span></span>
<span><span class="co">#&gt; 27 group(s) with paired relationship and isotope 3 6 13 16 17 19 20 21 25 29 30 31 36 37 38 40 43 44 45 46 47 48 58 61 63 65 67</span></span>
<span><span class="co">#&gt; 120 std mass found.</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="validation-by-principal-components-analysispca">Validation by principal components analysis(PCA)<a class="anchor" aria-label="anchor" href="#validation-by-principal-components-analysispca"></a>
</h2>
<p>You need to check the GlobalStd algorithm’s results by principal
components analysis(PCA). If we removed too much peaks containing
information, the score plot of reduced data set would show great
changes.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/yufree/enviGCMS" class="external-link">enviGCMS</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">+</span><span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html" class="external-link">plotpca</a></span><span class="op">(</span><span class="va">std</span><span class="op">$</span><span class="va">data</span>,lv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">std</span><span class="op">$</span><span class="va">group</span><span class="op">$</span><span class="va">sample_group</span><span class="op">)</span><span class="op">)</span>,main <span class="op">=</span> <span class="st">"all peaks"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html" class="external-link">plotpca</a></span><span class="op">(</span><span class="va">std</span><span class="op">$</span><span class="va">data</span><span class="op">[</span><span class="va">std</span><span class="op">$</span><span class="va">stdmassindex</span>,<span class="op">]</span>,lv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">std</span><span class="op">$</span><span class="va">group</span><span class="op">$</span><span class="va">sample_group</span><span class="op">)</span><span class="op">)</span>,main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">std</span><span class="op">$</span><span class="va">stdmassindex</span><span class="op">)</span>,<span class="st">"independent peaks"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html" class="external-link">plotpca</a></span><span class="op">(</span><span class="va">std2</span><span class="op">$</span><span class="va">data</span><span class="op">[</span><span class="va">std2</span><span class="op">$</span><span class="va">stdmassindex</span>,<span class="op">]</span>,lv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">std</span><span class="op">$</span><span class="va">group</span><span class="op">$</span><span class="va">sample_group</span><span class="op">)</span><span class="op">)</span>,main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">std2</span><span class="op">$</span><span class="va">stdmassindex</span><span class="op">)</span>,<span class="st">"reduced independent peaks"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="globalstd_files/figure-html/pca-1.png" width="700"></p>
<p>You might find original GlobalStd algorithm show a similar PCA score
plot with original data while GlobalStd algorithm considering intensity
data seems change the profile. The major reason is that correlation
coefficient option in the algorithm will remove the paired ions without
strong correlation. It will be aggressive to remove low intensity peaks,
which are vulnerable by baseline noise. However, such options would be
helpful if you only concern high quality peaks for following analysis.
Otherwise, original GlobalStd will keep the most information for
explorer purpose.</p>
</div>
<div class="section level2">
<h2 id="comparison-with-other-pseudo-spectra-extraction-method">Comparison with other pseudo spectra extraction method<a class="anchor" aria-label="anchor" href="#comparison-with-other-pseudo-spectra-extraction-method"></a>
</h2>
<p>GlobalStd algorithm in <code>pmd</code> package could be treated as a
method to extract pseudo spectra. You could use <code>getcluster</code>
to get peaks groups information for all GlobalStd peaks. This function
would consider the merge of GlobalStd peaks when certain peak is
involved in multiple clusters. Then you could choose export peaks with
the highest intensities or base peaks in each GlobalStd merged peaks
groups. Meanwhile, you could also include the correlation coefficient
cutoff to further improve the data quality.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stdcluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getcluster.html">getcluster</a></span><span class="op">(</span><span class="va">std</span><span class="op">)</span></span>
<span><span class="co"># extract pseudospectra for std peak 71</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">stdcluster</span><span class="op">$</span><span class="va">cluster</span><span class="op">$</span><span class="va">largei</span><span class="op">[</span><span class="va">stdcluster</span><span class="op">$</span><span class="va">cluster</span><span class="op">$</span><span class="va">i</span><span class="op">==</span><span class="fl">71</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">stdcluster</span><span class="op">$</span><span class="va">cluster</span><span class="op">$</span><span class="va">mz</span><span class="op">[</span><span class="va">stdcluster</span><span class="op">$</span><span class="va">cluster</span><span class="op">$</span><span class="va">largei</span><span class="op">==</span><span class="va">idx</span><span class="op">]</span>,<span class="va">stdcluster</span><span class="op">$</span><span class="va">cluster</span><span class="op">$</span><span class="va">ins</span><span class="op">[</span><span class="va">stdcluster</span><span class="op">$</span><span class="va">cluster</span><span class="op">$</span><span class="va">largei</span><span class="op">==</span><span class="va">idx</span><span class="op">]</span>,type <span class="op">=</span> <span class="st">'h'</span>,xlab <span class="op">=</span> <span class="st">'m/z'</span>,ylab <span class="op">=</span> <span class="st">'intensity'</span>,main <span class="op">=</span> <span class="st">'pseudo spectra for GlobalStd peak 71'</span><span class="op">)</span></span></code></pre></div>
<p><img src="globalstd_files/figure-html/comp-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># export peaks with the highest intensities in each GlobalStd peaks groups.</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">stdcluster</span><span class="op">$</span><span class="va">data</span><span class="op">[</span><span class="va">stdcluster</span><span class="op">$</span><span class="va">stdmassindex2</span>,<span class="op">]</span></span>
<span><span class="co"># considering the correlation coefficient cutoff</span></span>
<span><span class="va">stdcluster2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getcluster.html">getcluster</a></span><span class="op">(</span><span class="va">std</span>, corcutoff <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span>
<span><span class="co"># considering the correlation coefficient cutoff for both psedospectra extraction and GlobalStd algorithm</span></span>
<span><span class="va">stdcluster3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getcluster.html">getcluster</a></span><span class="op">(</span><span class="va">std2</span>, corcutoff <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span></code></pre></div>
<p>We supplied <code>getcorcluster</code> to find peaks groups by
correlation analysis only. The base peaks of correlation cluster were
selected to stand for the compounds.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">corcluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getcorcluster.html">getcorcluster</a></span><span class="op">(</span><span class="va">spmeinvivo</span><span class="op">)</span></span>
<span><span class="co">#&gt; 75 retention time cluster found.</span></span>
<span><span class="co"># extract pseudospectra 1@46</span></span>
<span><span class="va">peak</span> <span class="op">&lt;-</span> <span class="va">corcluster</span><span class="op">$</span><span class="va">cluster</span><span class="op">[</span><span class="va">corcluster</span><span class="op">$</span><span class="va">cluster</span><span class="op">$</span><span class="va">largei</span> <span class="op">==</span> <span class="st">'1@46'</span>,<span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">peak</span><span class="op">$</span><span class="va">ins</span><span class="op">~</span><span class="va">peak</span><span class="op">$</span><span class="va">mz</span>,type <span class="op">=</span> <span class="st">'h'</span>,xlab <span class="op">=</span> <span class="st">'m/z'</span>,ylab <span class="op">=</span> <span class="st">'intensity'</span>,main <span class="op">=</span> <span class="st">'pseudo spectra for correlation cluster'</span><span class="op">)</span></span></code></pre></div>
<p><img src="globalstd_files/figure-html/corpeak-1.png" width="700"></p>
<p>Then we could compare the compare reduced result using PCA similarity
factor. A good peak selection algorithm could show a high PCA similarity
factor compared with original data set while retain the minimized number
of peaks.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>,mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">+</span><span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html" class="external-link">plotpca</a></span><span class="op">(</span><span class="va">std</span><span class="op">$</span><span class="va">data</span><span class="op">[</span><span class="va">std</span><span class="op">$</span><span class="va">stdmassindex</span>,<span class="op">]</span>,lv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">std</span><span class="op">$</span><span class="va">group</span><span class="op">$</span><span class="va">sample_group</span><span class="op">)</span><span class="op">)</span>,main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">std</span><span class="op">$</span><span class="va">stdmassindex</span><span class="op">)</span>,<span class="st">"independent peaks"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html" class="external-link">plotpca</a></span><span class="op">(</span><span class="va">std</span><span class="op">$</span><span class="va">data</span><span class="op">[</span><span class="va">stdcluster</span><span class="op">$</span><span class="va">stdmassindex2</span>,<span class="op">]</span>,lv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">std</span><span class="op">$</span><span class="va">group</span><span class="op">$</span><span class="va">sample_group</span><span class="op">)</span><span class="op">)</span>,main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">stdcluster</span><span class="op">$</span><span class="va">stdmassindex2</span><span class="op">)</span>,<span class="st">"independent base peaks"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html" class="external-link">plotpca</a></span><span class="op">(</span><span class="va">std</span><span class="op">$</span><span class="va">data</span><span class="op">[</span><span class="va">stdcluster2</span><span class="op">$</span><span class="va">stdmassindex2</span>,<span class="op">]</span>,lv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">std</span><span class="op">$</span><span class="va">group</span><span class="op">$</span><span class="va">sample_group</span><span class="op">)</span><span class="op">)</span>,main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">stdcluster2</span><span class="op">$</span><span class="va">stdmassindex2</span><span class="op">)</span>,<span class="st">"independent reduced base peaks"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html" class="external-link">plotpca</a></span><span class="op">(</span><span class="va">std</span><span class="op">$</span><span class="va">data</span><span class="op">[</span><span class="va">corcluster</span><span class="op">$</span><span class="va">stdmassindex</span>,<span class="op">]</span>,lv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">std</span><span class="op">$</span><span class="va">group</span><span class="op">$</span><span class="va">sample_group</span><span class="op">)</span><span class="op">)</span>,main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">corcluster</span><span class="op">$</span><span class="va">stdmassindex</span><span class="op">)</span>,<span class="st">"peaks without correlationship"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html" class="external-link">plotpca</a></span><span class="op">(</span><span class="va">std</span><span class="op">$</span><span class="va">data</span><span class="op">[</span><span class="va">corcluster</span><span class="op">$</span><span class="va">stdmassindex2</span>,<span class="op">]</span>,lv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">std</span><span class="op">$</span><span class="va">group</span><span class="op">$</span><span class="va">sample_group</span><span class="op">)</span><span class="op">)</span>,main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">corcluster</span><span class="op">$</span><span class="va">stdmassindex2</span><span class="op">)</span>,<span class="st">"base peaks without correlationship"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html" class="external-link">plotpca</a></span><span class="op">(</span><span class="va">std</span><span class="op">$</span><span class="va">data</span>,lv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">std</span><span class="op">$</span><span class="va">group</span><span class="op">$</span><span class="va">sample_group</span><span class="op">)</span><span class="op">)</span>,main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">std</span><span class="op">$</span><span class="va">data</span><span class="op">)</span>,<span class="st">"all peaks"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html" class="external-link">plotpca</a></span><span class="op">(</span><span class="va">std</span><span class="op">$</span><span class="va">data</span><span class="op">[</span><span class="va">stdcluster3</span><span class="op">$</span><span class="va">stdmassindex2</span>,<span class="op">]</span>,lv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">std</span><span class="op">$</span><span class="va">group</span><span class="op">$</span><span class="va">sample_group</span><span class="op">)</span><span class="op">)</span>,main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">stdcluster3</span><span class="op">$</span><span class="va">stdmassindex2</span><span class="op">)</span>,<span class="st">"reduced independent base peaks"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pcasf.html">pcasf</a></span><span class="op">(</span><span class="va">std</span><span class="op">$</span><span class="va">data</span>, <span class="va">std</span><span class="op">$</span><span class="va">data</span><span class="op">[</span><span class="va">std</span><span class="op">$</span><span class="va">stdmassindex</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;     pcasf </span></span>
<span><span class="co">#&gt; 0.9993497</span></span>
<span><span class="fu"><a href="../reference/pcasf.html">pcasf</a></span><span class="op">(</span><span class="va">std</span><span class="op">$</span><span class="va">data</span>, <span class="va">std</span><span class="op">$</span><span class="va">data</span><span class="op">[</span><span class="va">stdcluster</span><span class="op">$</span><span class="va">stdmassindex2</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;     pcasf </span></span>
<span><span class="co">#&gt; 0.9993578</span></span>
<span><span class="fu"><a href="../reference/pcasf.html">pcasf</a></span><span class="op">(</span><span class="va">std</span><span class="op">$</span><span class="va">data</span>, <span class="va">std</span><span class="op">$</span><span class="va">data</span><span class="op">[</span><span class="va">stdcluster2</span><span class="op">$</span><span class="va">stdmassindex2</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;    pcasf </span></span>
<span><span class="co">#&gt; 0.999346</span></span>
<span><span class="fu"><a href="../reference/pcasf.html">pcasf</a></span><span class="op">(</span><span class="va">std</span><span class="op">$</span><span class="va">data</span>, <span class="va">std</span><span class="op">$</span><span class="va">data</span><span class="op">[</span><span class="va">corcluster</span><span class="op">$</span><span class="va">stdmassindex</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;     pcasf </span></span>
<span><span class="co">#&gt; 0.9471586</span></span>
<span><span class="fu"><a href="../reference/pcasf.html">pcasf</a></span><span class="op">(</span><span class="va">std</span><span class="op">$</span><span class="va">data</span>, <span class="va">std</span><span class="op">$</span><span class="va">data</span><span class="op">[</span><span class="va">corcluster</span><span class="op">$</span><span class="va">stdmassindex2</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;     pcasf </span></span>
<span><span class="co">#&gt; 0.9497193</span></span>
<span><span class="fu"><a href="../reference/pcasf.html">pcasf</a></span><span class="op">(</span><span class="va">std</span><span class="op">$</span><span class="va">data</span>, <span class="va">std</span><span class="op">$</span><span class="va">data</span><span class="op">[</span><span class="va">stdcluster3</span><span class="op">$</span><span class="va">stdmassindex2</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;    pcasf </span></span>
<span><span class="co">#&gt; 0.713527</span></span></code></pre></div>
<p><img src="globalstd_files/figure-html/corcomp-1.png" width="700"></p>
<p>In this case, five peaks selection algorithms are fine to stand for
the original peaks with PCA similarity score larger than 0.9. However,
the independent base peaks retain the most information with relative low
numbers of peaks.</p>
</div>
<div class="section level2">
<h2 id="structurereaction-directed-analysis">Structure/Reaction directed analysis<a class="anchor" aria-label="anchor" href="#structurereaction-directed-analysis"></a>
</h2>
<p><code>getsda</code> function could be used to perform
Structure/reaction directed analysis. The cutoff of frequency is
automate found by PMD network analysis with the largest mean distance of
all nodes.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sda</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getsda.html">getsda</a></span><span class="op">(</span><span class="va">std</span><span class="op">)</span></span>
<span><span class="co">#&gt; PMD frequency cutoff is 6 by PMD network analysis with largest network average distance 6.67 .</span></span>
<span><span class="co">#&gt; 53 groups were found as high frequency PMD group.</span></span>
<span><span class="co">#&gt; 0 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 1.98 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 2.01 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 2.02 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 6.97 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 11.96 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 12 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 13.98 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 14.02 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 14.05 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 15.99 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 16.03 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 19.04 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 28.03 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 30.05 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 31.99 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 33.02 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 37.02 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 42.05 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 48.04 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 48.98 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 49.02 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 54.05 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 56.06 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 56.1 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 58.04 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 58.08 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 58.11 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 63.96 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 66.05 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 68.06 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 70.04 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 70.08 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 74.02 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 80.03 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 82.08 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 88.05 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 91.1 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 93.12 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 94.1 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 96.09 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 101.05 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 108.13 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 110.11 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 112.16 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 116.08 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 122.15 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 124.16 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 126.14 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 144.18 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 148.04 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 150.2 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 173.18 was found as high frequency PMD.</span></span></code></pre></div>
<p>Such largest mean distance of all nodes is calculated for top 1 to
100 (if possible) high frequency PMDs. Here is a demo for the network
generation process.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r.igraph.org/" class="external-link">igraph</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'igraph'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     decompose, spectrum</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     union</span></span>
<span><span class="va">cdf</span> <span class="op">&lt;-</span> <span class="va">sda</span><span class="op">$</span><span class="va">sda</span></span>
<span><span class="co"># get the PMDs and frequency</span></span>
<span><span class="va">pmds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">cdf</span><span class="op">$</span><span class="va">diff2</span><span class="op">)</span>,decreasing <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">freq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">cdf</span><span class="op">$</span><span class="va">diff2</span><span class="op">)</span>,decreasing <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co"># filter the frequency larger than 10 for demo</span></span>
<span><span class="va">pmds</span> <span class="op">&lt;-</span> <span class="va">pmds</span><span class="op">[</span><span class="va">freq</span><span class="op">&gt;</span><span class="fl">10</span><span class="op">]</span></span>
<span><span class="va">cdf</span> <span class="op">&lt;-</span> <span class="va">sda</span><span class="op">$</span><span class="va">sda</span><span class="op">[</span><span class="va">sda</span><span class="op">$</span><span class="va">sda</span><span class="op">$</span><span class="va">diff2</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">pmds</span>,<span class="op">]</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/graph_from_data_frame.html" class="external-link">graph_from_data_frame</a></span><span class="op">(</span><span class="va">cdf</span>,directed <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">l</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/layout_with_fr.html" class="external-link">layout_with_fr</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pmds</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/delete_edges.html" class="external-link">delete_edges</a></span><span class="op">(</span><span class="va">g</span>,<span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">diff2</span><span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span><span class="va">pmds</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">g2</span>,edge.width<span class="op">=</span><span class="fl">1</span>,vertex.label<span class="op">=</span><span class="st">""</span>,vertex.size<span class="op">=</span><span class="fl">1</span>,layout<span class="op">=</span><span class="va">l</span>,main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Top'</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pmds</span><span class="op">)</span><span class="op">-</span><span class="va">i</span>,<span class="st">'high frequency PMDs'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="globalstd_files/figure-html/unnamed-chunk-2-1.png" width="700"><img src="globalstd_files/figure-html/unnamed-chunk-2-2.png" width="700"><img src="globalstd_files/figure-html/unnamed-chunk-2-3.png" width="700"><img src="globalstd_files/figure-html/unnamed-chunk-2-4.png" width="700"><img src="globalstd_files/figure-html/unnamed-chunk-2-5.png" width="700"><img src="globalstd_files/figure-html/unnamed-chunk-2-6.png" width="700"><img src="globalstd_files/figure-html/unnamed-chunk-2-7.png" width="700"><img src="globalstd_files/figure-html/unnamed-chunk-2-8.png" width="700"><img src="globalstd_files/figure-html/unnamed-chunk-2-9.png" width="700"><img src="globalstd_files/figure-html/unnamed-chunk-2-10.png" width="700"><img src="globalstd_files/figure-html/unnamed-chunk-2-11.png" width="700"><img src="globalstd_files/figure-html/unnamed-chunk-2-12.png" width="700"><img src="globalstd_files/figure-html/unnamed-chunk-2-13.png" width="700"><img src="globalstd_files/figure-html/unnamed-chunk-2-14.png" width="700"><img src="globalstd_files/figure-html/unnamed-chunk-2-15.png" width="700"><img src="globalstd_files/figure-html/unnamed-chunk-2-16.png" width="700"><img src="globalstd_files/figure-html/unnamed-chunk-2-17.png" width="700"></p>
<p>Here we could find more and more compounds will be connected with
more high frequency PMDs. Meanwhile, the mean distance of all network
nodes will increase. However, some PMDs are generated by random
combination of ions. In this case, if we included those PMDs for the
network, the mean distance of all network nodes will decrease. Here, the
largest mean distance means no more information will be found for
certain data set and such value is used as the cutoff for high frequency
PMDs selection.</p>
<p>You could use <code>plotstdsda</code> to show the distribution of the
selected paired peaks.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotstdsda.html">plotstdsda</a></span><span class="op">(</span><span class="va">sda</span><span class="op">)</span></span></code></pre></div>
<p><img src="globalstd_files/figure-html/stdsda-1.png" width="700"></p>
<p>You could also use index to show the distribution of certain
PMDs.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>,mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">+</span><span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotstdsda.html">plotstdsda</a></span><span class="op">(</span><span class="va">sda</span>,<span class="va">sda</span><span class="op">$</span><span class="va">sda</span><span class="op">$</span><span class="va">diff2</span> <span class="op">==</span> <span class="fl">2.02</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotstdsda.html">plotstdsda</a></span><span class="op">(</span><span class="va">sda</span>,<span class="va">sda</span><span class="op">$</span><span class="va">sda</span><span class="op">$</span><span class="va">diff2</span> <span class="op">==</span> <span class="fl">28.03</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotstdsda.html">plotstdsda</a></span><span class="op">(</span><span class="va">sda</span>,<span class="va">sda</span><span class="op">$</span><span class="va">sda</span><span class="op">$</span><span class="va">diff2</span> <span class="op">==</span> <span class="fl">58.04</span><span class="op">)</span></span></code></pre></div>
<p><img src="globalstd_files/figure-html/stdsdaidx-1.png" width="700"></p>
<p>Structure/reaction directed analysis could be directly performed on
all the peaks, which is slow to process:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sdaall</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getsda.html">getsda</a></span><span class="op">(</span><span class="va">spmeinvivo</span><span class="op">)</span></span>
<span><span class="co">#&gt; PMD frequency cutoff is 104 by PMD network analysis with largest network average distance 14.06 .</span></span>
<span><span class="co">#&gt; 6 groups were found as high frequency PMD group.</span></span>
<span><span class="co">#&gt; 0 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 2.02 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 28.03 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 31.01 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 58.04 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 116.08 was found as high frequency PMD.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>,mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">+</span><span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotstdsda.html">plotstdsda</a></span><span class="op">(</span><span class="va">sdaall</span>,<span class="va">sdaall</span><span class="op">$</span><span class="va">sda</span><span class="op">$</span><span class="va">diff2</span> <span class="op">==</span> <span class="fl">2.02</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotstdsda.html">plotstdsda</a></span><span class="op">(</span><span class="va">sdaall</span>,<span class="va">sdaall</span><span class="op">$</span><span class="va">sda</span><span class="op">$</span><span class="va">diff2</span> <span class="op">==</span> <span class="fl">28.03</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotstdsda.html">plotstdsda</a></span><span class="op">(</span><span class="va">sdaall</span>,<span class="va">sdaall</span><span class="op">$</span><span class="va">sda</span><span class="op">$</span><span class="va">diff2</span> <span class="op">==</span> <span class="fl">58.04</span><span class="op">)</span></span></code></pre></div>
<p><img src="globalstd_files/figure-html/all-1.png" width="700"></p>
<div class="section level3">
<h3 id="extra-filter-with-correlation-coefficient-cutoff-1">Extra filter with correlation coefficient cutoff<a class="anchor" aria-label="anchor" href="#extra-filter-with-correlation-coefficient-cutoff-1"></a>
</h3>
<p>Structure/Reaction directed analysis could also use correlation to
restrict the paired ions. However, similar to GlobalStd algorithm, such
cutoff will remove low intensity data. Researcher should have a clear
idea to use this cutoff.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sda2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getsda.html">getsda</a></span><span class="op">(</span><span class="va">std</span>, corcutoff <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span>
<span><span class="co">#&gt; PMD frequency cutoff is 6 by PMD network analysis with largest network average distance 6.67 .</span></span>
<span><span class="co">#&gt; 41 groups were found as high frequency PMD group.</span></span>
<span><span class="co">#&gt; 0 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 1.98 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 2.01 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 2.02 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 11.96 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 12 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 13.98 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 14.02 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 14.05 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 15.99 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 16.03 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 19.04 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 28.03 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 30.05 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 31.99 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 33.02 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 42.05 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 48.98 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 49.02 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 54.05 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 56.06 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 58.04 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 58.08 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 63.96 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 66.05 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 68.06 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 70.08 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 74.02 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 80.03 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 82.08 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 88.05 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 93.12 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 94.1 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 96.09 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 108.13 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 110.11 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 112.16 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 116.08 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 122.15 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 124.16 was found as high frequency PMD. </span></span>
<span><span class="co">#&gt; 126.14 was found as high frequency PMD.</span></span>
<span><span class="fu"><a href="../reference/plotstdsda.html">plotstdsda</a></span><span class="op">(</span><span class="va">sda2</span><span class="op">)</span></span></code></pre></div>
<p><img src="globalstd_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="structurereaction-directed-analysis-for-peakscompounds-only-data">Structure/reaction directed analysis for peaks/compounds only
data<a class="anchor" aria-label="anchor" href="#structurereaction-directed-analysis-for-peakscompounds-only-data"></a>
</h3>
<p>When you only have data of peaks without retention time or compounds
list, structure/reaction directed analysis could also be done by
<code>getrda</code> function.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sda</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getrda.html">getrda</a></span><span class="op">(</span><span class="va">spmeinvivo</span><span class="op">$</span><span class="va">mz</span><span class="op">)</span></span>
<span><span class="co">#&gt; 164462 pmd found.</span></span>
<span><span class="co">#&gt; 20 pmd used.</span></span>
<span><span class="co"># check high frequency pmd</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">sda</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "0"       "1.001"   "1.002"   "1.003"   "1.004"   "2.015"   "2.016"  </span></span>
<span><span class="co">#&gt;  [8] "14.015"  "17.026"  "18.011"  "21.982"  "28.031"  "28.032"  "44.026" </span></span>
<span><span class="co">#&gt; [15] "67.987"  "67.988"  "88.052"  "116.192" "135.974" "135.975"</span></span>
<span><span class="co"># get certain pmd related m/z</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="va">sda</span><span class="op">[</span>,<span class="st">'2.016'</span><span class="op">]</span></span>
<span><span class="co"># show the m/z</span></span>
<span><span class="va">spmeinvivo</span><span class="op">$</span><span class="va">mz</span><span class="op">[</span><span class="va">idx</span><span class="op">]</span></span>
<span><span class="co">#&gt;  [1] 118.0651 118.0652 120.0812 159.1575 162.0552 170.0330 170.0932 170.1541</span></span>
<span><span class="co">#&gt;  [9] 174.1363 174.9917 175.0873 176.0305 176.0418 181.9872 184.1695 188.6484</span></span>
<span><span class="co">#&gt; [17] 192.1487 192.1604 226.9522 226.9523 228.1969 228.1973 259.1148 261.1317</span></span>
<span><span class="co">#&gt; [25] 270.3185 271.3217 272.3230 272.3234 273.8902 274.8744 284.2955 285.3002</span></span>
<span><span class="co">#&gt; [33] 285.3002 286.3101 286.3101 291.0712 293.1755 294.9392 296.2961 304.3081</span></span>
<span><span class="co">#&gt; [41] 305.2480 305.3118 308.0889 308.2953 308.2954 309.1672 309.2046 315.1781</span></span>
<span><span class="co">#&gt; [49] 317.9344 319.3005 319.3002 319.9302 320.3041 320.3322 321.3165 322.3185</span></span>
<span><span class="co">#&gt; [57] 323.3221 324.3266 325.3294 327.2022 327.3449 329.0052 331.0031 350.3426</span></span>
<span><span class="co">#&gt; [65] 352.3214 352.3215 353.3244 354.3365 355.0696 359.2410 361.2353 372.3197</span></span>
<span><span class="co">#&gt; [73] 375.3066 383.2804 383.3723 384.3350 385.2753 385.3480 387.2851 397.1907</span></span>
<span><span class="co">#&gt; [81] 399.3274 400.9174 401.3420 403.2859 432.8860 433.2781 445.8289 447.1173</span></span>
<span><span class="co">#&gt; [89] 451.3633 462.8615 522.3557 524.1178 525.9831 526.4841 705.7223 708.8218</span></span>
<span><span class="co">#&gt; [97] 976.3139 976.8122 982.7763</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="wrap-function-for-globalstd-algorithm">Wrap function for GlobalStd algorithm<a class="anchor" aria-label="anchor" href="#wrap-function-for-globalstd-algorithm"></a>
</h2>
<p><code>globalstd</code> function is a wrap function to process
GlobalStd algorithm and structure/reaction directed analysis in one
line. All the plot function could be directly used on the
<code>list</code> objects from <code>globalstd</code> function. If you
want to perform structure/reaction directed analysis, set the
<code>sda=T</code> in the <code>globalstd</code> function.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/globalstd.html">globalstd</a></span><span class="op">(</span><span class="va">spmeinvivo</span>, sda<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; 75 retention time cluster found.</span></span>
<span><span class="co">#&gt; 369 paired masses found</span></span>
<span><span class="co">#&gt; 5 unique within RT clusters high frequency PMD(s) used for further investigation.</span></span>
<span><span class="co">#&gt; The unique within RT clusters high frequency PMD(s) is(are)  28.03 21.98 44.03 17.03 18.01.</span></span>
<span><span class="co">#&gt; 719 isotopologue(s) related paired mass found.</span></span>
<span><span class="co">#&gt; 492 multi-charger(s) related paired mass found.</span></span>
<span><span class="co">#&gt; 8 retention group(s) have single peaks. 14 23 32 33 54 55 56 75</span></span>
<span><span class="co">#&gt; 11 group(s) with multiple peaks while no isotope/paired relationship 4 5 7 8 11 41 42 49 68 72 73</span></span>
<span><span class="co">#&gt; 9 group(s) with multiple peaks with isotope without paired relationship 2 9 22 26 52 62 64 66 70</span></span>
<span><span class="co">#&gt; 4 group(s) with paired relationship without isotope 1 10 15 18</span></span>
<span><span class="co">#&gt; 43 group(s) with paired relationship and isotope 3 6 12 13 16 17 19 20 21 24 25 27 28 29 30 31 34 35 36 37 38 39 40 43 44 45 46 47 48 50 51 53 57 58 59 60 61 63 65 67 69 71 74</span></span>
<span><span class="co">#&gt; 291 std mass found.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="use-independent-peaks-for-msms-validation-pmdda">Use independent peaks for MS/MS validation (PMDDA)<a class="anchor" aria-label="anchor" href="#use-independent-peaks-for-msms-validation-pmdda"></a>
</h2>
<p>Independent peaks are supposing generated from different compounds.
We could use those peaks for MS/MS analysis instead of DIA or DDA. Here
we need multiple injections for one sample since it might be impossible
to get all ions’ fragment ions in one injection with good sensitivity.
You could use <code>gettarget</code> to generate the index for the
injections and output the peaks for each run.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># you need retention time for independent peaks</span></span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gettarget.html">gettarget</a></span><span class="op">(</span><span class="va">std</span><span class="op">$</span><span class="va">rt</span><span class="op">[</span><span class="va">std</span><span class="op">$</span><span class="va">stdmassindex</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; You need 10 injections!</span></span>
<span><span class="co"># output the ions for each injection</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">index</span><span class="op">)</span></span>
<span><span class="co">#&gt; index</span></span>
<span><span class="co">#&gt;  1  2  3  4  5  6  7  8  9 10 </span></span>
<span><span class="co">#&gt; 25 28 40 18 28 29 34 45 28 16</span></span>
<span><span class="co"># show the ions for the first injection</span></span>
<span><span class="va">std</span><span class="op">$</span><span class="va">mz</span><span class="op">[</span><span class="va">index</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="co">#&gt;   [1] 110.0717 114.0918 122.9247 125.9874 133.0794 137.9879 141.9594 149.9530</span></span>
<span><span class="co">#&gt;   [9] 165.0787 166.0867 172.1705 174.9383 175.1482 183.0809 193.1599 198.1854</span></span>
<span><span class="co">#&gt;  [17] 203.0532 205.0872 205.1954 220.1184 226.1823 242.2863 242.9260 255.2511</span></span>
<span><span class="co">#&gt;  [25] 259.9651 264.1944 267.0639 270.3185 270.3172 270.3185 270.3184 271.3216</span></span>
<span><span class="co">#&gt;  [33] 273.8902 285.3002 286.3101 294.2054 296.9066 300.2046 306.2514 310.3117</span></span>
<span><span class="co">#&gt;  [41] 315.1781 317.9344 319.3005 319.9302 329.8840 334.3101 349.3476 351.3455</span></span>
<span><span class="co">#&gt;  [49] 363.3114 367.2694 371.3345 374.3041 380.0033 382.3673 383.2804 386.3523</span></span>
<span><span class="co">#&gt;  [57] 391.2835 394.8754 410.2585 411.0941 417.2462 420.3193 424.0815 430.0895</span></span>
<span><span class="co">#&gt;  [65] 437.2355 445.2767 445.3874 446.8878 447.2935 467.1031 471.3317 505.1055</span></span>
<span><span class="co">#&gt;  [73] 507.3303 527.2976 536.1655 540.8890 542.3991 548.2764 551.3562 556.8633</span></span>
<span><span class="co">#&gt;  [81] 560.3877 564.1885 567.1783 586.4524 589.5800 600.4401 605.2231 608.4285</span></span>
<span><span class="co">#&gt;  [89] 620.4358 636.1983 643.4632 646.4585 649.6613 650.8519 669.4185 675.5084</span></span>
<span><span class="co">#&gt;  [97] 703.3651 704.1390 720.8364 732.5472 739.6479 750.6089 758.4735 760.8210</span></span>
<span><span class="co">#&gt; [105] 764.8339 771.8544 773.6523 779.5153 803.5434 804.8442 816.5102 826.6806</span></span>
<span><span class="co">#&gt; [113] 832.8212 840.8392 861.5014 870.7857 872.3052 872.8314 873.3343 889.8086</span></span>
<span><span class="co">#&gt; [121] 900.3092 942.7638 946.7164 979.7901 991.7894</span></span>
<span><span class="va">std</span><span class="op">$</span><span class="va">rt</span><span class="op">[</span><span class="va">index</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="co">#&gt;   [1]  228.0840  172.8550  217.9690 1079.6500  212.6560  165.4680 1079.4300</span></span>
<span><span class="co">#&gt;   [8] 1079.6400  511.3690  348.1340  478.9360  216.1500  453.1780  533.7950</span></span>
<span><span class="co">#&gt;  [15]  453.1780  415.9985  144.8840  583.5530  639.1010  170.8240  611.4120</span></span>
<span><span class="co">#&gt;  [22]  780.5760  216.0600  639.1000  145.9660  473.1445  568.7680  538.0815</span></span>
<span><span class="co">#&gt;  [29]    4.0610  604.7690  465.0070  781.0040  145.9680  716.7800  631.8770</span></span>
<span><span class="co">#&gt;  [36]  452.0005  145.1090  172.2230  599.6270  618.4820  401.2135  145.5170</span></span>
<span><span class="co">#&gt;  [43]  622.7690  145.2280  144.3380  608.1990  659.2440  626.0920  561.2685</span></span>
<span><span class="co">#&gt;  [50]  382.6770  551.7325  582.4840  212.9175  616.5550  547.0180  644.4580</span></span>
<span><span class="co">#&gt;  [57]  665.0280  217.1550  633.9130  563.1970  444.6075  687.8085  583.9830</span></span>
<span><span class="co">#&gt;  [64]  717.1010  170.9435  421.8915  582.4825  215.6320  404.5340  717.1030</span></span>
<span><span class="co">#&gt;  [71]  540.8660  762.4675  554.8390  493.5080  762.5770  213.7260  439.6780</span></span>
<span><span class="co">#&gt;  [78]  493.5080  551.4100  215.9830  533.3660  762.5770  762.3630  439.2500</span></span>
<span><span class="co">#&gt;  [85]  889.0520  455.1500  762.5750  613.3395  531.0080  818.9800  449.3200</span></span>
<span><span class="co">#&gt;  [92]  605.8410  637.2775  215.6410  527.7950  468.2215  213.5480  639.1000</span></span>
<span><span class="co">#&gt;  [99]  215.1360  481.0785  639.1005  624.2710  522.4370  215.6320  213.7270</span></span>
<span><span class="co">#&gt; [106]  213.7720  613.5550  519.6690  665.0290  213.5090  213.3340  628.4480</span></span>
<span><span class="co">#&gt; [113]  213.7130  213.9270  213.3395  216.5120  639.0990  213.5090  213.5480</span></span>
<span><span class="co">#&gt; [120]  215.2605  213.5480  636.9060  637.1710  213.9410  215.3500</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="shiny-application">Shiny application<a class="anchor" aria-label="anchor" href="#shiny-application"></a>
</h2>
<p>An interactive document has been included in this package to perform
PMD analysis. You need to prepare a csv file with m/z and retention time
of peaks. Such csv file could be generated by run
<code><a href="https://rdrr.io/pkg/enviGCMS/man/getcsv.html" class="external-link">enviGCMS::getcsv()</a></code> on the <code>list</code> object from
<code>enviGCMS::getmzrt(xset)</code> function. The <code>xset</code>
should be <code>XCMSnExp</code> object or <code>xcmsSet</code> object.
You could also generate the csv file by
<code>enviGCMS::getmzrt(xset,name = 'test')</code>. You will find the
csv file in the working dictionary named <code>test.csv</code>.</p>
<p>Then you could run <code><a href="../reference/runPMD.html">runPMD()</a></code> to start the Graphical user
interface(GUI) for GlobalStd algorithm and structure/reaction directed
analysis.</p>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p><code>pmd</code> package could be used to reduce the redundancy peaks
for GC/LC-MS based research and perform structure/reaction directed
analysis to screen known and unknown important compounds or
reactions.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Miao YU.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
