<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis • pmd</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-58201304-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-58201304-1');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pmd</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/globalstd.html">Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis</h1>
                        <h4 class="author">Miao Yu</h4>
            
            <h4 class="date">2019-05-24</h4>
      
      
      <div class="hidden name"><code>globalstd.Rmd</code></div>

    </div>

    
    
<div id="introduction-of-paired-mass-distance-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction-of-paired-mass-distance-analysis" class="anchor"></a>Introduction of Paired Mass Distance analysis</h2>
<p><code>pmd</code> package use Paired Mass Distance (PMD) relationship to analysis the GC/LC-MS based non-targeted data. PMD means the distance between two masses or mass to charge ratios. In mass spectrometry, PMD would keep the same between two masses or two mass to charge ratios(m/z). There are twe kinds of PMD involved in this package: PMD within same retention time group and PMD from different retention time groups.</p>
<div id="pmd-within-same-retention-time-group" class="section level3">
<h3 class="hasAnchor">
<a href="#pmd-within-same-retention-time-group" class="anchor"></a>PMD within same retention time group</h3>
<p>In GC/LC-MS based non-targeted analysis, peaks could be seperated by chromatograph. We could build retention time(RT) bins to assign peaks into different RT groups by retention time hierarchical clustering analysis. For each RT group, the peaks should come from same compounds or co-elutes. If certain PMD appeared in multiple RT groups, it would be related to the relationship about adducts, neutral loss, isotopologues or commen fragments ions.</p>
</div>
<div id="pmd-from-different-retention-time-groups" class="section level3">
<h3 class="hasAnchor">
<a href="#pmd-from-different-retention-time-groups" class="anchor"></a>PMD from different retention time groups</h3>
<p>The peaks from different retention time groups would like to be different compounds seperated by chromatograph. The PMD would reflect the relationship about homologous series or chemical reactions.</p>
<p>GlobalStd algorithm use the PMD within same RT group to find independent peaks among certain dataset. Structure/reaction directed analysis use PMD from different RT groups to screen important compounds or reactions.</p>
</div>
</div>
<div id="data-format" class="section level2">
<h2 class="hasAnchor">
<a href="#data-format" class="anchor"></a>Data format</h2>
<p>The input data should be a <code>list</code> object with at least two elements from a peaks list:</p>
<ul>
<li>mass to charge ratio with name of <code>mz</code>, high resolution mass spectrometry is required</li>
<li>retention time with name of <code>rt</code>
</li>
</ul>
<p>However, I suggested to add intensity and group information to the list for validation of PMD analysis.</p>
<p>In this package, a dataset from <em>in vivo</em> solid phase micro-extraction(SPME) was attached. This dataset contain 9 samples from 3 fish with triplicates samples for each fish. Here is the data strcture:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(pmd)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"spmeinvivo"</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(spmeinvivo)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt; List of 4</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#&gt;  $ data : num [1:1459, 1:9] 1095 10439 10154 2797 90211 ...</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt;   .. ..$ : chr [1:1459] "100.1/170" "100.5/86" "101/85" "103.1/348" ...</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt;   .. ..$ : chr [1:9] "1405_Fish1_F1" "1405_Fish1_F2" "1405_Fish1_F3" "1405_Fish2_F1" ...</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt;  $ group:'data.frame':   9 obs. of  1 variable:</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt;   ..$ class: Factor w/ 3 levels "fish1","fish2",..: 1 1 1 2 2 2 3 3 3</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">#&gt;  $ mz   : num [1:1459] 100 101 101 103 104 ...</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co">#&gt;  $ rt   : num [1:1459] 170.2 86.3 84.9 348.1 48.8 ...</span></a></code></pre></div>
<p>You could build this <code>list</code> object from the <code>xcms</code> objects via <code>enviGCMS</code> package. When you have a <code>xcmsSet</code> object or <code>XCMSnExp</code> object named <code>xset</code>, you could use <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt">enviGCMS::getmzrt(xset)</a></code> or <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt2">enviGCMS::getmzrt2(xset)</a></code> to get such list. Of course you could build such list by yourself.</p>
</div>
<div id="globalstd-algorithm" class="section level2">
<h2 class="hasAnchor">
<a href="#globalstd-algorithm" class="anchor"></a>GlobalStd algorithm</h2>
<p>GlobalStd algorithm try to find independent peaks among certain peaks list. The first step is retention time hierarchical clustering analysis. The second step is to find the relationship among adducts, neutral loss, isotopologues and commen fragments ions. The third step is to screen the independent peaks.</p>
<div id="retention-time-hierarchical-clustering" class="section level3">
<h3 class="hasAnchor">
<a href="#retention-time-hierarchical-clustering" class="anchor"></a>Retention time hierarchical clustering</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">pmd &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getpaired.html">getpaired</a></span>(spmeinvivo, <span class="dt">rtcutoff =</span> <span class="dv">10</span>, <span class="dt">ng =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt; 75 retention time cluster found.</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#&gt; 435 paired masses found</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt; 10 unique within RT clusters high frequency PMD(s) used for further investigation.</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt; 583 isotopologue(s) related paired mass found.</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; 685 multi-charger(s) related paired mass found.</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="kw"><a href="../reference/plotrtg.html">plotrtg</a></span>(pmd)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/rtg-1.png" width="700"></p>
<p>This plot would show the distribution of RT groups. The <code>rtcutoff</code> in function <code>getpaired</code> could be used to set the cutoff of the distances in retention time hierarchical clustering analysis.</p>
</div>
<div id="relationship-among-adducts-neutral-loss-isotopologues-and-commen-fragments-ions" class="section level3">
<h3 class="hasAnchor">
<a href="#relationship-among-adducts-neutral-loss-isotopologues-and-commen-fragments-ions" class="anchor"></a>Relationship among adducts, neutral loss, isotopologues and commen fragments ions</h3>
<p>The <code>ng</code> in function <code>getpaired</code> could be used to set cutoff of global PMD’s retention time group numbers. If <code>ng</code> is 10, at least 10 of the retention time groups should contain the shown PMD relationship. You could use <code>plotpaired</code> to show the distribution.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="../reference/plotpaired.html">plotpaired</a></span>(pmd)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/pmd-1.png" width="700"></p>
<p>You could also show the distribution of PMD relationship by index:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># show the unique PMD found by getpaired function</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(pmd<span class="op">$</span>paired<span class="op">$</span>diff2))){</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">        diff &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(pmd<span class="op">$</span>paired<span class="op">$</span>diff2)[i]</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">        index &lt;-<span class="st"> </span>pmd<span class="op">$</span>paired<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span>diff</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">        <span class="kw"><a href="../reference/plotpaired.html">plotpaired</a></span>(pmd,index)</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">}</a></code></pre></div>
<p><img src="globalstd_files/figure-html/pmdindex-1.png" width="700"><img src="globalstd_files/figure-html/pmdindex-2.png" width="700"><img src="globalstd_files/figure-html/pmdindex-3.png" width="700"><img src="globalstd_files/figure-html/pmdindex-4.png" width="700"><img src="globalstd_files/figure-html/pmdindex-5.png" width="700"><img src="globalstd_files/figure-html/pmdindex-6.png" width="700"><img src="globalstd_files/figure-html/pmdindex-7.png" width="700"><img src="globalstd_files/figure-html/pmdindex-8.png" width="700"><img src="globalstd_files/figure-html/pmdindex-9.png" width="700"><img src="globalstd_files/figure-html/pmdindex-10.png" width="700"></p>
</div>
<div id="screen-the-independent-peaks" class="section level3">
<h3 class="hasAnchor">
<a href="#screen-the-independent-peaks" class="anchor"></a>Screen the independent peaks</h3>
<p>You could use <code>getstd</code> function to get the independent peaks.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">std &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getstd.html">getstd</a></span>(pmd)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt; 11 group(s) with multiple peaks while no isotope/paired relationship</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt; 8 group(s) with multiple peaks with isotope without paired relationship</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt; 4 group(s) with paired relationship without isotope</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; 44 group(s) with paired relationship and isotope</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; 257 std mass found.</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt; 8 retention group(s) have single peaks.</span></a></code></pre></div>
<p>Here you could plot the peaks by <code>plotstd</code> function to show the distribution of independent peaks:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="../reference/plotstd.html">plotstd</a></span>(std)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/stdplot-1.png" width="700"></p>
<p>You could also plot the peaks distribution by assign a retention time group via <code>plotstdrt</code>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">23</span>,<span class="dt">main =</span> <span class="st">'Retention time group 23'</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">9</span>,<span class="dt">main =</span> <span class="st">'Retention time group 9'</span>)</a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">18</span>,<span class="dt">main =</span> <span class="st">'Retention time group 18'</span>)</a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">67</span>,<span class="dt">main =</span> <span class="st">'Retention time group 67'</span>)</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">49</span>,<span class="dt">main =</span> <span class="st">'Retention time group 49'</span>)</a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">6</span>,<span class="dt">main =</span> <span class="st">'Retention time group 6'</span>)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/stdrtplot-1.png" width="700"></p>
</div>
<div id="use-independent-peaks-for-msms-validation" class="section level3">
<h3 class="hasAnchor">
<a href="#use-independent-peaks-for-msms-validation" class="anchor"></a>Use independent peaks for MS/MS validation</h3>
<p>Independent peaks are supporsing generated from different compounds. We could use those peaks for MS/MS analysis instead of DIA or DDA. Here we need multiple injections for one sample since it might be impossible to get all ions’ fragmental ions in one injection with good sensitivity. You could use <code>gettarget</code> to generate the index for the injections and output the peaks for each run.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># you need retention time for independent peaks</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">index &lt;-<span class="st"> </span><span class="kw"><a href="../reference/gettarget.html">gettarget</a></span>(std<span class="op">$</span>rt[std<span class="op">$</span>stdmassindex])</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&gt; You need 6 injections!</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co"># output the ions for each injection</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/table">table</a></span>(index)</a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt; index</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt;  1  2  3  4  5  6 </span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt; 33 24 44 44 52 60</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co"># show the ions for the first injection</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10">std<span class="op">$</span>mz[index<span class="op">==</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt;   [1] 110.0717 118.0651 118.0873 121.0287 131.0854 156.0776 158.9638</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt;   [8] 158.9617 163.1487 165.0787 167.0709 171.0960 190.0124 191.1801</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#&gt;  [15] 193.1599 193.1632 197.9893 205.1276 206.0898 208.0978 209.9808</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#&gt;  [22] 210.1577 212.2026 217.1483 219.0540 221.0851 227.1755 236.1626</span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">#&gt;  [29] 236.9406 237.2228 242.2863 244.1921 244.1920 251.1815 254.2500</span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="co">#&gt;  [36] 255.2511 256.2645 259.1148 270.3185 271.3217 271.3216 273.1685</span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="co">#&gt;  [43] 273.8902 277.1815 281.0520 294.2054 294.9392 299.1113 299.9249</span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="co">#&gt;  [50] 303.6476 307.3001 308.0889 308.0887 309.2046 309.2279 310.9132</span></a>
<a class="sourceLine" id="cb8-19" data-line-number="19"><span class="co">#&gt;  [57] 312.0163 313.1439 315.1957 320.3040 328.8778 329.0928 329.2492</span></a>
<a class="sourceLine" id="cb8-20" data-line-number="20"><span class="co">#&gt;  [64] 335.1258 338.3435 338.6338 341.2662 345.9293 349.0556 349.2230</span></a>
<a class="sourceLine" id="cb8-21" data-line-number="21"><span class="co">#&gt;  [71] 352.3215 368.3904 371.3577 372.2591 378.9015 380.0033 383.2052</span></a>
<a class="sourceLine" id="cb8-22" data-line-number="22"><span class="co">#&gt;  [78] 385.3480 402.3458 403.3582 406.2651 406.2928 411.0941 416.2862</span></a>
<a class="sourceLine" id="cb8-23" data-line-number="23"><span class="co">#&gt;  [85] 416.8073 417.0350 419.3165 419.3519 422.2366 426.2189 427.1184</span></a>
<a class="sourceLine" id="cb8-24" data-line-number="24"><span class="co">#&gt;  [92] 429.3733 431.1792 441.3330 442.3373 442.8446 446.1216 452.2768</span></a>
<a class="sourceLine" id="cb8-25" data-line-number="25"><span class="co">#&gt;  [99] 453.3436 467.1031 473.3445 478.8354 481.3120 491.3195 517.8314</span></a>
<a class="sourceLine" id="cb8-26" data-line-number="26"><span class="co">#&gt; [106] 521.1371 521.3439 530.8496 532.8946 536.1655 539.4158 560.2188</span></a>
<a class="sourceLine" id="cb8-27" data-line-number="27"><span class="co">#&gt; [113] 560.8717 564.3304 564.3811 567.5729 575.4280 576.8454 577.1267</span></a>
<a class="sourceLine" id="cb8-28" data-line-number="28"><span class="co">#&gt; [120] 580.1907 580.2907 582.1904 585.4215 587.8828 593.1578 599.4366</span></a>
<a class="sourceLine" id="cb8-29" data-line-number="29"><span class="co">#&gt; [127] 612.1849 613.2451 614.1816 620.6167 635.3784 635.8787 642.1942</span></a>
<a class="sourceLine" id="cb8-30" data-line-number="30"><span class="co">#&gt; [134] 649.6613 651.8520 654.2092 659.4835 690.6403 695.1516 695.5039</span></a>
<a class="sourceLine" id="cb8-31" data-line-number="31"><span class="co">#&gt; [141] 703.2147 703.6382 705.7223 709.5932 738.5072 740.8400 751.6125</span></a>
<a class="sourceLine" id="cb8-32" data-line-number="32"><span class="co">#&gt; [148] 752.5158 760.2210 767.8423 770.8499 771.3530 772.8540 773.3274</span></a>
<a class="sourceLine" id="cb8-33" data-line-number="33"><span class="co">#&gt; [155] 775.6016 779.3404 780.8078 786.8255 790.5883 802.7995 804.5530</span></a>
<a class="sourceLine" id="cb8-34" data-line-number="34"><span class="co">#&gt; [162] 804.8442 812.8331 828.8075 830.6313 838.8393 841.8196 846.8256</span></a>
<a class="sourceLine" id="cb8-35" data-line-number="35"><span class="co">#&gt; [169] 848.6295 858.6636 886.7613 893.8251 894.3269 907.4933 908.8258</span></a>
<a class="sourceLine" id="cb8-36" data-line-number="36"><span class="co">#&gt; [176] 915.8125 924.7999 968.2956 970.7962 976.3139 976.8122 984.7703</span></a>
<a class="sourceLine" id="cb8-37" data-line-number="37"><span class="co">#&gt; [183] 998.7737</span></a>
<a class="sourceLine" id="cb8-38" data-line-number="38">std<span class="op">$</span>rt[index<span class="op">==</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb8-39" data-line-number="39"><span class="co">#&gt;   [1] 228.0840 511.2940 165.6830 583.7690 611.4120 227.6550 213.7130</span></a>
<a class="sourceLine" id="cb8-40" data-line-number="40"><span class="co">#&gt;   [8] 166.6990 612.9110 511.3690 538.2950 226.2130 218.5220 638.8870</span></a>
<a class="sourceLine" id="cb8-41" data-line-number="41"><span class="co">#&gt;  [15] 453.1780 337.6330 145.5380 370.7850 583.3410 430.4650  48.4200</span></a>
<a class="sourceLine" id="cb8-42" data-line-number="42"><span class="co">#&gt;  [22] 611.4130 594.4850 638.8870 169.5380 565.7700 170.0505 430.6770</span></a>
<a class="sourceLine" id="cb8-43" data-line-number="43"><span class="co">#&gt;  [29] 147.8960 639.1010 631.5560 614.8420 415.6790 452.9630 639.1000</span></a>
<a class="sourceLine" id="cb8-44" data-line-number="44"><span class="co">#&gt;  [36] 639.1000 588.0530 144.0380 823.9060 669.4930 715.1720 336.5620</span></a>
<a class="sourceLine" id="cb8-45" data-line-number="45"><span class="co">#&gt;  [43] 145.9680 588.6960 617.4140 452.0005 213.7720 447.6060 146.2780</span></a>
<a class="sourceLine" id="cb8-46" data-line-number="46"><span class="co">#&gt;  [50] 510.2230 582.8050 568.9830 549.6960 600.9120 360.5630 215.9350</span></a>
<a class="sourceLine" id="cb8-47" data-line-number="47"><span class="co">#&gt;  [57] 212.8675 581.3045 522.6500 622.7700 144.2610 212.3870 596.4120</span></a>
<a class="sourceLine" id="cb8-48" data-line-number="48"><span class="co">#&gt;  [64] 581.4100 639.1010 639.1000 564.2670 145.7520 136.3250 533.4745</span></a>
<a class="sourceLine" id="cb8-49" data-line-number="49"><span class="co">#&gt;  [71] 551.4120 682.3870 688.6010 169.8615 215.8460 212.9175 574.3400</span></a>
<a class="sourceLine" id="cb8-50" data-line-number="50"><span class="co">#&gt;  [78] 585.4825 633.0545 645.9050 547.4460 610.9840 563.1970 169.8320</span></a>
<a class="sourceLine" id="cb8-51" data-line-number="51"><span class="co">#&gt;  [85] 503.1515 762.6820 687.9570 656.0290 551.4100 601.1275 519.0090</span></a>
<a class="sourceLine" id="cb8-52" data-line-number="52"><span class="co">#&gt;  [92] 704.6740 683.9940 656.0280 404.5340 643.3840 717.1020 482.3650</span></a>
<a class="sourceLine" id="cb8-53" data-line-number="53"><span class="co">#&gt;  [99] 170.5045 717.1030 553.4470 218.1010 513.5445 401.9620 144.7890</span></a>
<a class="sourceLine" id="cb8-54" data-line-number="54"><span class="co">#&gt; [106] 762.5770 515.0340 217.0145 213.5300 762.5770 547.1250 170.0260</span></a>
<a class="sourceLine" id="cb8-55" data-line-number="55"><span class="co">#&gt; [113] 213.7270 531.3305 439.4630 735.7900 213.0735 215.1975 819.6200</span></a>
<a class="sourceLine" id="cb8-56" data-line-number="56"><span class="co">#&gt; [120] 762.3610 508.5080 762.4675 434.7490 213.5090 819.4060 454.9350</span></a>
<a class="sourceLine" id="cb8-57" data-line-number="57"><span class="co">#&gt; [127] 818.7650 349.6330 818.8705 618.4850 213.5480 213.7720 818.7645</span></a>
<a class="sourceLine" id="cb8-58" data-line-number="58"><span class="co">#&gt; [134] 637.2775 215.7110 819.4060 468.0100 594.0550 639.3130 698.3510</span></a>
<a class="sourceLine" id="cb8-59" data-line-number="59"><span class="co">#&gt; [141] 663.7645 638.8855 658.8150 619.9850 752.9310 213.7855 624.2705</span></a>
<a class="sourceLine" id="cb8-60" data-line-number="60"><span class="co">#&gt; [148] 522.4370 700.3870 213.3840 213.7720 213.7130 213.8565 370.5620</span></a>
<a class="sourceLine" id="cb8-61" data-line-number="61"><span class="co">#&gt; [155] 639.3140 214.9615 214.7290 215.4870 492.8650 216.6375 631.5555</span></a>
<a class="sourceLine" id="cb8-62" data-line-number="62"><span class="co">#&gt; [162] 213.5090 214.4150 215.6670 628.4490 213.7270 213.8945 214.4150</span></a>
<a class="sourceLine" id="cb8-63" data-line-number="63"><span class="co">#&gt; [169] 503.2585 646.7630 217.3700 213.5020 213.4215 213.0430 213.6560</span></a>
<a class="sourceLine" id="cb8-64" data-line-number="64"><span class="co">#&gt; [176] 214.6300 214.9990 213.5120 213.9110 213.8580 213.8565 215.0690</span></a>
<a class="sourceLine" id="cb8-65" data-line-number="65"><span class="co">#&gt; [183] 215.6570</span></a></code></pre></div>
</div>
<div id="validation-by-principal-components-analysispca" class="section level3">
<h3 class="hasAnchor">
<a href="#validation-by-principal-components-analysispca" class="anchor"></a>Validation by principal components analysis(PCA)</h3>
<p>You need to check the GlobalStd algorithm’s results by principal components analysis(PCA).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(enviGCMS)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data,<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(std<span class="op">$</span>group<span class="op">$</span>class),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(all peaks)"</span>)))</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data[std<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(std<span class="op">$</span>group<span class="op">$</span>class),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))</a></code></pre></div>
<p><img src="globalstd_files/figure-html/pca-1.png" width="700"></p>
</div>
<div id="comparision-with-other-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#comparision-with-other-packages" class="anchor"></a>Comparision with other packages</h3>
<p>GlobalStd algorithm in <code>pmd</code> package could be treated as a way to extract pseudospectra. You could use <code>getcluster</code> to get peaks groups information for all GlobalStd peaks. Then you could choose export peaks with the highest intensities in each GlobalStd peaks groups.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">stdcluster &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getcluster.html">getcluster</a></span>(std)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co"># extract pseudospectra for std peak 1</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(stdcluster<span class="op">$</span>cluster<span class="op">$</span>stdmassg[stdcluster<span class="op">$</span>cluster<span class="op">$</span>i<span class="op">==</span><span class="dv">42</span>],stdcluster<span class="op">$</span>cluster<span class="op">$</span>ins[stdcluster<span class="op">$</span>cluster<span class="op">$</span>i<span class="op">==</span><span class="dv">42</span>],<span class="dt">type =</span> <span class="st">'h'</span>,<span class="dt">xlab =</span> <span class="st">'m/z'</span>,<span class="dt">ylab =</span> <span class="st">'intensity'</span>,<span class="dt">main =</span> <span class="st">'pseudospectra for GlobalStd peak 42'</span>)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/comp-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># export peaks with the highest intensities in each GlobalStd peaks groups.</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">data &lt;-<span class="st"> </span>stdcluster<span class="op">$</span>data[stdcluster<span class="op">$</span>stdmassindex2,]</a></code></pre></div>
<p>You could also use <code>getcorcluster</code> to find peaks groups by correlation analysis only.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">corcluster &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getcorcluster.html">getcorcluster</a></span>(spmeinvivo)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co">#&gt; 75 retention time cluster found.</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data,<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(std<span class="op">$</span>group<span class="op">$</span>class),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(all peaks)"</span>)))</a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data[std<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(std<span class="op">$</span>group<span class="op">$</span>class),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))</a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data[corcluster<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(std<span class="op">$</span>group<span class="op">$</span>class),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks by correlationship)"</span>)))</a></code></pre></div>
<p><img src="globalstd_files/figure-html/corcomp-1.png" width="700"></p>
</div>
<div id="globalstd-algorithm-with-intensity-data" class="section level3">
<h3 class="hasAnchor">
<a href="#globalstd-algorithm-with-intensity-data" class="anchor"></a>GlobalStd algorithm with intensity data</h3>
<p>GlobalStd algorithm is designed to analysis data without intensity data. However, if you have intensity data, the independant peaks could be selected with more confindence. You could set up cutoff of Pearson Correlation Coefficient between peaks to refine the peaks selected by GlobalStd within same retention time groups.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">std2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getstd.html">getstd</a></span>(pmd,<span class="dt">corcutoff =</span> <span class="fl">0.9</span>)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="co">#&gt; 24 group(s) with multiple peaks while no isotope/paired relationship</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="co">#&gt; 12 group(s) with multiple peaks with isotope without paired relationship</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co">#&gt; 3 group(s) with paired relationship without isotope</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="co">#&gt; 28 group(s) with paired relationship and isotope</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co">#&gt; 116 std mass found.</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="co">#&gt; 8 retention group(s) have single peaks.</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std2<span class="op">$</span>data,<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(std2<span class="op">$</span>group<span class="op">$</span>class),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(all peaks)"</span>)))</a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data[std<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(std<span class="op">$</span>group<span class="op">$</span>class),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))</a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std2<span class="op">$</span>data[std2<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(std2<span class="op">$</span>group<span class="op">$</span>class),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))</a></code></pre></div>
<p><img src="globalstd_files/figure-html/globalcor-1.png" width="700"></p>
</div>
</div>
<div id="structurereaction-directed-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#structurereaction-directed-analysis" class="anchor"></a>Structure/reaction directed analysis</h2>
<p><code>getsda</code> function could be used to perform Structure/reaction directed analysis. <code>freqcutoff</code> could be used to filter the PMD with high frequncy.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">sda &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getsda.html">getsda</a></span>(std, <span class="dt">freqcutoff =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="co">#&gt; Top 50 high frequency PMD groups were remained.</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="co">#&gt; 18 groups were found as high frequency PMD group.</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="co">#&gt; 0 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="co">#&gt; 1.98 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">#&gt; 2.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="co">#&gt; 13.98 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="co">#&gt; 14.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="co">#&gt; 14.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="co">#&gt; 15.99 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"><span class="co">#&gt; 16.03 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12"><span class="co">#&gt; 28.03 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13"><span class="co">#&gt; 30.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="co">#&gt; 42.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-15" data-line-number="15"><span class="co">#&gt; 49.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-16" data-line-number="16"><span class="co">#&gt; 58.04 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-17" data-line-number="17"><span class="co">#&gt; 66.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-18" data-line-number="18"><span class="co">#&gt; 68.06 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-19" data-line-number="19"><span class="co">#&gt; 82.08 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-20" data-line-number="20"><span class="co">#&gt; 116.08 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-21" data-line-number="21"><span class="co">#&gt; 126.14 were found as high frequency PMD.</span></a></code></pre></div>
<p>You could use <code>plotstdsda</code> to show the distribution of the selected paired peaks.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/stdsda-1.png" width="700"></p>
<p>You could also use index to show the distribution of certain PMDs.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>,<span class="dv">3</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">13.98</span>)</a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">15.99</span>)</a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">14.02</span>)</a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">28.03</span>)</a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">58.04</span>)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/stdsdaidx-1.png" width="700"></p>
<p>Structure/reaction directed analysis could be directily performed on all the peaks, which is slow to process:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">sdaall &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getsda.html">getsda</a></span>(spmeinvivo)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>,<span class="dv">3</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">13.98</span>)</a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">15.99</span>)</a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">14.02</span>)</a>
<a class="sourceLine" id="cb17-7" data-line-number="7"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">28.03</span>)</a>
<a class="sourceLine" id="cb17-8" data-line-number="8"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">58.04</span>)</a></code></pre></div>
<div id="structurereaction-directed-analysis-for-peakscompounds-only" class="section level3">
<h3 class="hasAnchor">
<a href="#structurereaction-directed-analysis-for-peakscompounds-only" class="anchor"></a>Structure/reaction directed analysis for peaks/compounds only</h3>
<p>When you only have data of peaks without retention time or compounds list, structure/reaction directed analysis could also be done by <code>getrda</code> function.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">sda &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getrda.html">getrda</a></span>(spmeinvivo<span class="op">$</span>mz[std<span class="op">$</span>stdmassindex])</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="co">#&gt; 28374 pmd found.</span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="co">#&gt; 9 pmd used.</span></a></code></pre></div>
</div>
</div>
<div id="parameters-selection" class="section level2">
<h2 class="hasAnchor">
<a href="#parameters-selection" class="anchor"></a>Parameters selection</h2>
<p>Retention time cluster cutoff should fit the peak picking algorithm. For HPLC, 10 is suggested and 5 could be used for UPLC.</p>
<p>Global PMD’s retention time group numbers should be around 20 percent of the retention time cluster numbers. For example, if you find 100 retention time clusters, I suggested you use 20 as the empirical global PMD’s retention time group numbers.</p>
<p>As for the cutoff of the frequency of PMDs, you could change the frequency until you find certain PMD which you’re sure that it should appear in your dataset. For example, 16 should be considered as a good start. Any pmd with the frequency larger than PMD 16 could be further discussed.</p>
<p>Another important hint is that pre-filter your peak list by black samples or other quality control samples. Otherwise the running time would be long and lots of pmd relationship would be just from noise.</p>
</div>
<div id="wrap-function" class="section level2">
<h2 class="hasAnchor">
<a href="#wrap-function" class="anchor"></a>Wrap function</h2>
<p><code>globalstd</code> function is a wrap funtion to process GlobalStd algorithm and structure/reaction directed analysis in one line. All the plot function could be directly used on the <code>list</code> objects from <code>globalstd</code> function.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">result &lt;-<span class="st"> </span><span class="kw"><a href="../reference/globalstd.html">globalstd</a></span>(spmeinvivo)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="co">#&gt; 75 retention time cluster found.</span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="co">#&gt; 435 paired masses found</span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="co">#&gt; 10 unique within RT clusters high frequency PMD(s) used for further investigation.</span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="co">#&gt; 583 isotopologue(s) related paired mass found.</span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="co">#&gt; 685 multi-charger(s) related paired mass found.</span></a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="co">#&gt; 11 group(s) with multiple peaks while no isotope/paired relationship</span></a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="co">#&gt; 8 group(s) with multiple peaks with isotope without paired relationship</span></a>
<a class="sourceLine" id="cb19-9" data-line-number="9"><span class="co">#&gt; 4 group(s) with paired relationship without isotope</span></a>
<a class="sourceLine" id="cb19-10" data-line-number="10"><span class="co">#&gt; 44 group(s) with paired relationship and isotope</span></a>
<a class="sourceLine" id="cb19-11" data-line-number="11"><span class="co">#&gt; 257 std mass found.</span></a>
<a class="sourceLine" id="cb19-12" data-line-number="12"><span class="co">#&gt; 8 retention group(s) have single peaks.</span></a>
<a class="sourceLine" id="cb19-13" data-line-number="13"><span class="co">#&gt; Top 50 high frequency PMD groups were remained.</span></a>
<a class="sourceLine" id="cb19-14" data-line-number="14"><span class="co">#&gt; 18 groups were found as high frequency PMD group.</span></a>
<a class="sourceLine" id="cb19-15" data-line-number="15"><span class="co">#&gt; 0 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb19-16" data-line-number="16"><span class="co">#&gt; 1.98 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb19-17" data-line-number="17"><span class="co">#&gt; 2.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb19-18" data-line-number="18"><span class="co">#&gt; 13.98 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb19-19" data-line-number="19"><span class="co">#&gt; 14.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb19-20" data-line-number="20"><span class="co">#&gt; 14.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb19-21" data-line-number="21"><span class="co">#&gt; 15.99 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb19-22" data-line-number="22"><span class="co">#&gt; 16.03 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb19-23" data-line-number="23"><span class="co">#&gt; 28.03 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb19-24" data-line-number="24"><span class="co">#&gt; 30.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb19-25" data-line-number="25"><span class="co">#&gt; 42.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb19-26" data-line-number="26"><span class="co">#&gt; 49.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb19-27" data-line-number="27"><span class="co">#&gt; 58.04 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb19-28" data-line-number="28"><span class="co">#&gt; 66.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb19-29" data-line-number="29"><span class="co">#&gt; 68.06 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb19-30" data-line-number="30"><span class="co">#&gt; 82.08 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb19-31" data-line-number="31"><span class="co">#&gt; 116.08 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb19-32" data-line-number="32"><span class="co">#&gt; 126.14 were found as high frequency PMD.</span></a></code></pre></div>
</div>
<div id="shiny-application" class="section level2">
<h2 class="hasAnchor">
<a href="#shiny-application" class="anchor"></a>Shiny application</h2>
<p>An interactive document has been included in this package to show PMD analysis. You could run <code><a href="../reference/runPMD.html">runPMD()</a></code> to start the Graphical user interface(GUI) for GlobalStd algorithm and structure/reaction directed analysis. You need to prepare a csv file with m/z and retention time of peaks. Such csv file could be generated by run <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrtcsv">enviGCMS::getmzrtcsv()</a></code> on the <code>list</code> object from <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt">enviGCMS::getmzrt(xset)</a></code> or <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt2">enviGCMS::getmzrt2(xset)</a></code> function. You could also generate the csv file by <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt">enviGCMS::getmzrt(xset,name = 'test')</a></code> or <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt2">enviGCMS::getmzrt2(xset, name = 'test')</a></code>. You will find the csv file in the working dictionary named <code>test.csv</code>.</p>
</div>
<div id="conclusion" class="section level2">
<h2 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h2>
<p><code>pmd</code> package could be used to reduce the redundancy peaks for GC/LC-MS based research and perform structure/reaction directed analysis to screen known and unknown important compounds or reactions.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction-of-paired-mass-distance-analysis">Introduction of Paired Mass Distance analysis</a></li>
      <li><a href="#data-format">Data format</a></li>
      <li><a href="#globalstd-algorithm">GlobalStd algorithm</a></li>
      <li><a href="#structurereaction-directed-analysis">Structure/reaction directed analysis</a></li>
      <li><a href="#parameters-selection">Parameters selection</a></li>
      <li><a href="#wrap-function">Wrap function</a></li>
      <li><a href="#shiny-application">Shiny application</a></li>
      <li><a href="#conclusion">Conclusion</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Miao YU.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
