<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis • pmd</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-58201304-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-58201304-1');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pmd</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/globalstd.html">Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis</h1>
                        <h4 class="author">Miao Yu</h4>
            
            <h4 class="date">2019-07-26</h4>
      
      
      <div class="hidden name"><code>globalstd.Rmd</code></div>

    </div>

    
    
<div id="introduction-of-paired-mass-distance-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction-of-paired-mass-distance-analysis" class="anchor"></a>Introduction of Paired Mass Distance analysis</h2>
<p><code>pmd</code> package use Paired Mass Distance (PMD) relationship to analysis the GC/LC-MS based non-targeted data. PMD means the distance between two masses or mass to charge ratios. In mass spectrometry, PMD would keep the same between two masses or two mass to charge ratios(m/z). There are twe kinds of PMD involved in this package: PMD within same retention time group and PMD from different retention time groups.</p>
<div id="pmd-within-same-retention-time-group" class="section level3">
<h3 class="hasAnchor">
<a href="#pmd-within-same-retention-time-group" class="anchor"></a>PMD within same retention time group</h3>
<p>In GC/LC-MS based non-targeted analysis, peaks could be seperated by chromatograph. We could build retention time(RT) bins to assign peaks into different RT groups by retention time hierarchical clustering analysis. For each RT group, the peaks should come from same compounds or co-elutes. If certain PMD appeared in multiple RT groups, it would be related to the relationship about adducts, neutral loss, isotopologues or commen fragments ions.</p>
</div>
<div id="pmd-from-different-retention-time-groups" class="section level3">
<h3 class="hasAnchor">
<a href="#pmd-from-different-retention-time-groups" class="anchor"></a>PMD from different retention time groups</h3>
<p>The peaks from different retention time groups would like to be different compounds seperated by chromatograph. The PMD would reflect the relationship about homologous series or chemical reactions.</p>
<p>GlobalStd algorithm use the PMD within same RT group to find independent peaks among certain dataset. Structure/reaction directed analysis use PMD from different RT groups to screen important compounds or reactions.</p>
</div>
</div>
<div id="data-format" class="section level2">
<h2 class="hasAnchor">
<a href="#data-format" class="anchor"></a>Data format</h2>
<p>The input data should be a <code>list</code> object with at least two elements from a peaks list:</p>
<ul>
<li>mass to charge ratio with name of <code>mz</code>, high resolution mass spectrometry is required</li>
<li>retention time with name of <code>rt</code>
</li>
</ul>
<p>However, I suggested to add intensity and group information to the list for validation of PMD analysis.</p>
<p>In this package, a dataset from <em>in vivo</em> solid phase micro-extraction(SPME) was attached. This dataset contain 9 samples from 3 fish with triplicates samples for each fish. Here is the data strcture:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(pmd)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"spmeinvivo"</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(spmeinvivo)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt; List of 4</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#&gt;  $ data : num [1:1459, 1:9] 1095 10439 10154 2797 90211 ...</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt;   .. ..$ : chr [1:1459] "100.1/170" "100.5/86" "101/85" "103.1/348" ...</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt;   .. ..$ : chr [1:9] "1405_Fish1_F1" "1405_Fish1_F2" "1405_Fish1_F3" "1405_Fish2_F1" ...</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt;  $ group: chr [1:9] "fish1" "fish1" "fish1" "fish2" ...</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt;  $ mz   : num [1:1459] 100 101 101 103 104 ...</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">#&gt;  $ rt   : num [1:1459] 170.2 86.3 84.9 348.1 48.8 ...</span></a></code></pre></div>
<p>You could build this <code>list</code> object from the <code>xcms</code> objects via <code>enviGCMS</code> package. When you have a <code>xcmsSet</code> object or <code>XCMSnExp</code> object named <code>xset</code>, you could use <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt">enviGCMS::getmzrt(xset)</a></code> or <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt2">enviGCMS::getmzrt2(xset)</a></code> to get such list. Of course you could build such list by yourself.</p>
</div>
<div id="globalstd-algorithm" class="section level2">
<h2 class="hasAnchor">
<a href="#globalstd-algorithm" class="anchor"></a>GlobalStd algorithm</h2>
<p>GlobalStd algorithm try to find independent peaks among certain peaks list. The first step is retention time hierarchical clustering analysis. The second step is to find the relationship among adducts, neutral loss, isotopologues and commen fragments ions. The third step is to screen the independent peaks.</p>
<div id="retention-time-hierarchical-clustering" class="section level3">
<h3 class="hasAnchor">
<a href="#retention-time-hierarchical-clustering" class="anchor"></a>Retention time hierarchical clustering</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">pmd &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getpaired.html">getpaired</a></span>(spmeinvivo, <span class="dt">rtcutoff =</span> <span class="dv">10</span>, <span class="dt">ng =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt; 75 retention time cluster found.</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#&gt; 435 paired masses found</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt; 10 unique within RT clusters high frequency PMD(s) used for further investigation.</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt; 583 isotopologue(s) related paired mass found.</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; 685 multi-charger(s) related paired mass found.</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="kw"><a href="../reference/plotrtg.html">plotrtg</a></span>(pmd)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/rtg-1.png" width="700"></p>
<p>This plot would show the distribution of RT groups. The <code>rtcutoff</code> in function <code>getpaired</code> could be used to set the cutoff of the distances in retention time hierarchical clustering analysis.</p>
</div>
<div id="relationship-among-adducts-neutral-loss-isotopologues-and-commen-fragments-ions" class="section level3">
<h3 class="hasAnchor">
<a href="#relationship-among-adducts-neutral-loss-isotopologues-and-commen-fragments-ions" class="anchor"></a>Relationship among adducts, neutral loss, isotopologues and commen fragments ions</h3>
<p>The <code>ng</code> in function <code>getpaired</code> could be used to set cutoff of global PMD’s retention time group numbers. If <code>ng</code> is 10, at least 10 of the retention time groups should contain the shown PMD relationship. You could use <code>plotpaired</code> to show the distribution.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="../reference/plotpaired.html">plotpaired</a></span>(pmd)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/pmd-1.png" width="700"></p>
<p>You could also show the distribution of PMD relationship by index:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># show the unique PMD found by getpaired function</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(pmd<span class="op">$</span>paired<span class="op">$</span>diff2))){</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">        diff &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(pmd<span class="op">$</span>paired<span class="op">$</span>diff2)[i]</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">        index &lt;-<span class="st"> </span>pmd<span class="op">$</span>paired<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span>diff</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">        <span class="kw"><a href="../reference/plotpaired.html">plotpaired</a></span>(pmd,index)</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">}</a></code></pre></div>
<p><img src="globalstd_files/figure-html/pmdindex-1.png" width="700"><img src="globalstd_files/figure-html/pmdindex-2.png" width="700"><img src="globalstd_files/figure-html/pmdindex-3.png" width="700"><img src="globalstd_files/figure-html/pmdindex-4.png" width="700"><img src="globalstd_files/figure-html/pmdindex-5.png" width="700"><img src="globalstd_files/figure-html/pmdindex-6.png" width="700"><img src="globalstd_files/figure-html/pmdindex-7.png" width="700"><img src="globalstd_files/figure-html/pmdindex-8.png" width="700"><img src="globalstd_files/figure-html/pmdindex-9.png" width="700"><img src="globalstd_files/figure-html/pmdindex-10.png" width="700"></p>
</div>
<div id="screen-the-independent-peaks" class="section level3">
<h3 class="hasAnchor">
<a href="#screen-the-independent-peaks" class="anchor"></a>Screen the independent peaks</h3>
<p>You could use <code>getstd</code> function to get the independent peaks.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">std &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getstd.html">getstd</a></span>(pmd)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt; 11 group(s) with multiple peaks while no isotope/paired relationship</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt; 8 group(s) with multiple peaks with isotope without paired relationship</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt; 4 group(s) with paired relationship without isotope</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; 44 group(s) with paired relationship and isotope</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; 257 std mass found.</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt; 8 retention group(s) have single peaks.</span></a></code></pre></div>
<p>Here you could plot the peaks by <code>plotstd</code> function to show the distribution of independent peaks:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="../reference/plotstd.html">plotstd</a></span>(std)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/stdplot-1.png" width="700"></p>
<p>You could also plot the peaks distribution by assign a retention time group via <code>plotstdrt</code>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">23</span>,<span class="dt">main =</span> <span class="st">'Retention time group 23'</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">9</span>,<span class="dt">main =</span> <span class="st">'Retention time group 9'</span>)</a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">18</span>,<span class="dt">main =</span> <span class="st">'Retention time group 18'</span>)</a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">67</span>,<span class="dt">main =</span> <span class="st">'Retention time group 67'</span>)</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">49</span>,<span class="dt">main =</span> <span class="st">'Retention time group 49'</span>)</a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">6</span>,<span class="dt">main =</span> <span class="st">'Retention time group 6'</span>)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/stdrtplot-1.png" width="700"></p>
</div>
<div id="use-independent-peaks-for-msms-validation" class="section level3">
<h3 class="hasAnchor">
<a href="#use-independent-peaks-for-msms-validation" class="anchor"></a>Use independent peaks for MS/MS validation</h3>
<p>Independent peaks are supporsing generated from different compounds. We could use those peaks for MS/MS analysis instead of DIA or DDA. Here we need multiple injections for one sample since it might be impossible to get all ions’ fragmental ions in one injection with good sensitivity. You could use <code>gettarget</code> to generate the index for the injections and output the peaks for each run.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># you need retention time for independent peaks</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">index &lt;-<span class="st"> </span><span class="kw"><a href="../reference/gettarget.html">gettarget</a></span>(std<span class="op">$</span>rt[std<span class="op">$</span>stdmassindex])</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&gt; You need 6 injections!</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co"># output the ions for each injection</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/table">table</a></span>(index)</a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt; index</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt;  1  2  3  4  5  6 </span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt; 36 44 69 40 26 42</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co"># show the ions for the first injection</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10">std<span class="op">$</span>mz[index<span class="op">==</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt;   [1] 104.1082 110.0717 113.9638 136.0401 145.9553 149.9530 153.1277</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt;   [8] 155.1295 156.0776 158.9638 158.9617 161.0967 167.0134 170.0330</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#&gt;  [15] 170.0932 170.1541 173.1335 176.0418 180.1752 185.1148 200.2005</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#&gt;  [22] 203.0532 205.1954 212.2025 215.1272 217.1483 217.6492 226.1823</span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">#&gt;  [29] 226.1822 226.9522 227.2210 228.9561 232.1334 235.1692 242.2863</span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="co">#&gt;  [36] 242.2863 250.1779 251.2385 252.1237 261.2591 268.1893 270.3185</span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="co">#&gt;  [43] 270.3185 270.3185 270.3185 271.3217 271.3216 271.9179 277.1418</span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="co">#&gt;  [50] 279.1604 280.1630 280.2641 282.2811 285.3002 286.3101 288.9232</span></a>
<a class="sourceLine" id="cb8-19" data-line-number="19"><span class="co">#&gt;  [57] 305.1578 305.3118 307.9421 310.3117 311.3144 312.0163 312.3261</span></a>
<a class="sourceLine" id="cb8-20" data-line-number="20"><span class="co">#&gt;  [64] 318.8919 319.2846 319.3002 320.8698 324.2900 327.0091 328.0132</span></a>
<a class="sourceLine" id="cb8-21" data-line-number="21"><span class="co">#&gt;  [71] 335.2953 337.3313 340.3593 341.3048 342.0183 354.3365 362.9280</span></a>
<a class="sourceLine" id="cb8-22" data-line-number="22"><span class="co">#&gt;  [78] 365.1361 365.3196 367.3373 368.3904 371.3577 372.2591 376.3179</span></a>
<a class="sourceLine" id="cb8-23" data-line-number="23"><span class="co">#&gt;  [85] 383.1414 384.3350 385.2926 385.3484 387.2851 394.2617 397.1907</span></a>
<a class="sourceLine" id="cb8-24" data-line-number="24"><span class="co">#&gt;  [92] 400.3982 413.2660 414.2705 416.3062 421.2521 425.3120 426.2189</span></a>
<a class="sourceLine" id="cb8-25" data-line-number="25"><span class="co">#&gt;  [99] 426.3146 430.0895 430.3765 430.9137 431.9177 432.9177 437.2355</span></a>
<a class="sourceLine" id="cb8-26" data-line-number="26"><span class="co">#&gt; [106] 439.2698 446.8878 448.8862 462.8615 468.1028 469.1857 494.8112</span></a>
<a class="sourceLine" id="cb8-27" data-line-number="27"><span class="co">#&gt; [113] 502.3382 505.3342 507.3303 514.8764 517.8314 521.1371 521.3439</span></a>
<a class="sourceLine" id="cb8-28" data-line-number="28"><span class="co">#&gt; [120] 526.4841 535.4718 538.3150 538.5405 539.1646 541.1208 546.3560</span></a>
<a class="sourceLine" id="cb8-29" data-line-number="29"><span class="co">#&gt; [127] 554.2887 559.3841 568.8923 570.2830 576.4110 581.3659 584.8611</span></a>
<a class="sourceLine" id="cb8-30" data-line-number="30"><span class="co">#&gt; [134] 585.4215 586.4524 594.3765 595.1563 597.8743 600.4674 603.4105</span></a>
<a class="sourceLine" id="cb8-31" data-line-number="31"><span class="co">#&gt; [141] 607.4028 608.8745 621.4195 628.8597 639.3115 642.8627 644.8326</span></a>
<a class="sourceLine" id="cb8-32" data-line-number="32"><span class="co">#&gt; [148] 665.4444 676.8604 679.6890 681.4675 685.3464 690.6403 695.1516</span></a>
<a class="sourceLine" id="cb8-33" data-line-number="33"><span class="co">#&gt; [155] 695.5039 701.4938 705.1376 708.6701 709.3670 709.4930 711.3532</span></a>
<a class="sourceLine" id="cb8-34" data-line-number="34"><span class="co">#&gt; [162] 723.4865 731.7391 737.3591 764.5237 765.5253 768.6393 774.5655</span></a>
<a class="sourceLine" id="cb8-35" data-line-number="35"><span class="co">#&gt; [169] 778.8378 779.3404 779.5153 787.8267 787.9269 789.5260 791.8441</span></a>
<a class="sourceLine" id="cb8-36" data-line-number="36"><span class="co">#&gt; [176] 794.6305 797.5461 801.4967 813.3338 825.3520 836.5243 839.1707</span></a>
<a class="sourceLine" id="cb8-37" data-line-number="37"><span class="co">#&gt; [183] 840.3407 863.3158 873.3343 877.8092 879.3785 884.1633 886.7613</span></a>
<a class="sourceLine" id="cb8-38" data-line-number="38"><span class="co">#&gt; [190] 893.8251 894.3269 903.8164 915.3139 921.4730 923.8020 924.7338</span></a>
<a class="sourceLine" id="cb8-39" data-line-number="39"><span class="co">#&gt; [197] 929.4891 941.8210 946.8063 952.7628 991.7894 995.8063</span></a>
<a class="sourceLine" id="cb8-40" data-line-number="40">std<span class="op">$</span>rt[index<span class="op">==</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb8-41" data-line-number="41"><span class="co">#&gt;   [1]  254.2280  874.5865 1079.4300  552.8035   85.3855 1079.6400  524.9460</span></a>
<a class="sourceLine" id="cb8-42" data-line-number="42"><span class="co">#&gt;   [8]  785.8260  227.6550  213.7130  166.6990  490.7225   76.2780  215.0585</span></a>
<a class="sourceLine" id="cb8-43" data-line-number="43"><span class="co">#&gt;  [15]  235.9920  638.9930  611.4120  212.8690  611.8420  364.4610  521.5800</span></a>
<a class="sourceLine" id="cb8-44" data-line-number="44"><span class="co">#&gt;  [22]  144.8840  639.1010  639.1000  169.7485  638.8870  639.3130  611.4120</span></a>
<a class="sourceLine" id="cb8-45" data-line-number="45"><span class="co">#&gt;  [29]  416.1050  213.9270  639.3140  213.9650  403.6780  576.9100  880.3730</span></a>
<a class="sourceLine" id="cb8-46" data-line-number="46"><span class="co">#&gt;  [36]  573.8035  452.9630  639.1010  591.4830  639.1010  452.5345  538.0815</span></a>
<a class="sourceLine" id="cb8-47" data-line-number="47"><span class="co">#&gt;  [43]  501.6500  838.9070  823.9060  669.4930  715.1720   76.1710  482.5790</span></a>
<a class="sourceLine" id="cb8-48" data-line-number="48"><span class="co">#&gt;  [50]  664.9220  583.7700  576.6950  639.1000  504.4370  672.5290  213.5480</span></a>
<a class="sourceLine" id="cb8-49" data-line-number="49"><span class="co">#&gt;  [57]  169.8415  639.1000  146.3215  618.4820  618.4830  212.8675  636.9570</span></a>
<a class="sourceLine" id="cb8-50" data-line-number="50"><span class="co">#&gt;  [64]  143.6480  564.4820  594.9110  218.2260  556.5545  509.5330  509.1510</span></a>
<a class="sourceLine" id="cb8-51" data-line-number="51"><span class="co">#&gt;  [71]  582.6960  622.7700  658.6000  612.2680  717.1025  594.4820  213.9270</span></a>
<a class="sourceLine" id="cb8-52" data-line-number="52"><span class="co">#&gt;  [78]  578.1970  656.2235  585.2700  682.3870  688.6010  169.8615  594.6970</span></a>
<a class="sourceLine" id="cb8-53" data-line-number="53"><span class="co">#&gt;  [85]  605.5200  656.0105  561.2700  644.4580  492.8650  639.1000  613.7705</span></a>
<a class="sourceLine" id="cb8-54" data-line-number="54"><span class="co">#&gt;  [92]  594.5915  665.0290  665.0280  503.1510  634.3425  404.7480  601.1275</span></a>
<a class="sourceLine" id="cb8-55" data-line-number="55"><span class="co">#&gt;  [99]  404.5330  717.1010  704.8880  213.7270  213.7720  213.9420  170.9435</span></a>
<a class="sourceLine" id="cb8-56" data-line-number="56"><span class="co">#&gt; [106]  639.3130  215.6320  215.8650  217.1550  717.1010  600.2700  727.4325</span></a>
<a class="sourceLine" id="cb8-57" data-line-number="57"><span class="co">#&gt; [113]  511.5080  422.9630  554.8390  215.7020  144.7890  762.5770  515.0340</span></a>
<a class="sourceLine" id="cb8-58" data-line-number="58"><span class="co">#&gt; [120]  638.9925  639.3130  520.8340  705.5310  762.7890  762.5770  529.0810</span></a>
<a class="sourceLine" id="cb8-59" data-line-number="59"><span class="co">#&gt; [127]  512.7940  534.0090  213.7270  473.5890  534.0090  533.7950  215.7865</span></a>
<a class="sourceLine" id="cb8-60" data-line-number="60"><span class="co">#&gt; [134]  434.7490  439.2500  561.2680  819.4050  213.2320  543.2245  530.7950</span></a>
<a class="sourceLine" id="cb8-61" data-line-number="61"><span class="co">#&gt; [141]  434.9630  213.9410  454.9350  213.5990  630.8060  214.5700  215.1920</span></a>
<a class="sourceLine" id="cb8-62" data-line-number="62"><span class="co">#&gt; [148]  449.3220  214.3560  639.0980  468.5430  215.9255  594.0550  639.3130</span></a>
<a class="sourceLine" id="cb8-63" data-line-number="63"><span class="co">#&gt; [155]  698.3510  171.8625  639.2070  594.2710  481.2940  525.2220  215.2290</span></a>
<a class="sourceLine" id="cb8-64" data-line-number="64"><span class="co">#&gt; [162]  463.1855  659.2430  213.5480  773.9350  773.7190  624.0560  492.5440</span></a>
<a class="sourceLine" id="cb8-65" data-line-number="65"><span class="co">#&gt; [169]  214.5700  214.9615  519.6690  215.7020  212.7600  730.8590  213.2940</span></a>
<a class="sourceLine" id="cb8-66" data-line-number="66"><span class="co">#&gt; [176]  613.5560  519.7585  520.0790  214.9295  376.2490  698.2460  213.1200</span></a>
<a class="sourceLine" id="cb8-67" data-line-number="67"><span class="co">#&gt; [183]  213.3340  639.1010  213.5480  213.9270  381.6350  213.5090  217.3700</span></a>
<a class="sourceLine" id="cb8-68" data-line-number="68"><span class="co">#&gt; [190]  213.5020  213.4215  213.5020  214.9660  497.7940  215.4170  636.9560</span></a>
<a class="sourceLine" id="cb8-69" data-line-number="69"><span class="co">#&gt; [197]  213.3110  213.7130  213.6155  654.3150  215.3500  213.5020</span></a></code></pre></div>
</div>
<div id="validation-by-principal-components-analysispca" class="section level3">
<h3 class="hasAnchor">
<a href="#validation-by-principal-components-analysispca" class="anchor"></a>Validation by principal components analysis(PCA)</h3>
<p>You need to check the GlobalStd algorithm’s results by principal components analysis(PCA).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(enviGCMS)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data,<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(std<span class="op">$</span>group)),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(all peaks)"</span>)))</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data[std<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(std<span class="op">$</span>group)),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))</a></code></pre></div>
<p><img src="globalstd_files/figure-html/pca-1.png" width="700"></p>
</div>
<div id="comparision-with-other-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#comparision-with-other-packages" class="anchor"></a>Comparision with other packages</h3>
<p>GlobalStd algorithm in <code>pmd</code> package could be treated as a way to extract pseudospectra. You could use <code>getcluster</code> to get peaks groups information for all GlobalStd peaks. Then you could choose export peaks with the highest intensities in each GlobalStd peaks groups.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">stdcluster &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getcluster.html">getcluster</a></span>(std)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co"># extract pseudospectra for std peak 1</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(stdcluster<span class="op">$</span>cluster<span class="op">$</span>stdmassg[stdcluster<span class="op">$</span>cluster<span class="op">$</span>i<span class="op">==</span><span class="dv">42</span>],stdcluster<span class="op">$</span>cluster<span class="op">$</span>ins[stdcluster<span class="op">$</span>cluster<span class="op">$</span>i<span class="op">==</span><span class="dv">42</span>],<span class="dt">type =</span> <span class="st">'h'</span>,<span class="dt">xlab =</span> <span class="st">'m/z'</span>,<span class="dt">ylab =</span> <span class="st">'intensity'</span>,<span class="dt">main =</span> <span class="st">'pseudospectra for GlobalStd peak 42'</span>)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/comp-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># export peaks with the highest intensities in each GlobalStd peaks groups.</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">data &lt;-<span class="st"> </span>stdcluster<span class="op">$</span>data[stdcluster<span class="op">$</span>stdmassindex2,]</a></code></pre></div>
<p>You could also use <code>getcorcluster</code> to find peaks groups by correlation analysis only.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">corcluster &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getcorcluster.html">getcorcluster</a></span>(spmeinvivo)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co">#&gt; 75 retention time cluster found.</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data,<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(std<span class="op">$</span>group)),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(all peaks)"</span>)))</a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data[std<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(std<span class="op">$</span>group)),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))</a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data[corcluster<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(std<span class="op">$</span>group)),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks by correlationship)"</span>)))</a></code></pre></div>
<p><img src="globalstd_files/figure-html/corcomp-1.png" width="700"></p>
</div>
<div id="globalstd-algorithm-with-intensity-data" class="section level3">
<h3 class="hasAnchor">
<a href="#globalstd-algorithm-with-intensity-data" class="anchor"></a>GlobalStd algorithm with intensity data</h3>
<p>GlobalStd algorithm is designed to analysis data without intensity data. However, if you have intensity data, the independant peaks could be selected with more confindence. You could set up cutoff of Pearson Correlation Coefficient between peaks to refine the peaks selected by GlobalStd within same retention time groups.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">std2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getstd.html">getstd</a></span>(pmd,<span class="dt">corcutoff =</span> <span class="fl">0.9</span>)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="co">#&gt; 24 group(s) with multiple peaks while no isotope/paired relationship</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="co">#&gt; 12 group(s) with multiple peaks with isotope without paired relationship</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co">#&gt; 3 group(s) with paired relationship without isotope</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="co">#&gt; 28 group(s) with paired relationship and isotope</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co">#&gt; 116 std mass found.</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="co">#&gt; 8 retention group(s) have single peaks.</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std2<span class="op">$</span>data,<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(std2<span class="op">$</span>group)),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(all peaks)"</span>)))</a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data[std<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(std<span class="op">$</span>group)),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))</a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std2<span class="op">$</span>data[std2<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(std2<span class="op">$</span>group)),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))</a></code></pre></div>
<p><img src="globalstd_files/figure-html/globalcor-1.png" width="700"></p>
</div>
</div>
<div id="structurereaction-directed-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#structurereaction-directed-analysis" class="anchor"></a>Structure/Reaction directed analysis</h2>
<p><code>getsda</code> function could be used to perform Structure/reaction directed analysis. <code>freqcutoff</code> could be used to filter the PMD with high frequncy.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">sda &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getsda.html">getsda</a></span>(std, <span class="dt">freqcutoff =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="co">#&gt; Top 50 high frequency PMD groups were remained.</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="co">#&gt; 18 groups were found as high frequency PMD group.</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="co">#&gt; 0 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="co">#&gt; 1.98 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">#&gt; 2.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="co">#&gt; 13.98 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="co">#&gt; 14.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="co">#&gt; 14.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="co">#&gt; 15.99 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"><span class="co">#&gt; 16.03 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12"><span class="co">#&gt; 28.03 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13"><span class="co">#&gt; 30.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="co">#&gt; 42.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-15" data-line-number="15"><span class="co">#&gt; 49.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-16" data-line-number="16"><span class="co">#&gt; 58.04 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-17" data-line-number="17"><span class="co">#&gt; 66.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-18" data-line-number="18"><span class="co">#&gt; 68.06 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-19" data-line-number="19"><span class="co">#&gt; 82.08 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-20" data-line-number="20"><span class="co">#&gt; 116.08 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-21" data-line-number="21"><span class="co">#&gt; 126.14 were found as high frequency PMD.</span></a></code></pre></div>
<p>You could use <code>plotstdsda</code> to show the distribution of the selected paired peaks.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/stdsda-1.png" width="700"></p>
<p>You could also use index to show the distribution of certain PMDs.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>,<span class="dv">3</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">13.98</span>)</a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">15.99</span>)</a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">14.02</span>)</a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">28.03</span>)</a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">58.04</span>)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/stdsdaidx-1.png" width="700"></p>
<p>Structure/reaction directed analysis could be directily performed on all the peaks, which is slow to process:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">sdaall &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getsda.html">getsda</a></span>(spmeinvivo)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>,<span class="dv">3</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">13.98</span>)</a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">15.99</span>)</a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">14.02</span>)</a>
<a class="sourceLine" id="cb17-7" data-line-number="7"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">28.03</span>)</a>
<a class="sourceLine" id="cb17-8" data-line-number="8"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">58.04</span>)</a></code></pre></div>
<div id="structurereaction-directed-analysis-for-peakscompounds-only" class="section level3">
<h3 class="hasAnchor">
<a href="#structurereaction-directed-analysis-for-peakscompounds-only" class="anchor"></a>Structure/reaction directed analysis for peaks/compounds only</h3>
<p>When you only have data of peaks without retention time or compounds list, structure/reaction directed analysis could also be done by <code>getrda</code> function.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">sda &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getrda.html">getrda</a></span>(spmeinvivo<span class="op">$</span>mz[std<span class="op">$</span>stdmassindex])</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="co">#&gt; 28374 pmd found.</span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="co">#&gt; 9 pmd used.</span></a></code></pre></div>
</div>
<div id="structurereaction-network" class="section level3">
<h3 class="hasAnchor">
<a href="#structurereaction-network" class="anchor"></a>Structure/Reaction Network</h3>
<p>One peak or compounds could be involved in multiple reactions. You could construct a network by such relationship.</p>
<p>If you have a specific compound and want to check the metabolites of certain PMD, you could use <code>getchain</code> to extract the network of that compounds</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(igraph)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="co">#&gt; Attaching package: 'igraph'</span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="co">#&gt; The following objects are masked from 'package:stats':</span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="co">#&gt;     decompose, spectrum</span></a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="co">#&gt; The following object is masked from 'package:base':</span></a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb19-9" data-line-number="9"><span class="co">#&gt;     union</span></a>
<a class="sourceLine" id="cb19-10" data-line-number="10"><span class="co"># check metabolites of C18H39NO</span></a>
<a class="sourceLine" id="cb19-11" data-line-number="11">chain &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getchain.html">getchain</a></span>(spmeinvivo,<span class="dt">diff =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">2.02</span>,<span class="fl">14.02</span>,<span class="fl">15.99</span>,<span class="fl">58.04</span>,<span class="fl">13.98</span>),<span class="dt">mass =</span> <span class="fl">286.3101</span>)</a>
<a class="sourceLine" id="cb19-12" data-line-number="12"><span class="co"># show as network</span></a>
<a class="sourceLine" id="cb19-13" data-line-number="13">net &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/graph_from_data_frame">graph_from_data_frame</a></span>(chain<span class="op">$</span>sdac,<span class="dt">directed =</span> F)</a>
<a class="sourceLine" id="cb19-14" data-line-number="14"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(net,<span class="dt">vertex.label=</span><span class="ot">NA</span>,<span class="dt">vertex.size =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>((<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/V">V</a></span>(net))))<span class="op">/</span><span class="dv">25</span>,<span class="dt">edge.width =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/E">E</a></span>(net)<span class="op">$</span>diff2<span class="op">/</span><span class="dv">20</span><span class="fl">+0.00001</span>)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/tarnet-1.png" width="700"></p>
<p>If you want to see all the independant peaks’ high frequency PMDs as a network, the following code will help</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">sda &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getsda.html">getsda</a></span>(std, <span class="dt">freqcutoff =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="co">#&gt; Top 50 high frequency PMD groups were remained.</span></a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="co">#&gt; 18 groups were found as high frequency PMD group.</span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="co">#&gt; 0 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="co">#&gt; 1.98 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6"><span class="co">#&gt; 2.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="co">#&gt; 13.98 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="co">#&gt; 14.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="co">#&gt; 14.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-10" data-line-number="10"><span class="co">#&gt; 15.99 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-11" data-line-number="11"><span class="co">#&gt; 16.03 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-12" data-line-number="12"><span class="co">#&gt; 28.03 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-13" data-line-number="13"><span class="co">#&gt; 30.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-14" data-line-number="14"><span class="co">#&gt; 42.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-15" data-line-number="15"><span class="co">#&gt; 49.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-16" data-line-number="16"><span class="co">#&gt; 58.04 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-17" data-line-number="17"><span class="co">#&gt; 66.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-18" data-line-number="18"><span class="co">#&gt; 68.06 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-19" data-line-number="19"><span class="co">#&gt; 82.08 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-20" data-line-number="20"><span class="co">#&gt; 116.08 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-21" data-line-number="21"><span class="co">#&gt; 126.14 were found as high frequency PMD.</span></a>
<a class="sourceLine" id="cb20-22" data-line-number="22">df &lt;-<span class="st"> </span>sda<span class="op">$</span>sda</a>
<a class="sourceLine" id="cb20-23" data-line-number="23">net &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/graph_from_data_frame">graph_from_data_frame</a></span>(df,<span class="dt">directed =</span> F)</a>
<a class="sourceLine" id="cb20-24" data-line-number="24"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(net,<span class="dt">vertex.label=</span><span class="ot">NA</span>,<span class="dt">vertex.size =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>((<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/V">V</a></span>(net))))<span class="op">/</span><span class="dv">25</span>,<span class="dt">edge.width =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/E">E</a></span>(net)<span class="op">$</span>diff2<span class="op">/</span><span class="dv">20</span><span class="fl">+0.00001</span>)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/net-1.png" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="co"># Check the degree of the nodes</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="co"># Show the degree distribution of the vertices</span></a>
<a class="sourceLine" id="cb21-3" data-line-number="3">deg &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/degree">degree</a></span>(net, <span class="dt">mode=</span><span class="st">"all"</span>)</a>
<a class="sourceLine" id="cb21-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/degree">degree_distribution</a></span>(net)</a>
<a class="sourceLine" id="cb21-5" data-line-number="5"><span class="co">#&gt;  [1] 0.000000000 0.270270270 0.207207207 0.099099099 0.090090090</span></a>
<a class="sourceLine" id="cb21-6" data-line-number="6"><span class="co">#&gt;  [6] 0.072072072 0.054054054 0.081081081 0.027027027 0.054054054</span></a>
<a class="sourceLine" id="cb21-7" data-line-number="7"><span class="co">#&gt; [11] 0.009009009 0.000000000 0.009009009 0.000000000 0.000000000</span></a>
<a class="sourceLine" id="cb21-8" data-line-number="8"><span class="co">#&gt; [16] 0.000000000 0.018018018 0.000000000 0.000000000 0.000000000</span></a>
<a class="sourceLine" id="cb21-9" data-line-number="9"><span class="co">#&gt; [21] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000</span></a>
<a class="sourceLine" id="cb21-10" data-line-number="10"><span class="co">#&gt; [26] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000</span></a>
<a class="sourceLine" id="cb21-11" data-line-number="11"><span class="co">#&gt; [31] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000</span></a>
<a class="sourceLine" id="cb21-12" data-line-number="12"><span class="co">#&gt; [36] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000</span></a>
<a class="sourceLine" id="cb21-13" data-line-number="13"><span class="co">#&gt; [41] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000</span></a>
<a class="sourceLine" id="cb21-14" data-line-number="14"><span class="co">#&gt; [46] 0.000000000 0.000000000 0.000000000 0.009009009</span></a>
<a class="sourceLine" id="cb21-15" data-line-number="15"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(net, <span class="dt">vertex.size=</span>deg<span class="op">/</span><span class="dv">2</span>,<span class="dt">vertex.label=</span><span class="ot">NA</span>,<span class="dt">vertex.size =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>((<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/V">V</a></span>(net))))<span class="op">/</span><span class="dv">25</span>, <span class="dt">edge.width =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/E">E</a></span>(net)<span class="op">$</span>diff2<span class="op">/</span><span class="dv">20</span><span class="fl">+0.00001</span>)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/net-2.png" width="700"></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="co"># network community structure detection</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2">ceb &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/cluster_edge_betweenness">cluster_edge_betweenness</a></span>(net,<span class="dt">weights =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/E">E</a></span>(net)<span class="op">$</span>cor), <span class="dt">directed =</span> F) </a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="co">#&gt; Warning in cluster_edge_betweenness(net, weights = abs(E(net)$cor),</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="co">#&gt; directed = F): At community.c:460 :Membership vector will be selected based</span></a>
<a class="sourceLine" id="cb22-5" data-line-number="5"><span class="co">#&gt; on the lowest modularity score.</span></a>
<a class="sourceLine" id="cb22-6" data-line-number="6"><span class="co">#&gt; Warning in cluster_edge_betweenness(net, weights = abs(E(net)$cor),</span></a>
<a class="sourceLine" id="cb22-7" data-line-number="7"><span class="co">#&gt; directed = F): At community.c:467 :Modularity calculation with weighted</span></a>
<a class="sourceLine" id="cb22-8" data-line-number="8"><span class="co">#&gt; edge betweenness community detection might not make sense -- modularity</span></a>
<a class="sourceLine" id="cb22-9" data-line-number="9"><span class="co">#&gt; treats edge weights as similarities while edge betwenness treats them as</span></a>
<a class="sourceLine" id="cb22-10" data-line-number="10"><span class="co">#&gt; distances</span></a>
<a class="sourceLine" id="cb22-11" data-line-number="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(ceb, net,<span class="dt">vertex.label=</span><span class="ot">NA</span>,) </a></code></pre></div>
<p><img src="globalstd_files/figure-html/net-3.png" width="700"></p>
</div>
</div>
<div id="parameters-selection" class="section level2">
<h2 class="hasAnchor">
<a href="#parameters-selection" class="anchor"></a>Parameters selection</h2>
<p>Retention time cluster cutoff should fit the peak picking algorithm. For HPLC, 10 is suggested and 5 could be used for UPLC.</p>
<p>Global PMD’s retention time group numbers should be around 20 percent of the retention time cluster numbers. For example, if you find 100 retention time clusters, I suggested you use 20 as the empirical global PMD’s retention time group numbers.</p>
<p>As for the cutoff of the frequency of PMDs, you could change the frequency until you find certain PMD which you’re sure that it should appear in your dataset. For example, 16 should be considered as a good start. Any pmd with the frequency larger than PMD 16 could be further discussed.</p>
<p>Another important hint is that pre-filter your peak list by black samples or other quality control samples. Otherwise the running time would be long and lots of pmd relationship would be just from noise.</p>
</div>
<div id="wrap-function" class="section level2">
<h2 class="hasAnchor">
<a href="#wrap-function" class="anchor"></a>Wrap function</h2>
<p><code>globalstd</code> function is a wrap funtion to process GlobalStd algorithm and structure/reaction directed analysis in one line. All the plot function could be directly used on the <code>list</code> objects from <code>globalstd</code> function.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">result &lt;-<span class="st"> </span><span class="kw"><a href="../reference/globalstd.html">globalstd</a></span>(spmeinvivo)</a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="co">#&gt; 75 retention time cluster found.</span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="co">#&gt; 435 paired masses found</span></a>
<a class="sourceLine" id="cb23-4" data-line-number="4"><span class="co">#&gt; 10 unique within RT clusters high frequency PMD(s) used for further investigation.</span></a>
<a class="sourceLine" id="cb23-5" data-line-number="5"><span class="co">#&gt; 583 isotopologue(s) related paired mass found.</span></a>
<a class="sourceLine" id="cb23-6" data-line-number="6"><span class="co">#&gt; 685 multi-charger(s) related paired mass found.</span></a>
<a class="sourceLine" id="cb23-7" data-line-number="7"><span class="co">#&gt; 11 group(s) with multiple peaks while no isotope/paired relationship</span></a>
<a class="sourceLine" id="cb23-8" data-line-number="8"><span class="co">#&gt; 8 group(s) with multiple peaks with isotope without paired relationship</span></a>
<a class="sourceLine" id="cb23-9" data-line-number="9"><span class="co">#&gt; 4 group(s) with paired relationship without isotope</span></a>
<a class="sourceLine" id="cb23-10" data-line-number="10"><span class="co">#&gt; 44 group(s) with paired relationship and isotope</span></a>
<a class="sourceLine" id="cb23-11" data-line-number="11"><span class="co">#&gt; 257 std mass found.</span></a>
<a class="sourceLine" id="cb23-12" data-line-number="12"><span class="co">#&gt; 8 retention group(s) have single peaks.</span></a>
<a class="sourceLine" id="cb23-13" data-line-number="13"><span class="co">#&gt; Top 50 high frequency PMD groups were remained.</span></a>
<a class="sourceLine" id="cb23-14" data-line-number="14"><span class="co">#&gt; 18 groups were found as high frequency PMD group.</span></a>
<a class="sourceLine" id="cb23-15" data-line-number="15"><span class="co">#&gt; 0 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-16" data-line-number="16"><span class="co">#&gt; 1.98 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-17" data-line-number="17"><span class="co">#&gt; 2.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-18" data-line-number="18"><span class="co">#&gt; 13.98 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-19" data-line-number="19"><span class="co">#&gt; 14.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-20" data-line-number="20"><span class="co">#&gt; 14.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-21" data-line-number="21"><span class="co">#&gt; 15.99 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-22" data-line-number="22"><span class="co">#&gt; 16.03 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-23" data-line-number="23"><span class="co">#&gt; 28.03 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-24" data-line-number="24"><span class="co">#&gt; 30.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-25" data-line-number="25"><span class="co">#&gt; 42.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-26" data-line-number="26"><span class="co">#&gt; 49.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-27" data-line-number="27"><span class="co">#&gt; 58.04 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-28" data-line-number="28"><span class="co">#&gt; 66.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-29" data-line-number="29"><span class="co">#&gt; 68.06 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-30" data-line-number="30"><span class="co">#&gt; 82.08 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-31" data-line-number="31"><span class="co">#&gt; 116.08 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-32" data-line-number="32"><span class="co">#&gt; 126.14 were found as high frequency PMD.</span></a></code></pre></div>
</div>
<div id="shiny-application" class="section level2">
<h2 class="hasAnchor">
<a href="#shiny-application" class="anchor"></a>Shiny application</h2>
<p>An interactive document has been included in this package to show PMD analysis. You could run <code><a href="../reference/runPMD.html">runPMD()</a></code> to start the Graphical user interface(GUI) for GlobalStd algorithm and structure/reaction directed analysis. You need to prepare a csv file with m/z and retention time of peaks. Such csv file could be generated by run <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrtcsv">enviGCMS::getmzrtcsv()</a></code> on the <code>list</code> object from <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt">enviGCMS::getmzrt(xset)</a></code> or <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt2">enviGCMS::getmzrt2(xset)</a></code> function. You could also generate the csv file by <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt">enviGCMS::getmzrt(xset,name = 'test')</a></code> or <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt2">enviGCMS::getmzrt2(xset, name = 'test')</a></code>. You will find the csv file in the working dictionary named <code>test.csv</code>.</p>
</div>
<div id="conclusion" class="section level2">
<h2 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h2>
<p><code>pmd</code> package could be used to reduce the redundancy peaks for GC/LC-MS based research and perform structure/reaction directed analysis to screen known and unknown important compounds or reactions.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction-of-paired-mass-distance-analysis">Introduction of Paired Mass Distance analysis</a></li>
      <li><a href="#data-format">Data format</a></li>
      <li><a href="#globalstd-algorithm">GlobalStd algorithm</a></li>
      <li><a href="#structurereaction-directed-analysis">Structure/Reaction directed analysis</a></li>
      <li><a href="#parameters-selection">Parameters selection</a></li>
      <li><a href="#wrap-function">Wrap function</a></li>
      <li><a href="#shiny-application">Shiny application</a></li>
      <li><a href="#conclusion">Conclusion</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Miao YU.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
