<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis • pmd</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-58201304-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-58201304-1');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pmd</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/globalstd.html">Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis</h1>
                        <h4 class="author">Miao Yu</h4>
            
            <h4 class="date">2019-03-12</h4>
      
      
      <div class="hidden name"><code>globalstd.Rmd</code></div>

    </div>

    
    
<div id="introduction-of-paired-mass-distance-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction-of-paired-mass-distance-analysis" class="anchor"></a>Introduction of Paired Mass Distance analysis</h2>
<p><code>pmd</code> package use Paired Mass Distance (PMD) relationship to analysis the GC/LC-MS based non-targeted data. PMD means the distance between two masses or mass to charge ratios. In mass spectrometry, PMD would keep the same between two masses or two mass to charge ratios(m/z). There are twe kinds of PMD involved in this package: PMD within same retention time group and PMD from different retention time groups.</p>
<div id="pmd-within-same-retention-time-group" class="section level3">
<h3 class="hasAnchor">
<a href="#pmd-within-same-retention-time-group" class="anchor"></a>PMD within same retention time group</h3>
<p>In GC/LC-MS based non-targeted analysis, peaks could be seperated by chromatograph. We could build retention time(RT) bins to assign peaks into different RT groups by retention time hierarchical clustering analysis. For each RT group, the peaks should come from same compounds or co-elutes. If certain PMD appeared in multiple RT groups, it would be related to the relationship about adducts, neutral loss, isotopologues or commen fragments ions.</p>
</div>
<div id="pmd-from-different-retention-time-groups" class="section level3">
<h3 class="hasAnchor">
<a href="#pmd-from-different-retention-time-groups" class="anchor"></a>PMD from different retention time groups</h3>
<p>The peaks from different retention time groups would like to be different compounds seperated by chromatograph. The PMD would reflect the relationship about homologous series or chemical reactions.</p>
<p>GlobalStd algorithm use the PMD within same RT group to find independent peaks among certain dataset. Structure/reaction directed analysis use PMD from different RT groups to screen important compounds or reactions.</p>
</div>
</div>
<div id="data-format" class="section level2">
<h2 class="hasAnchor">
<a href="#data-format" class="anchor"></a>Data format</h2>
<p>The input data should be a <code>list</code> object with at least two elements from a peaks list:</p>
<ul>
<li>mass to charge ratio with name of <code>mz</code>, high resolution mass spectrometry is required</li>
<li>retention time with name of <code>rt</code>
</li>
</ul>
<p>However, I suggested to add intensity and group information to the list for validation of PMD analysis.</p>
<p>In this package, a dataset from <em>in vivo</em> solid phase micro-extraction(SPME) was attached. This dataset contain 9 samples from 3 fish with triplicates samples for each fish. Here is the data strcture:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(pmd)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"spmeinvivo"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(spmeinvivo)
<span class="co">#&gt; List of 4</span>
<span class="co">#&gt;  $ data : num [1:1459, 1:9] 1095 10439 10154 2797 90211 ...</span>
<span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span>
<span class="co">#&gt;   .. ..$ : chr [1:1459] "100.1/170" "100.5/86" "101/85" "103.1/348" ...</span>
<span class="co">#&gt;   .. ..$ : chr [1:9] "1405_Fish1_F1" "1405_Fish1_F2" "1405_Fish1_F3" "1405_Fish2_F1" ...</span>
<span class="co">#&gt;  $ group:'data.frame':   9 obs. of  1 variable:</span>
<span class="co">#&gt;   ..$ class: Factor w/ 3 levels "fish1","fish2",..: 1 1 1 2 2 2 3 3 3</span>
<span class="co">#&gt;  $ mz   : num [1:1459] 100 101 101 103 104 ...</span>
<span class="co">#&gt;  $ rt   : num [1:1459] 170.2 86.3 84.9 348.1 48.8 ...</span></code></pre></div>
<p>You could build this <code>list</code> object from the <code>xcms</code> objects via <code>enviGCMS</code> package. When you have a <code>xcmsSet</code> object or <code>XCMSnExp</code> object named <code>xset</code>, you could use <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt">enviGCMS::getmzrt(xset)</a></code> or <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt2">enviGCMS::getmzrt2(xset)</a></code> to get such list. Of course you could build such list by yourself.</p>
</div>
<div id="globalstd-algorithm" class="section level2">
<h2 class="hasAnchor">
<a href="#globalstd-algorithm" class="anchor"></a>GlobalStd algorithm</h2>
<p>GlobalStd algorithm try to find independent peaks among certain peaks list. The first step is retention time hierarchical clustering analysis. The second step is to find the relationship among adducts, neutral loss, isotopologues and commen fragments ions. The third step is to screen the independent peaks.</p>
<div id="retention-time-hierarchical-clustering" class="section level3">
<h3 class="hasAnchor">
<a href="#retention-time-hierarchical-clustering" class="anchor"></a>Retention time hierarchical clustering</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pmd &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getpaired.html">getpaired</a></span>(spmeinvivo, <span class="dt">rtcutoff =</span> <span class="dv">10</span>, <span class="dt">ng =</span> <span class="dv">10</span>)
<span class="co">#&gt; 75 retention time cluster found.</span>
<span class="co">#&gt; 435 paired masses found</span>
<span class="co">#&gt; 10 unique PMD(s) used for further investigation.</span>
<span class="co">#&gt; 583 isotopologue(s) related paired mass found.</span>
<span class="co">#&gt; 685 multi-charger(s) related paired mass found.</span>
<span class="kw"><a href="../reference/plotrtg.html">plotrtg</a></span>(pmd)</code></pre></div>
<p><img src="globalstd_files/figure-html/rtg-1.png" width="700"></p>
<p>This plot would show the distribution of RT groups. The <code>rtcutoff</code> in function <code>getpaired</code> could be used to set the cutoff of the distances in retention time hierarchical clustering analysis.</p>
</div>
<div id="relationship-among-adducts-neutral-loss-isotopologues-and-commen-fragments-ions" class="section level3">
<h3 class="hasAnchor">
<a href="#relationship-among-adducts-neutral-loss-isotopologues-and-commen-fragments-ions" class="anchor"></a>Relationship among adducts, neutral loss, isotopologues and commen fragments ions</h3>
<p>The <code>ng</code> in function <code>getpaired</code> could be used to set cutoff of global PMD’s retention time group numbers. If <code>ng</code> is 10, at least 10 of the retention time groups should contain the shown PMD relationship. You could use <code>plotpaired</code> to show the distribution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotpaired.html">plotpaired</a></span>(pmd)</code></pre></div>
<p><img src="globalstd_files/figure-html/pmd-1.png" width="700"></p>
<p>You could also show the distribution of PMD relationship by index:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># show the unique PMD found by getpaired function</span>
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(pmd<span class="op">$</span>paired<span class="op">$</span>diff2))){
        diff &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(pmd<span class="op">$</span>paired<span class="op">$</span>diff2)[i]
        index &lt;-<span class="st"> </span>pmd<span class="op">$</span>paired<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span>diff
        <span class="kw"><a href="../reference/plotpaired.html">plotpaired</a></span>(pmd,index)
}</code></pre></div>
<p><img src="globalstd_files/figure-html/pmdindex-1.png" width="700"><img src="globalstd_files/figure-html/pmdindex-2.png" width="700"><img src="globalstd_files/figure-html/pmdindex-3.png" width="700"><img src="globalstd_files/figure-html/pmdindex-4.png" width="700"><img src="globalstd_files/figure-html/pmdindex-5.png" width="700"><img src="globalstd_files/figure-html/pmdindex-6.png" width="700"><img src="globalstd_files/figure-html/pmdindex-7.png" width="700"><img src="globalstd_files/figure-html/pmdindex-8.png" width="700"><img src="globalstd_files/figure-html/pmdindex-9.png" width="700"><img src="globalstd_files/figure-html/pmdindex-10.png" width="700"></p>
</div>
<div id="screen-the-independent-peaks" class="section level3">
<h3 class="hasAnchor">
<a href="#screen-the-independent-peaks" class="anchor"></a>Screen the independent peaks</h3>
<p>You could use <code>getstd</code> function to get the independent peaks.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">std &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getstd.html">getstd</a></span>(pmd)
<span class="co">#&gt; 11 group(s) with multiple peaks while no isotope/paired relationship</span>
<span class="co">#&gt; 8 group(s) with multiple peaks with isotope without paired relationship</span>
<span class="co">#&gt; 4 group(s) with paired relationship without isotope</span>
<span class="co">#&gt; 44 group(s) with paired relationship and isotope</span>
<span class="co">#&gt; 257 std mass found.</span>
<span class="co">#&gt; 8 retention group(s) have single peaks.</span></code></pre></div>
<p>Here you could plot the peaks by <code>plotstd</code> function to show the distribution of independent peaks:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotstd.html">plotstd</a></span>(std)</code></pre></div>
<p><img src="globalstd_files/figure-html/stdplot-1.png" width="700"></p>
<p>You could also plot the peaks distribution by assign a retention time group via <code>plotstdrt</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>,<span class="dv">3</span>))
<span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">23</span>,<span class="dt">main =</span> <span class="st">'Retention time group 23'</span>)
<span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">9</span>,<span class="dt">main =</span> <span class="st">'Retention time group 9'</span>)
<span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">18</span>,<span class="dt">main =</span> <span class="st">'Retention time group 18'</span>)
<span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">67</span>,<span class="dt">main =</span> <span class="st">'Retention time group 67'</span>)
<span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">49</span>,<span class="dt">main =</span> <span class="st">'Retention time group 49'</span>)
<span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">6</span>,<span class="dt">main =</span> <span class="st">'Retention time group 6'</span>)</code></pre></div>
<p><img src="globalstd_files/figure-html/stdrtplot-1.png" width="700"></p>
</div>
<div id="use-independent-peaks-for-msms-validation" class="section level3">
<h3 class="hasAnchor">
<a href="#use-independent-peaks-for-msms-validation" class="anchor"></a>Use independent peaks for MS/MS validation</h3>
<p>Independent peaks are supporsing generated from different compounds. We could use those peaks for MS/MS analysis instead of DIA or DDA. Here we need multiple injections for one sample since it might be impossible to get all ions’ fragmental ions in one injection with good sensitivity. You could use <code>gettarget</code> to generate the index for the injections and output the peaks for each run.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># you need retention time for independent peaks</span>
index &lt;-<span class="st"> </span><span class="kw"><a href="../reference/gettarget.html">gettarget</a></span>(std<span class="op">$</span>rt[std<span class="op">$</span>stdmassindex])
<span class="co">#&gt; You need 6 injections!</span>
<span class="co"># output the ions for each injection</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/table">table</a></span>(index)
<span class="co">#&gt; index</span>
<span class="co">#&gt;  1  2  3  4  5  6 </span>
<span class="co">#&gt; 32 30 42 60 39 54</span>
<span class="co"># show the ions for the first injection</span>
std<span class="op">$</span>mz[index<span class="op">==</span><span class="dv">1</span>]
<span class="co">#&gt;   [1] 110.0092 139.0591 139.9877 149.0236 153.1277 155.1294 156.1777</span>
<span class="co">#&gt;   [8] 158.1546 161.0600 162.1128 163.0758 170.0330 173.1335 174.1363</span>
<span class="co">#&gt;  [15] 174.9383 181.1597 181.9871 186.1854 188.6484 190.9130 195.1027</span>
<span class="co">#&gt;  [22] 209.1552 211.1698 220.1184 229.2008 235.1692 236.1730 237.6615</span>
<span class="co">#&gt;  [29] 240.2335 242.2863 242.2863 242.2863 251.0476 265.2539 265.4216</span>
<span class="co">#&gt;  [36] 269.9189 270.3185 270.3185 270.3185 271.3217 271.3217 272.3234</span>
<span class="co">#&gt;  [43] 272.9318 279.1604 282.2811 282.9806 283.2249 286.3101 286.3101</span>
<span class="co">#&gt;  [50] 291.0712 293.2853 294.2875 300.2046 308.2954 309.9372 313.3297</span>
<span class="co">#&gt;  [57] 324.3266 328.0132 329.0052 329.8840 332.5619 335.3135 336.1296</span>
<span class="co">#&gt;  [64] 336.3257 341.0180 358.3084 359.0292 365.1059 365.3196 367.3375</span>
<span class="co">#&gt;  [71] 369.3534 371.3345 374.3041 377.3522 377.8991 384.3350 387.2851</span>
<span class="co">#&gt;  [78] 387.7863 390.2490 398.2762 399.1231 400.9174 401.3421 403.2332</span>
<span class="co">#&gt;  [85] 407.3384 417.3364 420.3568 429.0892 433.2781 439.2698 442.3376</span>
<span class="co">#&gt;  [92] 444.3844 445.3874 447.1173 447.2935 448.1186 463.3975 498.9017</span>
<span class="co">#&gt;  [99] 499.9050 505.1055 507.3303 512.4158 518.3245 520.3415 524.1178</span>
<span class="co">#&gt; [106] 528.4109 528.4989 538.3150 541.1208 541.3942 542.3266 555.2922</span>
<span class="co">#&gt; [113] 556.4416 559.4247 560.2193 560.3877 565.3827 578.1272 581.1925</span>
<span class="co">#&gt; [120] 590.3223 604.4152 608.8745 613.1827 614.5358 619.6137 621.4412</span>
<span class="co">#&gt; [127] 622.4229 626.3960 640.1961 670.4222 673.8481 679.5118 681.4675</span>
<span class="co">#&gt; [134] 685.2035 691.4631 694.6505 697.8511 702.8662 703.1383 708.6701</span>
<span class="co">#&gt; [141] 711.3532 712.8208 714.4484 731.8438 732.5472 737.5030 738.5066</span>
<span class="co">#&gt; [148] 739.5078 753.5196 772.3250 773.5940 784.2366 794.8123 801.4967</span>
<span class="co">#&gt; [155] 803.5434 805.3464 810.5068 813.8323 814.4154 819.3943 837.5278</span>
<span class="co">#&gt; [162] 870.7857 871.3033 875.8088 879.3785 883.7184 888.6729 889.8086</span>
<span class="co">#&gt; [169] 900.3092 907.1589 907.3250 921.4730 929.4891 930.1575 934.3019</span>
<span class="co">#&gt; [176] 947.7443 948.8063 956.7945 964.7811 968.7950 979.7901</span>
std<span class="op">$</span>rt[index<span class="op">==</span><span class="dv">1</span>]
<span class="co">#&gt;   [1] 1079.6500  511.2940   84.8490  583.7690  524.9460  804.4690  405.3890</span>
<span class="co">#&gt;   [8]  470.3640  620.6270  256.1585  576.9100  215.0585  611.4120  611.4135</span>
<span class="co">#&gt;  [15]  216.1500  615.0530  147.8970  501.3300  639.2075  218.0975  538.0810</span>
<span class="co">#&gt;  [22]  611.4120  452.9630  170.8240  614.6260  576.9100  576.9100  639.6355</span>
<span class="co">#&gt;  [29]  639.1010  538.2950  896.1220  711.5320  605.8400  618.2700  145.8285</span>
<span class="co">#&gt;  [36]  144.6810  501.6500  604.7690  670.2425  880.8005  699.9580  742.6450</span>
<span class="co">#&gt;  [43]  145.7540  664.9220  639.1000  146.0980  552.2670  732.0395  895.6960</span>
<span class="co">#&gt;  [50]  161.3960  618.2710  618.5915  172.2230  569.4105  145.4960  636.9560</span>
<span class="co">#&gt;  [57]  628.9860  509.1510  509.3650  144.3380  141.6810  608.1990  617.6270</span>
<span class="co">#&gt;  [64]  557.6255  717.1835  650.2440  717.0520  143.9315  656.2235  644.2420</span>
<span class="co">#&gt;  [71]  688.3880  551.7325  582.4840  650.0300  145.1090  656.0105  492.8650</span>
<span class="co">#&gt;  [78]  492.4380  534.0100  492.2220  527.9020  145.1090  632.8410  601.3400</span>
<span class="co">#&gt;  [85]  556.9840  603.4845  655.9035  717.1020  382.6760  639.3130  656.2430</span>
<span class="co">#&gt;  [92]  582.4815  582.4825  716.8890  404.5340  717.1020  582.3755  213.7270</span>
<span class="co">#&gt;  [99]  213.9270  762.4675  554.8390  550.3385  495.3295  515.3650  690.5290</span>
<span class="co">#&gt; [106]  422.7495  643.4925  520.8340  762.5770  628.3425  492.4360  512.7070</span>
<span class="co">#&gt; [113]  546.9100  439.4630  340.9965  533.3660  439.2500  819.4060  762.4690</span>
<span class="co">#&gt; [120]  510.4370  529.9730  213.9410  819.1920  639.0990  618.4840  531.0090</span>
<span class="co">#&gt; [127]  455.1500  530.5830  818.9790  527.7930  214.3560  172.8655  468.5430</span>
<span class="co">#&gt; [134]  883.1575  525.0090  639.1000  214.3710  213.7270  639.0990  594.2710</span>
<span class="co">#&gt; [141]  215.2290  214.7985  525.0080  214.1480  481.0785  481.0790  481.2930</span>
<span class="co">#&gt; [148]  480.6530  522.2240  370.0360  624.2695  700.3870  215.7855  520.0790</span>
<span class="co">#&gt; [155]  665.0290  213.5480  682.6000  214.5090  490.2940  467.2110  698.2460</span>
<span class="co">#&gt; [162]  216.5120  639.2070  214.3710  381.6350  632.1990  632.3055  215.2605</span>
<span class="co">#&gt; [169]  213.5480  213.3590  213.5480  497.7940  213.3110  213.5310  213.6405</span>
<span class="co">#&gt; [176]  800.0770  214.2010  215.0405  215.6320  213.9410  213.9410</span></code></pre></div>
</div>
<div id="validation-by-principal-components-analysispca" class="section level3">
<h3 class="hasAnchor">
<a href="#validation-by-principal-components-analysispca" class="anchor"></a>Validation by principal components analysis(PCA)</h3>
<p>You need to check the GlobalStd algorithm’s results by principal components analysis(PCA).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(enviGCMS)
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data,<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(std<span class="op">$</span>group<span class="op">$</span>class),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(all peaks)"</span>)))
<span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data[std<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(std<span class="op">$</span>group<span class="op">$</span>class),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))</code></pre></div>
<p><img src="globalstd_files/figure-html/pca-1.png" width="700"></p>
</div>
<div id="comparision-with-other-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#comparision-with-other-packages" class="anchor"></a>Comparision with other packages</h3>
<p>GlobalStd algorithm in <code>pmd</code> package could be treated as a way to extract pseudospectra. You could use <code>getcluster</code> to get peaks groups information for all GlobalStd peaks. Then you could choose export peaks with the highest intensities in each GlobalStd peaks groups.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stdcluster &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getcluster.html">getcluster</a></span>(std)
<span class="co"># extract pseudospectra for std peak 1</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(stdcluster<span class="op">$</span>cluster<span class="op">$</span>stdmassg[stdcluster<span class="op">$</span>cluster<span class="op">$</span>i<span class="op">==</span><span class="dv">42</span>],stdcluster<span class="op">$</span>cluster<span class="op">$</span>ins[stdcluster<span class="op">$</span>cluster<span class="op">$</span>i<span class="op">==</span><span class="dv">42</span>],<span class="dt">type =</span> <span class="st">'h'</span>,<span class="dt">xlab =</span> <span class="st">'m/z'</span>,<span class="dt">ylab =</span> <span class="st">'intensity'</span>,<span class="dt">main =</span> <span class="st">'pseudospectra for GlobalStd peak 42'</span>)</code></pre></div>
<p><img src="globalstd_files/figure-html/comp-1.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># export peaks with the highest intensities in each GlobalStd peaks groups.</span>
data &lt;-<span class="st"> </span>stdcluster<span class="op">$</span>data[stdcluster<span class="op">$</span>stdmassindex2,]</code></pre></div>
<p>You could also use <code>getcorcluster</code> to find peaks groups by correlation analysis only.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">corcluster &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getcorcluster.html">getcorcluster</a></span>(spmeinvivo)
<span class="co">#&gt; 75 retention time cluster found.</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data,<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(std<span class="op">$</span>group<span class="op">$</span>class),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(all peaks)"</span>)))
<span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data[std<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(std<span class="op">$</span>group<span class="op">$</span>class),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))
<span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data[corcluster<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(std<span class="op">$</span>group<span class="op">$</span>class),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks by correlationship)"</span>)))</code></pre></div>
<p><img src="globalstd_files/figure-html/corcomp-1.png" width="700"></p>
</div>
<div id="globalstd-algorithm-with-intensity-data" class="section level3">
<h3 class="hasAnchor">
<a href="#globalstd-algorithm-with-intensity-data" class="anchor"></a>GlobalStd algorithm with intensity data</h3>
<p>GlobalStd algorithm is designed to analysis data without intensity data. However, if you have intensity data, the independant peaks could be selected with more confindence. You could set up cutoff of Pearson Correlation Coefficient between peaks to refine the peaks selected by GlobalStd within same retention time groups.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">std2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getstd.html">getstd</a></span>(pmd,<span class="dt">corcutoff =</span> <span class="fl">0.9</span>)
<span class="co">#&gt; 24 group(s) with multiple peaks while no isotope/paired relationship</span>
<span class="co">#&gt; 12 group(s) with multiple peaks with isotope without paired relationship</span>
<span class="co">#&gt; 3 group(s) with paired relationship without isotope</span>
<span class="co">#&gt; 28 group(s) with paired relationship and isotope</span>
<span class="co">#&gt; 116 std mass found.</span>
<span class="co">#&gt; 8 retention group(s) have single peaks.</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std2<span class="op">$</span>data,<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(std2<span class="op">$</span>group<span class="op">$</span>class),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(all peaks)"</span>)))
<span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data[std<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(std<span class="op">$</span>group<span class="op">$</span>class),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))
<span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std2<span class="op">$</span>data[std2<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(std2<span class="op">$</span>group<span class="op">$</span>class),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))</code></pre></div>
<p><img src="globalstd_files/figure-html/globalcor-1.png" width="700"></p>
</div>
</div>
<div id="structurereaction-directed-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#structurereaction-directed-analysis" class="anchor"></a>Structure/reaction directed analysis</h2>
<p><code>getsda</code> function could be used to perform Structure/reaction directed analysis. <code>freqcutoff</code> could be used to filter the PMD with high frequncy.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sda &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getsda.html">getsda</a></span>(std, <span class="dt">freqcutoff =</span> <span class="dv">10</span>)
<span class="co">#&gt; Top 50 high frequency PMD groups were remained.</span>
<span class="co">#&gt; 18 groups were found as high frequency PMD group.</span>
<span class="co">#&gt; 0 were found as high frequency PMD. </span>
<span class="co">#&gt; 1.98 were found as high frequency PMD. </span>
<span class="co">#&gt; 2.02 were found as high frequency PMD. </span>
<span class="co">#&gt; 13.98 were found as high frequency PMD. </span>
<span class="co">#&gt; 14.02 were found as high frequency PMD. </span>
<span class="co">#&gt; 14.05 were found as high frequency PMD. </span>
<span class="co">#&gt; 15.99 were found as high frequency PMD. </span>
<span class="co">#&gt; 16.03 were found as high frequency PMD. </span>
<span class="co">#&gt; 28.03 were found as high frequency PMD. </span>
<span class="co">#&gt; 30.05 were found as high frequency PMD. </span>
<span class="co">#&gt; 42.05 were found as high frequency PMD. </span>
<span class="co">#&gt; 49.02 were found as high frequency PMD. </span>
<span class="co">#&gt; 58.04 were found as high frequency PMD. </span>
<span class="co">#&gt; 66.05 were found as high frequency PMD. </span>
<span class="co">#&gt; 68.06 were found as high frequency PMD. </span>
<span class="co">#&gt; 82.08 were found as high frequency PMD. </span>
<span class="co">#&gt; 116.08 were found as high frequency PMD. </span>
<span class="co">#&gt; 126.14 were found as high frequency PMD.</span></code></pre></div>
<p>You could use <code>plotstdsda</code> to show the distribution of the selected paired peaks.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda)</code></pre></div>
<p><img src="globalstd_files/figure-html/stdsda-1.png" width="700"></p>
<p>You could also use index to show the distribution of certain PMDs.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>,<span class="dv">3</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)
<span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)
<span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">13.98</span>)
<span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">15.99</span>)
<span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">14.02</span>)
<span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">28.03</span>)
<span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">58.04</span>)</code></pre></div>
<p><img src="globalstd_files/figure-html/stdsdaidx-1.png" width="700"></p>
<p>Structure/reaction directed analysis could be directily performed on all the peaks, which is slow to process:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sdaall &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getsda.html">getsda</a></span>(spmeinvivo)
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>,<span class="dv">3</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)
<span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)
<span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">13.98</span>)
<span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">15.99</span>)
<span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">14.02</span>)
<span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">28.03</span>)
<span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">58.04</span>)</code></pre></div>
<div id="structurereaction-directed-analysis-for-peakscompounds-only" class="section level3">
<h3 class="hasAnchor">
<a href="#structurereaction-directed-analysis-for-peakscompounds-only" class="anchor"></a>Structure/reaction directed analysis for peaks/compounds only</h3>
<p>When you only have data of peaks without retention time or compounds list, structure/reaction directed analysis could also be done by <code>getrda</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sda &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getrda.html">getrda</a></span>(spmeinvivo<span class="op">$</span>mz[std<span class="op">$</span>stdmassindex])</code></pre></div>
</div>
</div>
<div id="parameters-selection" class="section level2">
<h2 class="hasAnchor">
<a href="#parameters-selection" class="anchor"></a>Parameters selection</h2>
<p>Retention time cluster cutoff should fit the peak picking algorithm. For HPLC, 10 is suggested and 5 could be used for UPLC.</p>
<p>Global PMD’s retention time group numbers should be around 20 percent of the retention time cluster numbers. For example, if you find 100 retention time clusters, I suggested you use 20 as the empirical global PMD’s retention time group numbers.</p>
<p>As for the cutoff of the frequency of PMDs, you could change the frequency until you find certain PMD which you’re sure that it should appear in your dataset. For example, 16 should be considered as a good start. Any pmd with the frequency larger than PMD 16 could be further discussed.</p>
<p>Another important hint is that pre-filter your peak list by black samples or other quality control samples. Otherwise the running time would be long and lots of pmd relationship would be just from noise.</p>
</div>
<div id="wrap-function" class="section level2">
<h2 class="hasAnchor">
<a href="#wrap-function" class="anchor"></a>Wrap function</h2>
<p><code>globalstd</code> function is a wrap funtion to process GlobalStd algorithm and structure/reaction directed analysis in one line. All the plot function could be directly used on the <code>list</code> objects from <code>globalstd</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">result &lt;-<span class="st"> </span><span class="kw"><a href="../reference/globalstd.html">globalstd</a></span>(spmeinvivo)
<span class="co">#&gt; 75 retention time cluster found.</span>
<span class="co">#&gt; 435 paired masses found</span>
<span class="co">#&gt; 10 unique PMD(s) used for further investigation.</span>
<span class="co">#&gt; 583 isotopologue(s) related paired mass found.</span>
<span class="co">#&gt; 685 multi-charger(s) related paired mass found.</span>
<span class="co">#&gt; 11 group(s) with multiple peaks while no isotope/paired relationship</span>
<span class="co">#&gt; 8 group(s) with multiple peaks with isotope without paired relationship</span>
<span class="co">#&gt; 4 group(s) with paired relationship without isotope</span>
<span class="co">#&gt; 44 group(s) with paired relationship and isotope</span>
<span class="co">#&gt; 257 std mass found.</span>
<span class="co">#&gt; 8 retention group(s) have single peaks.</span>
<span class="co">#&gt; Top 50 high frequency PMD groups were remained.</span>
<span class="co">#&gt; 18 groups were found as high frequency PMD group.</span>
<span class="co">#&gt; 0 were found as high frequency PMD. </span>
<span class="co">#&gt; 1.98 were found as high frequency PMD. </span>
<span class="co">#&gt; 2.02 were found as high frequency PMD. </span>
<span class="co">#&gt; 13.98 were found as high frequency PMD. </span>
<span class="co">#&gt; 14.02 were found as high frequency PMD. </span>
<span class="co">#&gt; 14.05 were found as high frequency PMD. </span>
<span class="co">#&gt; 15.99 were found as high frequency PMD. </span>
<span class="co">#&gt; 16.03 were found as high frequency PMD. </span>
<span class="co">#&gt; 28.03 were found as high frequency PMD. </span>
<span class="co">#&gt; 30.05 were found as high frequency PMD. </span>
<span class="co">#&gt; 42.05 were found as high frequency PMD. </span>
<span class="co">#&gt; 49.02 were found as high frequency PMD. </span>
<span class="co">#&gt; 58.04 were found as high frequency PMD. </span>
<span class="co">#&gt; 66.05 were found as high frequency PMD. </span>
<span class="co">#&gt; 68.06 were found as high frequency PMD. </span>
<span class="co">#&gt; 82.08 were found as high frequency PMD. </span>
<span class="co">#&gt; 116.08 were found as high frequency PMD. </span>
<span class="co">#&gt; 126.14 were found as high frequency PMD.</span></code></pre></div>
</div>
<div id="shiny-application" class="section level2">
<h2 class="hasAnchor">
<a href="#shiny-application" class="anchor"></a>Shiny application</h2>
<p>An interactive document has been included in this package to show PMD analysis. You could run <code><a href="../reference/runPMD.html">runPMD()</a></code> to start the Graphical user interface(GUI) for GlobalStd algorithm and structure/reaction directed analysis. You need to prepare a csv file with m/z and retention time of peaks. Such csv file could be generated by run <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrtcsv">enviGCMS::getmzrtcsv()</a></code> on the <code>list</code> object from <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt">enviGCMS::getmzrt(xset)</a></code> or <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt2">enviGCMS::getmzrt2(xset)</a></code> function. You could also generate the csv file by <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt">enviGCMS::getmzrt(xset,name = 'test')</a></code> or <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt2">enviGCMS::getmzrt2(xset, name = 'test')</a></code>. You will find the csv file in the working dictionary named <code>test.csv</code>.</p>
</div>
<div id="conclusion" class="section level2">
<h2 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h2>
<p><code>pmd</code> package could be used to reduce the redundancy peaks for GC/LC-MS based research and perform structure/reaction directed analysis to screen known and unknown important compounds or reactions.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction-of-paired-mass-distance-analysis">Introduction of Paired Mass Distance analysis</a></li>
      <li><a href="#data-format">Data format</a></li>
      <li><a href="#globalstd-algorithm">GlobalStd algorithm</a></li>
      <li><a href="#structurereaction-directed-analysis">Structure/reaction directed analysis</a></li>
      <li><a href="#parameters-selection">Parameters selection</a></li>
      <li><a href="#wrap-function">Wrap function</a></li>
      <li><a href="#shiny-application">Shiny application</a></li>
      <li><a href="#conclusion">Conclusion</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Miao YU.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
