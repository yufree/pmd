<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis â€¢ pmd</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-58201304-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-58201304-1');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pmd</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/globalstd.html">Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis</h1>
                        <h4 class="author">Miao Yu</h4>
            
            <h4 class="date">2019-03-12</h4>
      
      
      <div class="hidden name"><code>globalstd.Rmd</code></div>

    </div>

    
    
<div id="introduction-of-paired-mass-distance-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction-of-paired-mass-distance-analysis" class="anchor"></a>Introduction of Paired Mass Distance analysis</h2>
<p><code>pmd</code> package use Paired Mass Distance (PMD) relationship to analysis the GC/LC-MS based non-targeted data. PMD means the distance between two masses or mass to charge ratios. In mass spectrometry, PMD would keep the same between two masses or two mass to charge ratios(m/z). There are twe kinds of PMD involved in this package: PMD within same retention time group and PMD from different retention time groups.</p>
<div id="pmd-within-same-retention-time-group" class="section level3">
<h3 class="hasAnchor">
<a href="#pmd-within-same-retention-time-group" class="anchor"></a>PMD within same retention time group</h3>
<p>In GC/LC-MS based non-targeted analysis, peaks could be seperated by chromatograph. We could build retention time(RT) bins to assign peaks into different RT groups by retention time hierarchical clustering analysis. For each RT group, the peaks should come from same compounds or co-elutes. If certain PMD appeared in multiple RT groups, it would be related to the relationship about adducts, neutral loss, isotopologues or commen fragments ions.</p>
</div>
<div id="pmd-from-different-retention-time-groups" class="section level3">
<h3 class="hasAnchor">
<a href="#pmd-from-different-retention-time-groups" class="anchor"></a>PMD from different retention time groups</h3>
<p>The peaks from different retention time groups would like to be different compounds seperated by chromatograph. The PMD would reflect the relationship about homologous series or chemical reactions.</p>
<p>GlobalStd algorithm use the PMD within same RT group to find independent peaks among certain dataset. Structure/reaction directed analysis use PMD from different RT groups to screen important compounds or reactions.</p>
</div>
</div>
<div id="data-format" class="section level2">
<h2 class="hasAnchor">
<a href="#data-format" class="anchor"></a>Data format</h2>
<p>The input data should be a <code>list</code> object with at least two elements from a peaks list:</p>
<ul>
<li>mass to charge ratio with name of <code>mz</code>, high resolution mass spectrometry is required</li>
<li>retention time with name of <code>rt</code>
</li>
</ul>
<p>However, I suggested to add intensity and group information to the list for validation of PMD analysis.</p>
<p>In this package, a dataset from <em>in vivo</em> solid phase micro-extraction(SPME) was attached. This dataset contain 9 samples from 3 fish with triplicates samples for each fish. Here is the data strcture:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(pmd)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"spmeinvivo"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(spmeinvivo)
<span class="co">#&gt; List of 4</span>
<span class="co">#&gt;  $ data : num [1:1459, 1:9] 1095 10439 10154 2797 90211 ...</span>
<span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span>
<span class="co">#&gt;   .. ..$ : chr [1:1459] "100.1/170" "100.5/86" "101/85" "103.1/348" ...</span>
<span class="co">#&gt;   .. ..$ : chr [1:9] "1405_Fish1_F1" "1405_Fish1_F2" "1405_Fish1_F3" "1405_Fish2_F1" ...</span>
<span class="co">#&gt;  $ group:'data.frame':   9 obs. of  1 variable:</span>
<span class="co">#&gt;   ..$ class: Factor w/ 3 levels "fish1","fish2",..: 1 1 1 2 2 2 3 3 3</span>
<span class="co">#&gt;  $ mz   : num [1:1459] 100 101 101 103 104 ...</span>
<span class="co">#&gt;  $ rt   : num [1:1459] 170.2 86.3 84.9 348.1 48.8 ...</span></code></pre></div>
<p>You could build this <code>list</code> object from the <code>xcms</code> objects via <code>enviGCMS</code> package. When you have a <code>xcmsSet</code> object or <code>XCMSnExp</code> object named <code>xset</code>, you could use <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt">enviGCMS::getmzrt(xset)</a></code> or <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt2">enviGCMS::getmzrt2(xset)</a></code> to get such list. Of course you could build such list by yourself.</p>
</div>
<div id="globalstd-algorithm" class="section level2">
<h2 class="hasAnchor">
<a href="#globalstd-algorithm" class="anchor"></a>GlobalStd algorithm</h2>
<p>GlobalStd algorithm try to find independent peaks among certain peaks list. The first step is retention time hierarchical clustering analysis. The second step is to find the relationship among adducts, neutral loss, isotopologues and commen fragments ions. The third step is to screen the independent peaks.</p>
<div id="retention-time-hierarchical-clustering" class="section level3">
<h3 class="hasAnchor">
<a href="#retention-time-hierarchical-clustering" class="anchor"></a>Retention time hierarchical clustering</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pmd &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getpaired.html">getpaired</a></span>(spmeinvivo, <span class="dt">rtcutoff =</span> <span class="dv">10</span>, <span class="dt">ng =</span> <span class="dv">10</span>)
<span class="co">#&gt; 75 retention time cluster found.</span>
<span class="co">#&gt; 435 paired masses found</span>
<span class="co">#&gt; 10 unique PMD(s) used for further investigation.</span>
<span class="co">#&gt; 583 isotopologue(s) related paired mass found.</span>
<span class="co">#&gt; 685 multi-charger(s) related paired mass found.</span>
<span class="kw"><a href="../reference/plotrtg.html">plotrtg</a></span>(pmd)</code></pre></div>
<p><img src="globalstd_files/figure-html/rtg-1.png" width="700"></p>
<p>This plot would show the distribution of RT groups. The <code>rtcutoff</code> in function <code>getpaired</code> could be used to set the cutoff of the distances in retention time hierarchical clustering analysis.</p>
</div>
<div id="relationship-among-adducts-neutral-loss-isotopologues-and-commen-fragments-ions" class="section level3">
<h3 class="hasAnchor">
<a href="#relationship-among-adducts-neutral-loss-isotopologues-and-commen-fragments-ions" class="anchor"></a>Relationship among adducts, neutral loss, isotopologues and commen fragments ions</h3>
<p>The <code>ng</code> in function <code>getpaired</code> could be used to set cutoff of global PMDâ€™s retention time group numbers. If <code>ng</code> is 10, at least 10 of the retention time groups should contain the shown PMD relationship. You could use <code>plotpaired</code> to show the distribution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotpaired.html">plotpaired</a></span>(pmd)</code></pre></div>
<p><img src="globalstd_files/figure-html/pmd-1.png" width="700"></p>
<p>You could also show the distribution of PMD relationship by index:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># show the unique PMD found by getpaired function</span>
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(pmd<span class="op">$</span>paired<span class="op">$</span>diff2))){
        diff &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(pmd<span class="op">$</span>paired<span class="op">$</span>diff2)[i]
        index &lt;-<span class="st"> </span>pmd<span class="op">$</span>paired<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span>diff
        <span class="kw"><a href="../reference/plotpaired.html">plotpaired</a></span>(pmd,index)
}</code></pre></div>
<p><img src="globalstd_files/figure-html/pmdindex-1.png" width="700"><img src="globalstd_files/figure-html/pmdindex-2.png" width="700"><img src="globalstd_files/figure-html/pmdindex-3.png" width="700"><img src="globalstd_files/figure-html/pmdindex-4.png" width="700"><img src="globalstd_files/figure-html/pmdindex-5.png" width="700"><img src="globalstd_files/figure-html/pmdindex-6.png" width="700"><img src="globalstd_files/figure-html/pmdindex-7.png" width="700"><img src="globalstd_files/figure-html/pmdindex-8.png" width="700"><img src="globalstd_files/figure-html/pmdindex-9.png" width="700"><img src="globalstd_files/figure-html/pmdindex-10.png" width="700"></p>
</div>
<div id="screen-the-independent-peaks" class="section level3">
<h3 class="hasAnchor">
<a href="#screen-the-independent-peaks" class="anchor"></a>Screen the independent peaks</h3>
<p>You could use <code>getstd</code> function to get the independent peaks.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">std &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getstd.html">getstd</a></span>(pmd)
<span class="co">#&gt; 11 group(s) with multiple peaks while no isotope/paired relationship</span>
<span class="co">#&gt; 8 group(s) with multiple peaks with isotope without paired relationship</span>
<span class="co">#&gt; 4 group(s) with paired relationship without isotope</span>
<span class="co">#&gt; 44 group(s) with paired relationship and isotope</span>
<span class="co">#&gt; 257 std mass found.</span>
<span class="co">#&gt; 8 retention group(s) have single peaks.</span></code></pre></div>
<p>Here you could plot the peaks by <code>plotstd</code> function to show the distribution of independent peaks:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotstd.html">plotstd</a></span>(std)</code></pre></div>
<p><img src="globalstd_files/figure-html/stdplot-1.png" width="700"></p>
<p>You could also plot the peaks distribution by assign a retention time group via <code>plotstdrt</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>,<span class="dv">3</span>))
<span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">23</span>,<span class="dt">main =</span> <span class="st">'Retention time group 23'</span>)
<span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">9</span>,<span class="dt">main =</span> <span class="st">'Retention time group 9'</span>)
<span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">18</span>,<span class="dt">main =</span> <span class="st">'Retention time group 18'</span>)
<span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">67</span>,<span class="dt">main =</span> <span class="st">'Retention time group 67'</span>)
<span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">49</span>,<span class="dt">main =</span> <span class="st">'Retention time group 49'</span>)
<span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">6</span>,<span class="dt">main =</span> <span class="st">'Retention time group 6'</span>)</code></pre></div>
<p><img src="globalstd_files/figure-html/stdrtplot-1.png" width="700"></p>
</div>
<div id="use-independent-peaks-for-msms-validation" class="section level3">
<h3 class="hasAnchor">
<a href="#use-independent-peaks-for-msms-validation" class="anchor"></a>Use independent peaks for MS/MS validation</h3>
<p>Independent peaks are supporsing generated from different compounds. We could use those peaks for MS/MS analysis instead of DIA or DDA. Here we need multiple injections for one sample since it might be impossible to get all ionsâ€™ fragmental ions in one injection with good sensitivity. You could use <code>gettarget</code> to generate the index for the injections and output the peaks for each run.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># you need retention time for independent peaks</span>
index &lt;-<span class="st"> </span><span class="kw"><a href="../reference/gettarget.html">gettarget</a></span>(std<span class="op">$</span>rt[std<span class="op">$</span>stdmassindex])
<span class="co">#&gt; You need 6 injections!</span>
<span class="co"># output the ions for each injection</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/table">table</a></span>(index)
<span class="co">#&gt; index</span>
<span class="co">#&gt;  1  2  3  4  5  6 </span>
<span class="co">#&gt; 39 60 53 26 37 42</span>
<span class="co"># show the ions for the first injection</span>
std<span class="op">$</span>mz[index<span class="op">==</span><span class="dv">1</span>]
<span class="co">#&gt;   [1] 100.5107 100.9572 106.9509 132.0050 136.4826 139.9877 140.0688</span>
<span class="co">#&gt;   [8] 140.9956 145.9553 147.1175 155.1294 155.1295 156.0426 156.1777</span>
<span class="co">#&gt;  [15] 157.0842 162.0552 163.0758 164.1517 166.0867 168.0923 173.1335</span>
<span class="co">#&gt;  [22] 174.0392 174.9728 174.9917 175.1200 183.0809 188.6484 192.1487</span>
<span class="co">#&gt;  [29] 193.1597 195.1027 195.1138 209.6639 217.1483 219.2107 223.2068</span>
<span class="co">#&gt;  [36] 226.1823 234.0200 236.1626 242.2863 247.2421 248.0592 251.0008</span>
<span class="co">#&gt;  [43] 259.1810 262.1453 265.4216 266.1739 267.0639 268.1893 269.0888</span>
<span class="co">#&gt;  [50] 270.3185 270.3185 270.3185 270.3185 270.3185 272.3230 272.9318</span>
<span class="co">#&gt;  [57] 273.1854 274.9319 277.1896 282.2811 282.2811 283.2838 283.2841</span>
<span class="co">#&gt;  [64] 284.2955 286.3104 293.2853 296.2961 297.2985 300.2046 301.2899</span>
<span class="co">#&gt;  [71] 309.0913 312.0163 313.2741 317.9344 318.8919 327.3449 328.8778</span>
<span class="co">#&gt;  [78] 335.2953 340.2606 340.2604 340.7613 352.3592 355.3391 359.0292</span>
<span class="co">#&gt;  [85] 359.3151 360.3230 362.9280 364.3575 367.3375 367.3373 368.3395</span>
<span class="co">#&gt;  [92] 369.3534 370.3567 377.3224 377.8991 379.2844 381.1324 383.3313</span>
<span class="co">#&gt;  [99] 387.2851 387.3532 390.2553 391.2835 392.3131 399.3940 401.3421</span>
<span class="co">#&gt; [106] 404.2889 405.8957 407.3384 409.1624 418.3398 426.2189 428.3378</span>
<span class="co">#&gt; [113] 429.8709 430.0895 438.2669 441.3330 446.8878 457.3299 460.3112</span>
<span class="co">#&gt; [120] 463.1472 492.8839 494.8112 499.9050 500.3789 500.9073 502.3382</span>
<span class="co">#&gt; [127] 503.3667 512.4158 514.8764 516.3893 518.3245 520.1386 527.2976</span>
<span class="co">#&gt; [134] 528.4989 532.3865 533.9698 537.3405 541.1208 541.3942 542.3991</span>
<span class="co">#&gt; [141] 543.1198 543.4015 558.0957 560.2193 562.1811 564.1885 565.3827</span>
<span class="co">#&gt; [148] 566.1776 579.1247 585.4215 589.5800 594.1590 594.3765 608.4285</span>
<span class="co">#&gt; [155] 612.1849 621.4195 637.3048 638.2008 639.8539 660.3160 665.4606</span>
<span class="co">#&gt; [162] 673.8481 675.2109 675.5084 676.8604 678.6868 685.2035 685.3464</span>
<span class="co">#&gt; [169] 690.3683 691.4631 692.4941 702.6369 703.1383 703.3651 704.1390</span>
<span class="co">#&gt; [176] 707.8415 711.3532 712.2190 715.5204 716.5241 719.2988 735.4900</span>
<span class="co">#&gt; [183] 738.5066 745.3469 750.7856 753.5196 757.8509 772.5904 779.3404</span>
<span class="co">#&gt; [190] 781.8130 787.5110 787.8267 800.6217 802.7995 813.3338 832.8212</span>
<span class="co">#&gt; [197] 833.8251 836.6816 859.8318 864.3202 871.3033 872.3052 872.4203</span>
<span class="co">#&gt; [204] 873.3343 874.3049 883.7184 884.1633 884.8301 888.6729 889.4890</span>
<span class="co">#&gt; [211] 906.8283 907.3250 907.8274 911.8014 917.7920 929.4891 929.8218</span>
<span class="co">#&gt; [218] 934.8077 937.8098 939.7749 950.1442 964.7811 974.8148 975.8147</span>
<span class="co">#&gt; [225] 979.7901 982.7763</span>
std<span class="op">$</span>rt[index<span class="op">==</span><span class="dv">1</span>]
<span class="co">#&gt;   [1]  86.3490  84.8510 216.1970  49.4910 144.8960  84.8490 212.7160</span>
<span class="co">#&gt;   [8]  86.3490  85.3855 611.4110 804.4690 785.8260 218.6020 405.3890</span>
<span class="co">#&gt;  [15] 169.3150 511.2940 576.9100 613.1260 348.1340 511.2940 611.4120</span>
<span class="co">#&gt;  [22] 216.6520 145.5380 166.2500 260.8720 533.7950 639.2075 611.4120</span>
<span class="co">#&gt;  [29] 614.2000 538.0810 169.9680 639.5280 638.8870 639.1010 639.1000</span>
<span class="co">#&gt;  [36] 611.4120 169.9670 430.6770 880.3730 639.0995 467.4715 509.7940</span>
<span class="co">#&gt;  [43] 890.9790 491.1510 145.8285 612.6975 568.7680 452.5345 161.3960</span>
<span class="co">#&gt;  [50] 604.7690 838.9070 767.5050 670.2425 802.2200 785.9345 145.7540</span>
<span class="co">#&gt;  [57] 581.1950 144.2530 439.6780 639.1000 594.9100 595.2325 639.3120</span>
<span class="co">#&gt;  [64] 613.7700 696.9585 618.2710 639.1000 639.3130 172.2230 594.9120</span>
<span class="co">#&gt;  [71] 568.7680 212.8675 587.3035 145.5170 143.6480 647.4575 144.2610</span>
<span class="co">#&gt;  [78] 582.6960 340.8480 171.4335 172.7590 648.9580 594.4820 717.0520</span>
<span class="co">#&gt;  [85] 612.4820 639.0980 213.9270 616.7710 644.2420 585.2700 644.2430</span>
<span class="co">#&gt;  [92] 688.3880 688.3880 594.6960 145.1090 573.0530 447.8210 656.0300</span>
<span class="co">#&gt;  [99] 492.8650 644.6705 383.3190 665.0280 567.4840 595.0195 632.8410</span>
<span class="co">#&gt; [106] 570.2670 144.8700 556.9840 482.4185 582.2680 601.1275 547.1240</span>
<span class="co">#&gt; [113] 145.2170 717.1010 639.3140 656.0280 215.6320 582.0530 169.9670</span>
<span class="co">#&gt; [120] 717.0775 213.7130 803.7190 213.9270 422.9630 213.9570 511.5080</span>
<span class="co">#&gt; [127] 532.1220 550.3385 215.7020 540.8620 495.3295 762.5750 493.5080</span>
<span class="co">#&gt; [134] 643.4925 537.2240 639.2075 537.2230 762.5770 439.6770 439.6780</span>
<span class="co">#&gt; [141] 762.7890 439.2500 762.6835 340.9965 762.3630 762.5770 439.2500</span>
<span class="co">#&gt; [148] 762.5770 819.9415 434.7490 889.0520 819.4070 561.2680 613.3395</span>
<span class="co">#&gt; [155] 818.7650 454.9350 630.7000 819.1920 214.1780 448.2490 800.2900</span>
<span class="co">#&gt; [162] 214.3560 819.5135 468.2215 214.3560 639.1000 883.1575 215.9255</span>
<span class="co">#&gt; [169] 213.1890 525.0090 528.2230 639.1000 639.0990 213.5480 639.1000</span>
<span class="co">#&gt; [176] 214.2010 215.2290 883.6945 481.0790 481.0790 365.5325 522.2240</span>
<span class="co">#&gt; [183] 481.2930 215.2830 217.4155 522.2240 213.2940 624.2700 214.9615</span>
<span class="co">#&gt; [190] 215.0690 692.6730 215.7020 642.9965 216.6375 214.9295 213.7130</span>
<span class="co">#&gt; [197] 214.0170 646.6000 213.3840 639.2070 639.2070 639.0990 472.0790</span>
<span class="co">#&gt; [204] 213.5480 638.7790 632.1990 213.5090 213.5140 632.3055 213.6405</span>
<span class="co">#&gt; [211] 213.7270 213.5480 213.7720 214.0170 215.2080 213.3110 213.3340</span>
<span class="co">#&gt; [218] 213.8030 213.4465 215.9885 213.3340 215.6320 213.7130 213.7270</span>
<span class="co">#&gt; [225] 213.9410 640.2780</span></code></pre></div>
</div>
<div id="validation-by-principal-components-analysispca" class="section level3">
<h3 class="hasAnchor">
<a href="#validation-by-principal-components-analysispca" class="anchor"></a>Validation by principal components analysis(PCA)</h3>
<p>You need to check the GlobalStd algorithmâ€™s results by principal components analysis(PCA).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(enviGCMS)
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data,<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(std<span class="op">$</span>group<span class="op">$</span>class),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(all peaks)"</span>)))
<span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data[std<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(std<span class="op">$</span>group<span class="op">$</span>class),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))</code></pre></div>
<p><img src="globalstd_files/figure-html/pca-1.png" width="700"></p>
</div>
<div id="comparision-with-other-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#comparision-with-other-packages" class="anchor"></a>Comparision with other packages</h3>
<p>GlobalStd algorithm in <code>pmd</code> package could be treated as a way to extract pseudospectra. You could use <code>getcluster</code> to get peaks groups information for all GlobalStd peaks. Then you could choose export peaks with the highest intensities in each GlobalStd peaks groups.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stdcluster &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getcluster.html">getcluster</a></span>(std)
<span class="co"># extract pseudospectra for std peak 1</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(stdcluster<span class="op">$</span>cluster<span class="op">$</span>stdmassg[stdcluster<span class="op">$</span>cluster<span class="op">$</span>i<span class="op">==</span><span class="dv">42</span>],stdcluster<span class="op">$</span>cluster<span class="op">$</span>ins[stdcluster<span class="op">$</span>cluster<span class="op">$</span>i<span class="op">==</span><span class="dv">42</span>],<span class="dt">type =</span> <span class="st">'h'</span>,<span class="dt">xlab =</span> <span class="st">'m/z'</span>,<span class="dt">ylab =</span> <span class="st">'intensity'</span>,<span class="dt">main =</span> <span class="st">'pseudospectra for GlobalStd peak 42'</span>)</code></pre></div>
<p><img src="globalstd_files/figure-html/comp-1.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># export peaks with the highest intensities in each GlobalStd peaks groups.</span>
data &lt;-<span class="st"> </span>stdcluster<span class="op">$</span>data[stdcluster<span class="op">$</span>stdmassindex2,]</code></pre></div>
<p>You could also use <code>getcorcluster</code> to find peaks groups by correlation analysis only.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">corcluster &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getcorcluster.html">getcorcluster</a></span>(spmeinvivo)
<span class="co">#&gt; 75 retention time cluster found.</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data,<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(std<span class="op">$</span>group<span class="op">$</span>class),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(all peaks)"</span>)))
<span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data[std<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(std<span class="op">$</span>group<span class="op">$</span>class),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))
<span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data[corcluster<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(std<span class="op">$</span>group<span class="op">$</span>class),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks by correlationship)"</span>)))</code></pre></div>
<p><img src="globalstd_files/figure-html/corcomp-1.png" width="700"></p>
</div>
<div id="globalstd-algorithm-with-intensity-data" class="section level3">
<h3 class="hasAnchor">
<a href="#globalstd-algorithm-with-intensity-data" class="anchor"></a>GlobalStd algorithm with intensity data</h3>
<p>GlobalStd algorithm is designed to analysis data without intensity data. However, if you have intensity data, the independant peaks could be selected with more confindence. You could set up cutoff of Pearson Correlation Coefficient between peaks to refine the peaks selected by GlobalStd within same retention time groups.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">std2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getstd.html">getstd</a></span>(pmd,<span class="dt">corcutoff =</span> <span class="fl">0.9</span>)
<span class="co">#&gt; 24 group(s) with multiple peaks while no isotope/paired relationship</span>
<span class="co">#&gt; 12 group(s) with multiple peaks with isotope without paired relationship</span>
<span class="co">#&gt; 3 group(s) with paired relationship without isotope</span>
<span class="co">#&gt; 28 group(s) with paired relationship and isotope</span>
<span class="co">#&gt; 116 std mass found.</span>
<span class="co">#&gt; 8 retention group(s) have single peaks.</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std2<span class="op">$</span>data,<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(std2<span class="op">$</span>group<span class="op">$</span>class),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(all peaks)"</span>)))
<span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data[std<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(std<span class="op">$</span>group<span class="op">$</span>class),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))
<span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std2<span class="op">$</span>data[std2<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(std2<span class="op">$</span>group<span class="op">$</span>class),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))</code></pre></div>
<p><img src="globalstd_files/figure-html/globalcor-1.png" width="700"></p>
</div>
</div>
<div id="structurereaction-directed-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#structurereaction-directed-analysis" class="anchor"></a>Structure/reaction directed analysis</h2>
<p><code>getsda</code> function could be used to perform Structure/reaction directed analysis. <code>freqcutoff</code> could be used to filter the PMD with high frequncy.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sda &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getsda.html">getsda</a></span>(std, <span class="dt">freqcutoff =</span> <span class="dv">10</span>)
<span class="co">#&gt; Top 50 high frequency PMD groups were remained.</span>
<span class="co">#&gt; 18 groups were found as high frequency PMD group.</span>
<span class="co">#&gt; 0 were found as high frequency PMD. </span>
<span class="co">#&gt; 1.98 were found as high frequency PMD. </span>
<span class="co">#&gt; 2.02 were found as high frequency PMD. </span>
<span class="co">#&gt; 13.98 were found as high frequency PMD. </span>
<span class="co">#&gt; 14.02 were found as high frequency PMD. </span>
<span class="co">#&gt; 14.05 were found as high frequency PMD. </span>
<span class="co">#&gt; 15.99 were found as high frequency PMD. </span>
<span class="co">#&gt; 16.03 were found as high frequency PMD. </span>
<span class="co">#&gt; 28.03 were found as high frequency PMD. </span>
<span class="co">#&gt; 30.05 were found as high frequency PMD. </span>
<span class="co">#&gt; 42.05 were found as high frequency PMD. </span>
<span class="co">#&gt; 49.02 were found as high frequency PMD. </span>
<span class="co">#&gt; 58.04 were found as high frequency PMD. </span>
<span class="co">#&gt; 66.05 were found as high frequency PMD. </span>
<span class="co">#&gt; 68.06 were found as high frequency PMD. </span>
<span class="co">#&gt; 82.08 were found as high frequency PMD. </span>
<span class="co">#&gt; 116.08 were found as high frequency PMD. </span>
<span class="co">#&gt; 126.14 were found as high frequency PMD.</span></code></pre></div>
<p>You could use <code>plotstdsda</code> to show the distribution of the selected paired peaks.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda)</code></pre></div>
<p><img src="globalstd_files/figure-html/stdsda-1.png" width="700"></p>
<p>You could also use index to show the distribution of certain PMDs.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>,<span class="dv">3</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)
<span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)
<span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">13.98</span>)
<span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">15.99</span>)
<span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">14.02</span>)
<span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">28.03</span>)
<span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">58.04</span>)</code></pre></div>
<p><img src="globalstd_files/figure-html/stdsdaidx-1.png" width="700"></p>
<p>Structure/reaction directed analysis could be directily performed on all the peaks, which is slow to process:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sdaall &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getsda.html">getsda</a></span>(spmeinvivo)
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>,<span class="dv">3</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)
<span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)
<span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">13.98</span>)
<span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">15.99</span>)
<span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">14.02</span>)
<span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">28.03</span>)
<span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">58.04</span>)</code></pre></div>
<div id="structurereaction-directed-analysis-for-peakscompounds-only" class="section level3">
<h3 class="hasAnchor">
<a href="#structurereaction-directed-analysis-for-peakscompounds-only" class="anchor"></a>Structure/reaction directed analysis for peaks/compounds only</h3>
<p>When you only have data of peaks without retention time or compounds list, structure/reaction directed analysis could also be done by <code>getrda</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sda &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getrda.html">getrda</a></span>(spmeinvivo<span class="op">$</span>mz[std<span class="op">$</span>stdmassindex])</code></pre></div>
</div>
</div>
<div id="parameters-selection" class="section level2">
<h2 class="hasAnchor">
<a href="#parameters-selection" class="anchor"></a>Parameters selection</h2>
<p>Retention time cluster cutoff should fit the peak picking algorithm. For HPLC, 10 is suggested and 5 could be used for UPLC.</p>
<p>Global PMDâ€™s retention time group numbers should be around 20 percent of the retention time cluster numbers. For example, if you find 100 retention time clusters, I suggested you use 20 as the empirical global PMDâ€™s retention time group numbers.</p>
<p>As for the cutoff of the frequency of PMDs, you could change the frequency until you find certain PMD which youâ€™re sure that it should appear in your dataset. For example, 16 should be considered as a good start. Any pmd with the frequency larger than PMD 16 could be further discussed.</p>
<p>Another important hint is that pre-filter your peak list by black samples or other quality control samples. Otherwise the running time would be long and lots of pmd relationship would be just from noise.</p>
</div>
<div id="wrap-function" class="section level2">
<h2 class="hasAnchor">
<a href="#wrap-function" class="anchor"></a>Wrap function</h2>
<p><code>globalstd</code> function is a wrap funtion to process GlobalStd algorithm and structure/reaction directed analysis in one line. All the plot function could be directly used on the <code>list</code> objects from <code>globalstd</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">result &lt;-<span class="st"> </span><span class="kw"><a href="../reference/globalstd.html">globalstd</a></span>(spmeinvivo)
<span class="co">#&gt; 75 retention time cluster found.</span>
<span class="co">#&gt; 435 paired masses found</span>
<span class="co">#&gt; 10 unique PMD(s) used for further investigation.</span>
<span class="co">#&gt; 583 isotopologue(s) related paired mass found.</span>
<span class="co">#&gt; 685 multi-charger(s) related paired mass found.</span>
<span class="co">#&gt; 11 group(s) with multiple peaks while no isotope/paired relationship</span>
<span class="co">#&gt; 8 group(s) with multiple peaks with isotope without paired relationship</span>
<span class="co">#&gt; 4 group(s) with paired relationship without isotope</span>
<span class="co">#&gt; 44 group(s) with paired relationship and isotope</span>
<span class="co">#&gt; 257 std mass found.</span>
<span class="co">#&gt; 8 retention group(s) have single peaks.</span>
<span class="co">#&gt; Top 50 high frequency PMD groups were remained.</span>
<span class="co">#&gt; 18 groups were found as high frequency PMD group.</span>
<span class="co">#&gt; 0 were found as high frequency PMD. </span>
<span class="co">#&gt; 1.98 were found as high frequency PMD. </span>
<span class="co">#&gt; 2.02 were found as high frequency PMD. </span>
<span class="co">#&gt; 13.98 were found as high frequency PMD. </span>
<span class="co">#&gt; 14.02 were found as high frequency PMD. </span>
<span class="co">#&gt; 14.05 were found as high frequency PMD. </span>
<span class="co">#&gt; 15.99 were found as high frequency PMD. </span>
<span class="co">#&gt; 16.03 were found as high frequency PMD. </span>
<span class="co">#&gt; 28.03 were found as high frequency PMD. </span>
<span class="co">#&gt; 30.05 were found as high frequency PMD. </span>
<span class="co">#&gt; 42.05 were found as high frequency PMD. </span>
<span class="co">#&gt; 49.02 were found as high frequency PMD. </span>
<span class="co">#&gt; 58.04 were found as high frequency PMD. </span>
<span class="co">#&gt; 66.05 were found as high frequency PMD. </span>
<span class="co">#&gt; 68.06 were found as high frequency PMD. </span>
<span class="co">#&gt; 82.08 were found as high frequency PMD. </span>
<span class="co">#&gt; 116.08 were found as high frequency PMD. </span>
<span class="co">#&gt; 126.14 were found as high frequency PMD.</span></code></pre></div>
</div>
<div id="shiny-application" class="section level2">
<h2 class="hasAnchor">
<a href="#shiny-application" class="anchor"></a>Shiny application</h2>
<p>An interactive document has been included in this package to show PMD analysis. You could run <code><a href="../reference/runPMD.html">runPMD()</a></code> to start the Graphical user interface(GUI) for GlobalStd algorithm and structure/reaction directed analysis. You need to prepare a csv file with m/z and retention time of peaks. Such csv file could be generated by run <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrtcsv">enviGCMS::getmzrtcsv()</a></code> on the <code>list</code> object from <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt">enviGCMS::getmzrt(xset)</a></code> or <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt2">enviGCMS::getmzrt2(xset)</a></code> function. You could also generate the csv file by <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt">enviGCMS::getmzrt(xset,name = 'test')</a></code> or <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt2">enviGCMS::getmzrt2(xset, name = 'test')</a></code>. You will find the csv file in the working dictionary named <code>test.csv</code>.</p>
</div>
<div id="conclusion" class="section level2">
<h2 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h2>
<p><code>pmd</code> package could be used to reduce the redundancy peaks for GC/LC-MS based research and perform structure/reaction directed analysis to screen known and unknown important compounds or reactions.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction-of-paired-mass-distance-analysis">Introduction of Paired Mass Distance analysis</a></li>
      <li><a href="#data-format">Data format</a></li>
      <li><a href="#globalstd-algorithm">GlobalStd algorithm</a></li>
      <li><a href="#structurereaction-directed-analysis">Structure/reaction directed analysis</a></li>
      <li><a href="#parameters-selection">Parameters selection</a></li>
      <li><a href="#wrap-function">Wrap function</a></li>
      <li><a href="#shiny-application">Shiny application</a></li>
      <li><a href="#conclusion">Conclusion</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Miao YU.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
