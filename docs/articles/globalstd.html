<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis • pmd</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis">
<meta property="og:description" content="pmd">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-58201304-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-58201304-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pmd</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/globalstd.html">Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis</a>
    </li>
    <li>
      <a href="../articles/reactomics.html">Reactomics</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/yufree/pmd/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis</h1>
                        <h4 class="author">Miao Yu</h4>
            
            <h4 class="date">2020-08-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/yufree/pmd/blob/master/vignettes/globalstd.Rmd"><code>vignettes/globalstd.Rmd</code></a></small>
      <div class="hidden name"><code>globalstd.Rmd</code></div>

    </div>

    
    
<div id="introduction-of-paired-mass-distance-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction-of-paired-mass-distance-analysis" class="anchor"></a>Introduction of Paired Mass Distance analysis</h2>
<p><code>pmd</code> package use Paired Mass Distance (PMD) relationship to analysis the GC/LC-MS based non-targeted data. PMD means the distance between two masses or mass to charge ratios. In mass spectrometry, PMD would keep the same value between two masses and two mass to charge ratios(m/z). There are two kinds of PMD involved in this package: PMD from the same compound and PMD from different compounds. In GC/LC-MS or XCMS based non-targeted data analysis, peaks could be separated by chronograph and same compound means ions from similar retention times or ions co-eluted by certain column.</p>
<div id="pmd-from-the-same-compound" class="section level3">
<h3 class="hasAnchor">
<a href="#pmd-from-the-same-compound" class="anchor"></a>PMD from the same compound</h3>
<p>For MS1 full scan data, we could build retention time(RT) bins to assign peaks into different RT groups by retention time hierarchical clustering analysis. For each RT group, the peaks should come from same compounds or co-elutes. If certain PMD appeared in multiple RT groups, it would be related to the relationship about adducts, neutral loss, isotopologues or common fragments ions.</p>
</div>
<div id="pmd-from-different-compounds" class="section level3">
<h3 class="hasAnchor">
<a href="#pmd-from-different-compounds" class="anchor"></a>PMD from different compounds</h3>
<p>The peaks from different retention time groups would like to be different compounds separated by chronograph. The PMD would reflect the relationship about homologous series or chemical reactions.</p>
<p>GlobalStd algorithm use the PMD within same RT group to find independent peaks among certain data set. Then, structure/reaction directed analysis use PMD from different RT groups to screen important compounds or reactions.</p>
</div>
</div>
<div id="data-format" class="section level2">
<h2 class="hasAnchor">
<a href="#data-format" class="anchor"></a>Data format</h2>
<p>The input data should be a <code>list</code> object with at least two elements from a peaks list:</p>
<ul>
<li>mass to charge ratio with name of <code>mz</code>, high resolution mass spectrometry is required</li>
<li>retention time with name of <code>rt</code>
</li>
</ul>
<p>However, I suggested to add intensity and group information to the list for validation of PMD analysis.</p>
<p>In this package, a data set from <em>in vivo</em> solid phase micro-extraction(SPME) was attached. This data set contain 9 samples from 3 fish with triplicates samples for each fish. Here is the data structure:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pmd</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"spmeinvivo"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">spmeinvivo</span>)
<span class="co">#&gt; List of 4</span>
<span class="co">#&gt;  $ data : num [1:1459, 1:9] 1095 10439 10154 2797 90211 ...</span>
<span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span>
<span class="co">#&gt;   .. ..$ : chr [1:1459] "100.1/170" "100.5/86" "101/85" "103.1/348" ...</span>
<span class="co">#&gt;   .. ..$ : chr [1:9] "1405_Fish1_F1" "1405_Fish1_F2" "1405_Fish1_F3" "1405_Fish2_F1" ...</span>
<span class="co">#&gt;  $ group:'data.frame':   9 obs. of  2 variables:</span>
<span class="co">#&gt;   ..$ sample_name : chr [1:9] "1405_Fish1_F1" "1405_Fish1_F2" "1405_Fish1_F3" "1405_Fish2_F1" ...</span>
<span class="co">#&gt;   ..$ sample_group: chr [1:9] "fish1" "fish1" "fish1" "fish2" ...</span>
<span class="co">#&gt;  $ mz   : num [1:1459] 100 101 101 103 104 ...</span>
<span class="co">#&gt;  $ rt   : num [1:1459] 170.2 86.3 84.9 348.1 48.8 ...</span></pre></body></html></div>
<p>You could build this <code>list</code> object from the <code>xcms</code> objects via <code>enviGCMS</code> package. When you have a <code>xcmsSet</code> object or <code>XCMSnExp</code> object named <code>xset</code>, you could use <code><a href="https://rdrr.io/pkg/enviGCMS/man/getmzrt.html">enviGCMS::getmzrt(xset)</a></code> or <code><a href="https://rdrr.io/pkg/enviGCMS/man/getmzrt2.html">enviGCMS::getmzrt2(xset)</a></code> to get such list. Of course you could build such list by yourself.</p>
</div>
<div id="globalstd-algorithm" class="section level2">
<h2 class="hasAnchor">
<a href="#globalstd-algorithm" class="anchor"></a>GlobalStd algorithm</h2>
<p>GlobalStd algorithm try to find independent peaks among certain peaks list. The first step is retention time hierarchical clustering analysis. The second step is to find the relationship among adducts, neutral loss, isotopologues and common fragments ions. The third step is to screen the independent peaks.</p>
<p>Here is a workflow for this algorithm:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="kw pkg">knitr</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span>(<span class="st">'https://yufree.github.io/presentation/figure/GlobalStd.png'</span>)</pre></body></html></div>
<p><img src="https://yufree.github.io/presentation/figure/GlobalStd.png"><!-- --></p>
<div id="step1-retention-time-hierarchical-clustering" class="section level3">
<h3 class="hasAnchor">
<a href="#step1-retention-time-hierarchical-clustering" class="anchor"></a>STEP1: Retention time hierarchical clustering</h3>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">pmd</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/getpaired.html">getpaired</a></span>(<span class="no">spmeinvivo</span>, <span class="kw">rtcutoff</span> <span class="kw">=</span> <span class="fl">10</span>, <span class="kw">ng</span> <span class="kw">=</span> <span class="fl">10</span>)
<span class="co">#&gt; 75 retention time cluster found.</span>
<span class="co">#&gt; 380 paired masses found</span>
<span class="co">#&gt; 9 unique within RT clusters high frequency PMD(s) used for further investigation.</span>
<span class="co">#&gt; 719 isotopologue(s) related paired mass found.</span>
<span class="co">#&gt; 492 multi-charger(s) related paired mass found.</span>
<span class="fu"><a href="../reference/plotrtg.html">plotrtg</a></span>(<span class="no">pmd</span>)</pre></body></html></div>
<p><img src="globalstd_files/figure-html/rtg-1.png" width="700"></p>
<p>This plot would show the distribution of RT groups. The <code>rtcutoff</code> in function <code>getpaired</code> could be used to set the cutoff of the distances in retention time hierarchical clustering analysis.</p>
<p>Take care of the retention time cluster with lots of peaks. In this case, such cluster could be co-eluted compounds on certain column. It would be wise to trim the retention time window for high quality peaks.</p>
</div>
<div id="step2-relationship-among-adducts-neutral-loss-isotopologues-and-common-fragments-ions" class="section level3">
<h3 class="hasAnchor">
<a href="#step2-relationship-among-adducts-neutral-loss-isotopologues-and-common-fragments-ions" class="anchor"></a>STEP2: Relationship among adducts, neutral loss, isotopologues and common fragments ions</h3>
<p>The <code>ng</code> in function <code>getpaired</code> could be used to set cutoff of global PMD’s retention time group numbers. If <code>ng</code> is 10, at least 10 of the retention time groups should contain the shown PMD relationship. You could use <code>plotpaired</code> to show the distribution.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="../reference/plotpaired.html">plotpaired</a></span>(<span class="no">pmd</span>)</pre></body></html></div>
<p><img src="globalstd_files/figure-html/pmd-1.png" width="700"></p>
<p>You could also show the distribution of PMD relationship by index:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="co"># show the unique PMD found by getpaired function</span>
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">pmd</span>$<span class="no">paired</span>$<span class="no">diff2</span>))){
        <span class="no">diff</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">pmd</span>$<span class="no">paired</span>$<span class="no">diff2</span>)[<span class="no">i</span>]
        <span class="no">index</span> <span class="kw">&lt;-</span> <span class="no">pmd</span>$<span class="no">paired</span>$<span class="no">diff2</span> <span class="kw">==</span> <span class="no">diff</span>
        <span class="fu"><a href="../reference/plotpaired.html">plotpaired</a></span>(<span class="no">pmd</span>,<span class="no">index</span>)
}</pre></body></html></div>
<p><img src="globalstd_files/figure-html/pmdindex-1.png" width="700"><img src="globalstd_files/figure-html/pmdindex-2.png" width="700"><img src="globalstd_files/figure-html/pmdindex-3.png" width="700"><img src="globalstd_files/figure-html/pmdindex-4.png" width="700"><img src="globalstd_files/figure-html/pmdindex-5.png" width="700"><img src="globalstd_files/figure-html/pmdindex-6.png" width="700"><img src="globalstd_files/figure-html/pmdindex-7.png" width="700"><img src="globalstd_files/figure-html/pmdindex-8.png" width="700"><img src="globalstd_files/figure-html/pmdindex-9.png" width="700"></p>
<p>This is an easy way to find potential adducts of the data by high frequency PMD from the same compound. For example, 21.98 Da could be the mass distances between <span class="math inline">\([M+H]^+\)</span> and <span class="math inline">\([M+Na]^+\)</span>. In this case, user could find the potential adducts or neutral loss even when they have no preferred adducts list. If one adduct exist in certain analytical system, the high frequency PMD will reveal such relationship. The high frequency PMD list could also be used to check the fragmental pattern of in-source reactions as long as such patterns are popular among all collected ions.</p>
</div>
<div id="step3-screen-the-independent-peaks" class="section level3">
<h3 class="hasAnchor">
<a href="#step3-screen-the-independent-peaks" class="anchor"></a>STEP3: Screen the independent peaks</h3>
<p>You could use <code>getstd</code> function to get the independent peaks. Independent peaks mean the peaks list removing the redundant peaks such as adducts, neutral loss, isotopologues and comment fragments ions found by PMD analysis in STEP2. Ideally, those peaks could be molecular ions while they might still contain redundant peaks.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">std</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/getstd.html">getstd</a></span>(<span class="no">pmd</span>)
<span class="co">#&gt; 8 retention group(s) have single peaks. 14 23 32 33 54 55 56 75</span>
<span class="co">#&gt; 11 group(s) with multiple peaks while no isotope/paired relationship 4 5 7 8 11 41 42 49 68 72 73</span>
<span class="co">#&gt; 9 group(s) with multiple peaks with isotope without paired relationship 2 9 22 26 52 62 64 66 70</span>
<span class="co">#&gt; 4 group(s) with paired relationship without isotope 1 10 15 18</span>
<span class="co">#&gt; 43 group(s) with paired relationship and isotope 3 6 12 13 16 17 19 20 21 24 25 27 28 29 30 31 34 35 36 37 38 39 40 43 44 45 46 47 48 50 51 53 57 58 59 60 61 63 65 67 69 71 74</span>
<span class="co">#&gt; 297 std mass found.</span></pre></body></html></div>
<p>Here you could plot the peaks by <code>plotstd</code> function to show the distribution of independent peaks:</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="../reference/plotstd.html">plotstd</a></span>(<span class="no">std</span>)</pre></body></html></div>
<p><img src="globalstd_files/figure-html/stdplot-1.png" width="700"></p>
<p>You could also plot the peaks distribution by assign a retention time group via <code>plotstdrt</code>:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>,<span class="fl">3</span>))
<span class="fu"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(<span class="no">std</span>,<span class="kw">rtcluster</span> <span class="kw">=</span> <span class="fl">23</span>,<span class="kw">main</span> <span class="kw">=</span> <span class="st">'Retention time group 23'</span>)
<span class="fu"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(<span class="no">std</span>,<span class="kw">rtcluster</span> <span class="kw">=</span> <span class="fl">9</span>,<span class="kw">main</span> <span class="kw">=</span> <span class="st">'Retention time group 9'</span>)
<span class="fu"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(<span class="no">std</span>,<span class="kw">rtcluster</span> <span class="kw">=</span> <span class="fl">18</span>,<span class="kw">main</span> <span class="kw">=</span> <span class="st">'Retention time group 18'</span>)
<span class="fu"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(<span class="no">std</span>,<span class="kw">rtcluster</span> <span class="kw">=</span> <span class="fl">67</span>,<span class="kw">main</span> <span class="kw">=</span> <span class="st">'Retention time group 67'</span>)
<span class="fu"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(<span class="no">std</span>,<span class="kw">rtcluster</span> <span class="kw">=</span> <span class="fl">49</span>,<span class="kw">main</span> <span class="kw">=</span> <span class="st">'Retention time group 49'</span>)
<span class="fu"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(<span class="no">std</span>,<span class="kw">rtcluster</span> <span class="kw">=</span> <span class="fl">6</span>,<span class="kw">main</span> <span class="kw">=</span> <span class="st">'Retention time group 6'</span>)</pre></body></html></div>
<p><img src="globalstd_files/figure-html/stdrtplot-1.png" width="700"></p>
</div>
</div>
<div id="validation-by-principal-components-analysispca" class="section level2">
<h2 class="hasAnchor">
<a href="#validation-by-principal-components-analysispca" class="anchor"></a>Validation by principal components analysis(PCA)</h2>
<p>You need to check the GlobalStd algorithm’s results by principal components analysis(PCA). If we removed too much peaks containing information, the score plot of reduced data set would show great changes.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">enviGCMS</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>),<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span>)+<span class="fl">0.1</span>)
<span class="fu"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html">plotpca</a></span>(<span class="no">std</span>$<span class="no">data</span>,<span class="kw">lv</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">std</span>$<span class="no">group</span>)),<span class="kw">main</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(all peaks)"</span>)))
<span class="fu"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html">plotpca</a></span>(<span class="no">std</span>$<span class="no">data</span>[<span class="no">std</span>$<span class="no">stdmassindex</span>,],<span class="kw">lv</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">std</span>$<span class="no">group</span>)),<span class="kw">main</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))</pre></body></html></div>
<p><img src="globalstd_files/figure-html/pca-1.png" width="700"></p>
</div>
<div id="comparison-with-other-pseudo-spectra-extraction-method" class="section level2">
<h2 class="hasAnchor">
<a href="#comparison-with-other-pseudo-spectra-extraction-method" class="anchor"></a>Comparison with other pseudo spectra extraction method</h2>
<p>GlobalStd algorithm in <code>pmd</code> package could be treated as a method to extract pseudo spectra. You could use <code>getcluster</code> to get peaks groups information for all GlobalStd peaks. This function would consider the merge of GlobalStd peaks when certain peak is involved in multiple clusters. Then you could choose export peaks with the highest intensities or base peaks in each GlobalStd merged peaks groups. Meanwhile, you could also include the correlation coefficient cutoff to further improve the data quality.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">stdcluster</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/getcluster.html">getcluster</a></span>(<span class="no">std</span>)
<span class="co"># extract pseudospectra for std peak 71</span>
<span class="no">idx</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">stdcluster</span>$<span class="no">cluster</span>$<span class="no">largei</span>[<span class="no">stdcluster</span>$<span class="no">cluster</span>$<span class="no">i</span><span class="kw">==</span><span class="fl">71</span>])
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">stdcluster</span>$<span class="no">cluster</span>$<span class="no">mz</span>[<span class="no">stdcluster</span>$<span class="no">cluster</span>$<span class="no">largei</span><span class="kw">==</span><span class="no">idx</span>],<span class="no">stdcluster</span>$<span class="no">cluster</span>$<span class="no">ins</span>[<span class="no">stdcluster</span>$<span class="no">cluster</span>$<span class="no">largei</span><span class="kw">==</span><span class="no">idx</span>],<span class="kw">type</span> <span class="kw">=</span> <span class="st">'h'</span>,<span class="kw">xlab</span> <span class="kw">=</span> <span class="st">'m/z'</span>,<span class="kw">ylab</span> <span class="kw">=</span> <span class="st">'intensity'</span>,<span class="kw">main</span> <span class="kw">=</span> <span class="st">'pseudo spectra for GlobalStd peak 71'</span>)</pre></body></html></div>
<p><img src="globalstd_files/figure-html/comp-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="co"># export peaks with the highest intensities in each GlobalStd peaks groups.</span>
<span class="no">data</span> <span class="kw">&lt;-</span> <span class="no">stdcluster</span>$<span class="no">data</span>[<span class="no">stdcluster</span>$<span class="no">stdmassindex2</span>,]
<span class="co"># considering the correlation coefficient cutoff</span>
<span class="no">stdcluster2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/getcluster.html">getcluster</a></span>(<span class="no">std</span>, <span class="kw">corcutoff</span> <span class="kw">=</span> <span class="fl">0.9</span>)</pre></body></html></div>
<p>We supplied <code>getcorcluster</code> to find peaks groups by correlation analysis only. The base peaks of correlation cluster were selected to stand for the compounds.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">corcluster</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/getcorcluster.html">getcorcluster</a></span>(<span class="no">spmeinvivo</span>)
<span class="co">#&gt; 75 retention time cluster found.</span>
<span class="co"># extract pseudospectra 1@46</span>
<span class="no">peak</span> <span class="kw">&lt;-</span> <span class="no">corcluster</span>$<span class="no">cluster</span>[<span class="no">corcluster</span>$<span class="no">cluster</span>$<span class="no">largei</span> <span class="kw">==</span> <span class="st">'1@46'</span>,]
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">peak</span>$<span class="no">ins</span>~<span class="no">peak</span>$<span class="no">mz</span>,<span class="kw">type</span> <span class="kw">=</span> <span class="st">'h'</span>,<span class="kw">xlab</span> <span class="kw">=</span> <span class="st">'m/z'</span>,<span class="kw">ylab</span> <span class="kw">=</span> <span class="st">'intensity'</span>,<span class="kw">main</span> <span class="kw">=</span> <span class="st">'pseudo spectra for correlation cluster'</span>)</pre></body></html></div>
<p><img src="globalstd_files/figure-html/corpeak-1.png" width="700"></p>
<p>Then we could compare the compare reduced result using PCA similarity factor. A good peak selection algorithm could show a high PCA similarity factor compared with original data set while retain the minmized number of peaks.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>,<span class="fl">3</span>),<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span>)+<span class="fl">0.1</span>)
<span class="fu"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html">plotpca</a></span>(<span class="no">std</span>$<span class="no">data</span>[<span class="no">std</span>$<span class="no">stdmassindex</span>,],<span class="kw">lv</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">std</span>$<span class="no">group</span>)),<span class="kw">main</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">std</span>$<span class="no">stdmassindex</span>),<span class="st">"independent peaks"</span>))
<span class="fu"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html">plotpca</a></span>(<span class="no">std</span>$<span class="no">data</span>[<span class="no">stdcluster</span>$<span class="no">stdmassindex2</span>,],<span class="kw">lv</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">std</span>$<span class="no">group</span>)),<span class="kw">main</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">stdcluster</span>$<span class="no">stdmassindex2</span>),<span class="st">"base peaks"</span>))
<span class="fu"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html">plotpca</a></span>(<span class="no">std</span>$<span class="no">data</span>[<span class="no">stdcluster2</span>$<span class="no">stdmassindex2</span>,],<span class="kw">lv</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">std</span>$<span class="no">group</span>)),<span class="kw">main</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">stdcluster2</span>$<span class="no">stdmassindex2</span>),<span class="st">"independent base peaks"</span>))
<span class="fu"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html">plotpca</a></span>(<span class="no">std</span>$<span class="no">data</span>[<span class="no">corcluster</span>$<span class="no">stdmassindex</span>,],<span class="kw">lv</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">std</span>$<span class="no">group</span>)),<span class="kw">main</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">corcluster</span>$<span class="no">stdmassindex</span>),<span class="st">"peaks without correlationship"</span>))
<span class="fu"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html">plotpca</a></span>(<span class="no">std</span>$<span class="no">data</span>[<span class="no">corcluster</span>$<span class="no">stdmassindex2</span>,],<span class="kw">lv</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">std</span>$<span class="no">group</span>)),<span class="kw">main</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">corcluster</span>$<span class="no">stdmassindex2</span>),<span class="st">"base peaks without correlationship"</span>))
<span class="fu"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html">plotpca</a></span>(<span class="no">std</span>$<span class="no">data</span>,<span class="kw">lv</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">std</span>$<span class="no">group</span>)),<span class="kw">main</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">std</span>$<span class="no">data</span>),<span class="st">"all peaks"</span>))</pre></body></html></div>
<p><img src="globalstd_files/figure-html/corcomp-1.png" width="700"></p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="fu"><a href="../reference/pcasf.html">pcasf</a></span>(<span class="no">std</span>$<span class="no">data</span>, <span class="no">std</span>$<span class="no">data</span>[<span class="no">std</span>$<span class="no">stdmassindex</span>,])
<span class="co">#&gt;     pcasf </span>
<span class="co">#&gt; 0.9993495</span>
<span class="fu"><a href="../reference/pcasf.html">pcasf</a></span>(<span class="no">std</span>$<span class="no">data</span>, <span class="no">std</span>$<span class="no">data</span>[<span class="no">stdcluster</span>$<span class="no">stdmassindex2</span>,])
<span class="co">#&gt;     pcasf </span>
<span class="co">#&gt; 0.9993581</span>
<span class="fu"><a href="../reference/pcasf.html">pcasf</a></span>(<span class="no">std</span>$<span class="no">data</span>, <span class="no">std</span>$<span class="no">data</span>[<span class="no">stdcluster2</span>$<span class="no">stdmassindex2</span>,])
<span class="co">#&gt;     pcasf </span>
<span class="co">#&gt; 0.9993463</span>
<span class="fu"><a href="../reference/pcasf.html">pcasf</a></span>(<span class="no">std</span>$<span class="no">data</span>, <span class="no">std</span>$<span class="no">data</span>[<span class="no">corcluster</span>$<span class="no">stdmassindex</span>,])
<span class="co">#&gt;     pcasf </span>
<span class="co">#&gt; 0.9471586</span>
<span class="fu"><a href="../reference/pcasf.html">pcasf</a></span>(<span class="no">std</span>$<span class="no">data</span>, <span class="no">std</span>$<span class="no">data</span>[<span class="no">corcluster</span>$<span class="no">stdmassindex2</span>,])
<span class="co">#&gt;     pcasf </span>
<span class="co">#&gt; 0.9497193</span></pre></body></html></div>
<p>In this case, five peaks selection algorithms are fine to stand for the original peaks with PCA similarity score larger than 0.9. However, the independent base peaks retain the most information with relative low numbers of peaks.</p>
</div>
<div id="globalstd-algorithm-with-intensity-data" class="section level2">
<h2 class="hasAnchor">
<a href="#globalstd-algorithm-with-intensity-data" class="anchor"></a>GlobalStd algorithm with intensity data</h2>
<p>As mentioned above, GlobalStd algorithm is designed to analysis data without intensity data. However, if you have intensity data, the independent peaks could be selected with more confidence. You could set up cutoff of Pearson Correlation Coefficient between peaks to refine the peaks selected by GlobalStd within same retention time groups.</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">std2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/getstd.html">getstd</a></span>(<span class="no">pmd</span>,<span class="kw">corcutoff</span> <span class="kw">=</span> <span class="fl">0.9</span>)
<span class="co">#&gt; 8 retention group(s) have single peaks. 14 23 32 33 54 55 56 75</span>
<span class="co">#&gt; 23 group(s) with multiple peaks while no isotope/paired relationship 2 4 5 7 8 10 11 15 18 26 35 39 41 42 49 50 59 62 68 69 70 72 73</span>
<span class="co">#&gt; 14 group(s) with multiple peaks with isotope without paired relationship 9 12 22 24 27 28 34 51 52 57 60 64 66 71</span>
<span class="co">#&gt; 3 group(s) with paired relationship without isotope 1 53 74</span>
<span class="co">#&gt; 27 group(s) with paired relationship and isotope 3 6 13 16 17 19 20 21 25 29 30 31 36 37 38 40 43 44 45 46 47 48 58 61 63 65 67</span>
<span class="co">#&gt; 120 std mass found.</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">3</span>),<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span>)+<span class="fl">0.1</span>)
<span class="fu"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html">plotpca</a></span>(<span class="no">std2</span>$<span class="no">data</span>,<span class="kw">lv</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">std2</span>$<span class="no">group</span>)),<span class="kw">main</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(all peaks)"</span>)))
<span class="fu"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html">plotpca</a></span>(<span class="no">std</span>$<span class="no">data</span>[<span class="no">std</span>$<span class="no">stdmassindex</span>,],<span class="kw">lv</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">std</span>$<span class="no">group</span>)),<span class="kw">main</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))
<span class="fu"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html">plotpca</a></span>(<span class="no">std2</span>$<span class="no">data</span>[<span class="no">std2</span>$<span class="no">stdmassindex</span>,],<span class="kw">lv</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">std2</span>$<span class="no">group</span>)),<span class="kw">main</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))</pre></body></html></div>
<p><img src="globalstd_files/figure-html/globalcor-1.png" width="700"></p>
</div>
<div id="structurereaction-directed-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#structurereaction-directed-analysis" class="anchor"></a>Structure/Reaction directed analysis</h2>
<p><code>getsda</code> function could be used to perform Structure/reaction directed analysis. The cutoff of frequency is automate found by PMD network analysis with most cluster numbers.</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="no">sda</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/getsda.html">getsda</a></span>(<span class="no">std</span>)
<span class="co">#&gt; PMD frequency cutoff is 6 by PMD network analysis with largest network average distance 5.99 .</span>
<span class="co">#&gt; 57 groups were found as high frequency PMD group.</span>
<span class="co">#&gt; 0 was found as high frequency PMD. </span>
<span class="co">#&gt; 1.98 was found as high frequency PMD. </span>
<span class="co">#&gt; 2.01 was found as high frequency PMD. </span>
<span class="co">#&gt; 2.02 was found as high frequency PMD. </span>
<span class="co">#&gt; 6.97 was found as high frequency PMD. </span>
<span class="co">#&gt; 11.96 was found as high frequency PMD. </span>
<span class="co">#&gt; 12 was found as high frequency PMD. </span>
<span class="co">#&gt; 12.04 was found as high frequency PMD. </span>
<span class="co">#&gt; 13.98 was found as high frequency PMD. </span>
<span class="co">#&gt; 14.02 was found as high frequency PMD. </span>
<span class="co">#&gt; 14.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 15.99 was found as high frequency PMD. </span>
<span class="co">#&gt; 16.03 was found as high frequency PMD. </span>
<span class="co">#&gt; 19.04 was found as high frequency PMD. </span>
<span class="co">#&gt; 28.03 was found as high frequency PMD. </span>
<span class="co">#&gt; 30.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 31.99 was found as high frequency PMD. </span>
<span class="co">#&gt; 37.02 was found as high frequency PMD. </span>
<span class="co">#&gt; 42.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 48.04 was found as high frequency PMD. </span>
<span class="co">#&gt; 48.98 was found as high frequency PMD. </span>
<span class="co">#&gt; 49.02 was found as high frequency PMD. </span>
<span class="co">#&gt; 54.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 56.06 was found as high frequency PMD. </span>
<span class="co">#&gt; 56.1 was found as high frequency PMD. </span>
<span class="co">#&gt; 58.04 was found as high frequency PMD. </span>
<span class="co">#&gt; 58.08 was found as high frequency PMD. </span>
<span class="co">#&gt; 58.11 was found as high frequency PMD. </span>
<span class="co">#&gt; 63.96 was found as high frequency PMD. </span>
<span class="co">#&gt; 66.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 68.06 was found as high frequency PMD. </span>
<span class="co">#&gt; 70.04 was found as high frequency PMD. </span>
<span class="co">#&gt; 70.08 was found as high frequency PMD. </span>
<span class="co">#&gt; 74.02 was found as high frequency PMD. </span>
<span class="co">#&gt; 80.03 was found as high frequency PMD. </span>
<span class="co">#&gt; 82.08 was found as high frequency PMD. </span>
<span class="co">#&gt; 88.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 91.1 was found as high frequency PMD. </span>
<span class="co">#&gt; 93.12 was found as high frequency PMD. </span>
<span class="co">#&gt; 96.09 was found as high frequency PMD. </span>
<span class="co">#&gt; 101.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 108.13 was found as high frequency PMD. </span>
<span class="co">#&gt; 110.11 was found as high frequency PMD. </span>
<span class="co">#&gt; 112.16 was found as high frequency PMD. </span>
<span class="co">#&gt; 116.08 was found as high frequency PMD. </span>
<span class="co">#&gt; 122.15 was found as high frequency PMD. </span>
<span class="co">#&gt; 124.16 was found as high frequency PMD. </span>
<span class="co">#&gt; 126.14 was found as high frequency PMD. </span>
<span class="co">#&gt; 148.04 was found as high frequency PMD. </span>
<span class="co">#&gt; 150.2 was found as high frequency PMD. </span>
<span class="co">#&gt; 173.18 was found as high frequency PMD. </span>
<span class="co">#&gt; 191.08 was found as high frequency PMD. </span>
<span class="co">#&gt; 191.15 was found as high frequency PMD. </span>
<span class="co">#&gt; 192.19 was found as high frequency PMD. </span>
<span class="co">#&gt; 194.2 was found as high frequency PMD. </span>
<span class="co">#&gt; 267.25 was found as high frequency PMD. </span>
<span class="co">#&gt; 325.3 was found as high frequency PMD.</span></pre></body></html></div>
<p>You could use <code>plotstdsda</code> to show the distribution of the selected paired peaks.</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="fu"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(<span class="no">sda</span>)</pre></body></html></div>
<p><img src="globalstd_files/figure-html/stdsda-1.png" width="700"></p>
<p>You could also use index to show the distribution of certain PMDs.</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">3</span>),<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span>)+<span class="fl">0.1</span>)
<span class="fu"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(<span class="no">sda</span>,<span class="no">sda</span>$<span class="no">sda</span>$<span class="no">diff2</span> <span class="kw">==</span> <span class="fl">2.02</span>)
<span class="fu"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(<span class="no">sda</span>,<span class="no">sda</span>$<span class="no">sda</span>$<span class="no">diff2</span> <span class="kw">==</span> <span class="fl">28.03</span>)
<span class="fu"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(<span class="no">sda</span>,<span class="no">sda</span>$<span class="no">sda</span>$<span class="no">diff2</span> <span class="kw">==</span> <span class="fl">58.04</span>)</pre></body></html></div>
<p><img src="globalstd_files/figure-html/stdsdaidx-1.png" width="700"></p>
<p>Structure/reaction directed analysis could be directly performed on all the peaks, which is slow to process:</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="no">sdaall</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/getsda.html">getsda</a></span>(<span class="no">spmeinvivo</span>)
<span class="co">#&gt; PMD frequency cutoff is 104 by PMD network analysis with largest network average distance 14.06 .</span>
<span class="co">#&gt; 6 groups were found as high frequency PMD group.</span>
<span class="co">#&gt; 0 was found as high frequency PMD. </span>
<span class="co">#&gt; 2.02 was found as high frequency PMD. </span>
<span class="co">#&gt; 28.03 was found as high frequency PMD. </span>
<span class="co">#&gt; 31.01 was found as high frequency PMD. </span>
<span class="co">#&gt; 58.04 was found as high frequency PMD. </span>
<span class="co">#&gt; 116.08 was found as high frequency PMD.</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">3</span>),<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span>)+<span class="fl">0.1</span>)
<span class="fu"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(<span class="no">sdaall</span>,<span class="no">sdaall</span>$<span class="no">sda</span>$<span class="no">diff2</span> <span class="kw">==</span> <span class="fl">2.02</span>)
<span class="fu"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(<span class="no">sdaall</span>,<span class="no">sdaall</span>$<span class="no">sda</span>$<span class="no">diff2</span> <span class="kw">==</span> <span class="fl">28.03</span>)
<span class="fu"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(<span class="no">sdaall</span>,<span class="no">sdaall</span>$<span class="no">sda</span>$<span class="no">diff2</span> <span class="kw">==</span> <span class="fl">58.04</span>)</pre></body></html></div>
<p><img src="globalstd_files/figure-html/all-1.png" width="700"></p>
<div id="structurereaction-directed-analysis-for-peakscompounds-only-data" class="section level3">
<h3 class="hasAnchor">
<a href="#structurereaction-directed-analysis-for-peakscompounds-only-data" class="anchor"></a>Structure/reaction directed analysis for peaks/compounds only data</h3>
<p>When you only have data of peaks without retention time or compounds list, structure/reaction directed analysis could also be done by <code>getrda</code> function.</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="no">sda</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/getrda.html">getrda</a></span>(<span class="no">spmeinvivo</span>$<span class="no">mz</span>[<span class="no">std</span>$<span class="no">stdmassindex</span>])
<span class="co">#&gt; 38116 pmd found.</span>
<span class="co">#&gt; 11 pmd used.</span></pre></body></html></div>
</div>
</div>
<div id="parameters-selection" class="section level2">
<h2 class="hasAnchor">
<a href="#parameters-selection" class="anchor"></a>Parameters selection</h2>
<p>Retention time cluster cutoff should fit the peak picking algorithm. For HPLC, 10 is suggested and 5 could be used for UPLC.</p>
<p>Global PMD’s retention time group numbers should be around 20 percent of the retention time cluster numbers. For example, if you find 100 retention time clusters, I suggested you use 20 as the empirical global PMD’s retention time group numbers.</p>
<p>Another important hint is that pre-filter your peak list by black samples or other quality control samples. Otherwise the running time would be long and lots of pmd relationship would be just from noise.</p>
</div>
<div id="wrap-function" class="section level2">
<h2 class="hasAnchor">
<a href="#wrap-function" class="anchor"></a>Wrap function</h2>
<p><code>globalstd</code> function is a wrap function to process GlobalStd algorithm and structure/reaction directed analysis in one line. All the plot function could be directly used on the <code>list</code> objects from <code>globalstd</code> function.</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="no">result</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/globalstd.html">globalstd</a></span>(<span class="no">spmeinvivo</span>,<span class="kw">ng</span><span class="kw">=</span><span class="fl">10</span>)
<span class="co">#&gt; 75 retention time cluster found.</span>
<span class="co">#&gt; 380 paired masses found</span>
<span class="co">#&gt; 9 unique within RT clusters high frequency PMD(s) used for further investigation.</span>
<span class="co">#&gt; 719 isotopologue(s) related paired mass found.</span>
<span class="co">#&gt; 492 multi-charger(s) related paired mass found.</span>
<span class="co">#&gt; 8 retention group(s) have single peaks. 14 23 32 33 54 55 56 75</span>
<span class="co">#&gt; 11 group(s) with multiple peaks while no isotope/paired relationship 4 5 7 8 11 41 42 49 68 72 73</span>
<span class="co">#&gt; 9 group(s) with multiple peaks with isotope without paired relationship 2 9 22 26 52 62 64 66 70</span>
<span class="co">#&gt; 4 group(s) with paired relationship without isotope 1 10 15 18</span>
<span class="co">#&gt; 43 group(s) with paired relationship and isotope 3 6 12 13 16 17 19 20 21 24 25 27 28 29 30 31 34 35 36 37 38 39 40 43 44 45 46 47 48 50 51 53 57 58 59 60 61 63 65 67 69 71 74</span>
<span class="co">#&gt; 297 std mass found.</span>
<span class="co">#&gt; PMD frequency cutoff is 6 by PMD network analysis with largest network average distance 5.99 .</span>
<span class="co">#&gt; 57 groups were found as high frequency PMD group.</span>
<span class="co">#&gt; 0 was found as high frequency PMD. </span>
<span class="co">#&gt; 1.98 was found as high frequency PMD. </span>
<span class="co">#&gt; 2.01 was found as high frequency PMD. </span>
<span class="co">#&gt; 2.02 was found as high frequency PMD. </span>
<span class="co">#&gt; 6.97 was found as high frequency PMD. </span>
<span class="co">#&gt; 11.96 was found as high frequency PMD. </span>
<span class="co">#&gt; 12 was found as high frequency PMD. </span>
<span class="co">#&gt; 12.04 was found as high frequency PMD. </span>
<span class="co">#&gt; 13.98 was found as high frequency PMD. </span>
<span class="co">#&gt; 14.02 was found as high frequency PMD. </span>
<span class="co">#&gt; 14.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 15.99 was found as high frequency PMD. </span>
<span class="co">#&gt; 16.03 was found as high frequency PMD. </span>
<span class="co">#&gt; 19.04 was found as high frequency PMD. </span>
<span class="co">#&gt; 28.03 was found as high frequency PMD. </span>
<span class="co">#&gt; 30.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 31.99 was found as high frequency PMD. </span>
<span class="co">#&gt; 37.02 was found as high frequency PMD. </span>
<span class="co">#&gt; 42.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 48.04 was found as high frequency PMD. </span>
<span class="co">#&gt; 48.98 was found as high frequency PMD. </span>
<span class="co">#&gt; 49.02 was found as high frequency PMD. </span>
<span class="co">#&gt; 54.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 56.06 was found as high frequency PMD. </span>
<span class="co">#&gt; 56.1 was found as high frequency PMD. </span>
<span class="co">#&gt; 58.04 was found as high frequency PMD. </span>
<span class="co">#&gt; 58.08 was found as high frequency PMD. </span>
<span class="co">#&gt; 58.11 was found as high frequency PMD. </span>
<span class="co">#&gt; 63.96 was found as high frequency PMD. </span>
<span class="co">#&gt; 66.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 68.06 was found as high frequency PMD. </span>
<span class="co">#&gt; 70.04 was found as high frequency PMD. </span>
<span class="co">#&gt; 70.08 was found as high frequency PMD. </span>
<span class="co">#&gt; 74.02 was found as high frequency PMD. </span>
<span class="co">#&gt; 80.03 was found as high frequency PMD. </span>
<span class="co">#&gt; 82.08 was found as high frequency PMD. </span>
<span class="co">#&gt; 88.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 91.1 was found as high frequency PMD. </span>
<span class="co">#&gt; 93.12 was found as high frequency PMD. </span>
<span class="co">#&gt; 96.09 was found as high frequency PMD. </span>
<span class="co">#&gt; 101.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 108.13 was found as high frequency PMD. </span>
<span class="co">#&gt; 110.11 was found as high frequency PMD. </span>
<span class="co">#&gt; 112.16 was found as high frequency PMD. </span>
<span class="co">#&gt; 116.08 was found as high frequency PMD. </span>
<span class="co">#&gt; 122.15 was found as high frequency PMD. </span>
<span class="co">#&gt; 124.16 was found as high frequency PMD. </span>
<span class="co">#&gt; 126.14 was found as high frequency PMD. </span>
<span class="co">#&gt; 148.04 was found as high frequency PMD. </span>
<span class="co">#&gt; 150.2 was found as high frequency PMD. </span>
<span class="co">#&gt; 173.18 was found as high frequency PMD. </span>
<span class="co">#&gt; 191.08 was found as high frequency PMD. </span>
<span class="co">#&gt; 191.15 was found as high frequency PMD. </span>
<span class="co">#&gt; 192.19 was found as high frequency PMD. </span>
<span class="co">#&gt; 194.2 was found as high frequency PMD. </span>
<span class="co">#&gt; 267.25 was found as high frequency PMD. </span>
<span class="co">#&gt; 325.3 was found as high frequency PMD.</span></pre></body></html></div>
</div>
<div id="use-independent-peaks-for-msms-validation-pmdda" class="section level2">
<h2 class="hasAnchor">
<a href="#use-independent-peaks-for-msms-validation-pmdda" class="anchor"></a>Use independent peaks for MS/MS validation (PMDDA)</h2>
<p>Independent peaks are supposing generated from different compounds. We could use those peaks for MS/MS analysis instead of DIA or DDA. Here we need multiple injections for one sample since it might be impossible to get all ions’ fragmental ions in one injection with good sensitivity. You could use <code>gettarget</code> to generate the index for the injections and output the peaks for each run.</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="co"># you need retention time for independent peaks</span>
<span class="no">index</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/gettarget.html">gettarget</a></span>(<span class="no">std</span>$<span class="no">rt</span>[<span class="no">std</span>$<span class="no">stdmassindex</span>])
<span class="co">#&gt; You need 10 injections!</span>
<span class="co"># output the ions for each injection</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">index</span>)
<span class="co">#&gt; index</span>
<span class="co">#&gt;  1  2  3  4  5  6  7  8  9 10 </span>
<span class="co">#&gt; 26 26 27 39 27 27 44 31 31 19</span>
<span class="co"># show the ions for the first injection</span>
<span class="no">std</span>$<span class="no">mz</span>[<span class="no">index</span><span class="kw">==</span><span class="fl">1</span>]
<span class="co">#&gt;   [1] 100.9572 103.0547 114.0918 155.1294 161.0713 173.1335 174.0392 183.0809</span>
<span class="co">#&gt;   [9] 195.1024 195.1745 196.4492 197.1285 198.1853 203.0532 210.1577 211.1698</span>
<span class="co">#&gt;  [17] 226.1822 226.9522 236.1626 242.2863 242.2863 253.1420 257.2676 257.9694</span>
<span class="co">#&gt;  [25] 258.8998 261.2214 263.2382 264.1944 268.9123 281.0519 285.3002 297.2985</span>
<span class="co">#&gt;  [33] 299.1113 308.0887 313.2741 314.9159 315.1957 317.2846 319.2846 320.3040</span>
<span class="co">#&gt;  [41] 327.2022 328.0132 336.3259 337.1058 341.3512 349.3476 351.3455 363.9294</span>
<span class="co">#&gt;  [49] 366.3752 367.2694 367.3373 370.3330 373.2203 374.3041 381.1324 404.2889</span>
<span class="co">#&gt;  [57] 411.1725 425.2153 425.3120 432.9177 445.3874 446.1216 447.1173 447.2935</span>
<span class="co">#&gt;  [65] 447.9910 449.1148 463.1472 466.8208 488.3591 492.8839 501.3829 508.8581</span>
<span class="co">#&gt;  [73] 514.8764 533.9698 538.3150 538.3435 539.1646 541.3942 545.3435 545.4035</span>
<span class="co">#&gt;  [81] 557.0950 582.3700 594.3765 614.5358 614.8111 636.8788 651.8520 652.8473</span>
<span class="co">#&gt;  [89] 654.3332 655.3369 658.4832 663.4897 673.8481 675.2109 686.2013 689.8645</span>
<span class="co">#&gt;  [97] 703.2147 708.6701 709.4930 734.8119 739.5078 739.6479 741.8363 752.5158</span>
<span class="co">#&gt; [105] 759.2230 760.2210 770.8499 803.5434 816.1771 840.8392 841.5715 866.6928</span>
<span class="co">#&gt; [113] 878.3781 879.3804 881.3220 881.8224 884.4968 886.7613 903.8164 906.8283</span>
<span class="co">#&gt; [121] 924.7999 925.7373 946.8063 968.7950 971.8036</span>
<span class="no">std</span>$<span class="no">rt</span>[<span class="no">index</span><span class="kw">==</span><span class="fl">1</span>]
<span class="co">#&gt;   [1]  84.8510 348.1340 172.8550 732.5740 389.9630 611.4120 216.6520 533.7950</span>
<span class="co">#&gt;   [9] 574.1260 594.4850 145.1850 170.6010 639.3130 144.8840 611.4130 452.9630</span>
<span class="co">#&gt;  [17] 416.1050 213.9270 430.6770 538.2950 809.1845 529.9735 587.8420 146.3970</span>
<span class="co">#&gt;  [25] 217.2010 556.7660 602.1970 473.1445 146.1810 762.5750 504.4370 639.3130</span>
<span class="co">#&gt;  [33] 447.6060 549.6960 587.3035 145.8840 522.6500 608.1980 564.4820 622.7700</span>
<span class="co">#&gt;  [41] 170.3860 509.1510 594.9125 543.4380 639.3140 659.2440 626.0920 213.5990</span>
<span class="co">#&gt;  [49] 659.2440 382.6770 585.2700 551.8380 424.8935 582.4840 447.8210 570.2670</span>
<span class="co">#&gt;  [57] 621.1625 601.3390 404.7480 213.9420 582.4825 717.1020 716.8890 404.5340</span>
<span class="co">#&gt;  [65] 212.6570 717.1020 717.0775 144.2540 540.8660 213.7130 422.9630 215.2830</span>
<span class="co">#&gt;  [73] 215.7020 639.2075 520.8340 537.2240 762.7890 628.3425 511.0800 579.9130</span>
<span class="co">#&gt;  [81] 762.5765 534.0090 561.2680 639.0990 217.8140 213.7425 215.7110 215.5645</span>
<span class="co">#&gt;  [89] 630.9135 475.7210 468.4850 633.5910 214.3560 819.5135 883.0525 213.4215</span>
<span class="co">#&gt;  [97] 663.7645 594.2710 525.2220 216.7260 480.6530 639.1005 214.1480 522.4370</span>
<span class="co">#&gt; [105] 700.1720 700.3870 213.7720 665.0290 213.3340 213.9270 517.2940 632.6260</span>
<span class="co">#&gt; [113] 381.9255 373.7835 214.8590 214.4090 213.3590 217.3700 213.5020 213.7270</span>
<span class="co">#&gt; [121] 214.9990 636.9560 213.6155 213.9410 213.5485</span></pre></body></html></div>
</div>
<div id="shiny-application" class="section level2">
<h2 class="hasAnchor">
<a href="#shiny-application" class="anchor"></a>Shiny application</h2>
<p>An interactive document has been included in this package to perform PMD analysis. You need to prepare a csv file with m/z and retention time of peaks. Such csv file could be generated by run <code><a href="https://rdrr.io/pkg/enviGCMS/man/getmzrtcsv.html">enviGCMS::getmzrtcsv()</a></code> on the <code>list</code> object from <code><a href="https://rdrr.io/pkg/enviGCMS/man/getmzrt.html">enviGCMS::getmzrt(xset)</a></code> or <code><a href="https://rdrr.io/pkg/enviGCMS/man/getmzrt2.html">enviGCMS::getmzrt2(xset)</a></code> function. You could also generate the csv file by <code><a href="https://rdrr.io/pkg/enviGCMS/man/getmzrt.html">enviGCMS::getmzrt(xset,name = 'test')</a></code> or <code><a href="https://rdrr.io/pkg/enviGCMS/man/getmzrt2.html">enviGCMS::getmzrt2(xset, name = 'test')</a></code>. You will find the csv file in the working dictionary named <code>test.csv</code>.</p>
<p>Then you could run <code><a href="../reference/runPMD.html">runPMD()</a></code> to start the Graphical user interface(GUI) for GlobalStd algorithm and structure/reaction directed analysis.</p>
</div>
<div id="conclusion" class="section level2">
<h2 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h2>
<p><code>pmd</code> package could be used to reduce the redundancy peaks for GC/LC-MS based research and perform structure/reaction directed analysis to screen known and unknown important compounds or reactions.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Miao YU.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
