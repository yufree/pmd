<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis â€¢ pmd</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-58201304-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-58201304-1');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pmd</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/globalstd.html">Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis</h1>
                        <h4 class="author">Miao Yu</h4>
            
            <h4 class="date">2019-09-24</h4>
      
      
      <div class="hidden name"><code>globalstd.Rmd</code></div>

    </div>

    
    
<div id="introduction-of-paired-mass-distance-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction-of-paired-mass-distance-analysis" class="anchor"></a>Introduction of Paired Mass Distance analysis</h2>
<p><code>pmd</code> package use Paired Mass Distance (PMD) relationship to analysis the GC/LC-MS based non-targeted data. PMD means the distance between two masses or mass to charge ratios. In mass spectrometry, PMD would keep the same between two masses or two mass to charge ratios(m/z). There are twe kinds of PMD involved in this package: PMD within same retention time group and PMD from different retention time groups.</p>
<div id="pmd-within-same-retention-time-group" class="section level3">
<h3 class="hasAnchor">
<a href="#pmd-within-same-retention-time-group" class="anchor"></a>PMD within same retention time group</h3>
<p>In GC/LC-MS based non-targeted analysis, peaks could be seperated by chromatograph. We could build retention time(RT) bins to assign peaks into different RT groups by retention time hierarchical clustering analysis. For each RT group, the peaks should come from same compounds or co-elutes. If certain PMD appeared in multiple RT groups, it would be related to the relationship about adducts, neutral loss, isotopologues or commen fragments ions.</p>
</div>
<div id="pmd-from-different-retention-time-groups" class="section level3">
<h3 class="hasAnchor">
<a href="#pmd-from-different-retention-time-groups" class="anchor"></a>PMD from different retention time groups</h3>
<p>The peaks from different retention time groups would like to be different compounds seperated by chromatograph. The PMD would reflect the relationship about homologous series or chemical reactions.</p>
<p>GlobalStd algorithm use the PMD within same RT group to find independent peaks among certain dataset. Structure/reaction directed analysis use PMD from different RT groups to screen important compounds or reactions.</p>
</div>
</div>
<div id="data-format" class="section level2">
<h2 class="hasAnchor">
<a href="#data-format" class="anchor"></a>Data format</h2>
<p>The input data should be a <code>list</code> object with at least two elements from a peaks list:</p>
<ul>
<li>mass to charge ratio with name of <code>mz</code>, high resolution mass spectrometry is required</li>
<li>retention time with name of <code>rt</code>
</li>
</ul>
<p>However, I suggested to add intensity and group information to the list for validation of PMD analysis.</p>
<p>In this package, a dataset from <em>in vivo</em> solid phase micro-extraction(SPME) was attached. This dataset contain 9 samples from 3 fish with triplicates samples for each fish. Here is the data strcture:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(pmd)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"spmeinvivo"</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(spmeinvivo)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt; List of 4</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#&gt;  $ data : num [1:1459, 1:9] 1095 10439 10154 2797 90211 ...</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt;   .. ..$ : chr [1:1459] "100.1/170" "100.5/86" "101/85" "103.1/348" ...</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt;   .. ..$ : chr [1:9] "1405_Fish1_F1" "1405_Fish1_F2" "1405_Fish1_F3" "1405_Fish2_F1" ...</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt;  $ group: chr [1:9] "fish1" "fish1" "fish1" "fish2" ...</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt;  $ mz   : num [1:1459] 100 101 101 103 104 ...</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">#&gt;  $ rt   : num [1:1459] 170.2 86.3 84.9 348.1 48.8 ...</span></a></code></pre></div>
<p>You could build this <code>list</code> object from the <code>xcms</code> objects via <code>enviGCMS</code> package. When you have a <code>xcmsSet</code> object or <code>XCMSnExp</code> object named <code>xset</code>, you could use <code><a href="https://rdrr.io/pkg/enviGCMS/man/getmzrt.html">enviGCMS::getmzrt(xset)</a></code> or <code><a href="https://rdrr.io/pkg/enviGCMS/man/getmzrt2.html">enviGCMS::getmzrt2(xset)</a></code> to get such list. Of course you could build such list by yourself.</p>
</div>
<div id="globalstd-algorithm" class="section level2">
<h2 class="hasAnchor">
<a href="#globalstd-algorithm" class="anchor"></a>GlobalStd algorithm</h2>
<p>GlobalStd algorithm try to find independent peaks among certain peaks list. The first step is retention time hierarchical clustering analysis. The second step is to find the relationship among adducts, neutral loss, isotopologues and commen fragments ions. The third step is to screen the independent peaks.</p>
<div id="retention-time-hierarchical-clustering" class="section level3">
<h3 class="hasAnchor">
<a href="#retention-time-hierarchical-clustering" class="anchor"></a>Retention time hierarchical clustering</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">pmd &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getpaired.html">getpaired</a></span>(spmeinvivo, <span class="dt">rtcutoff =</span> <span class="dv">10</span>, <span class="dt">ng =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt; 75 retention time cluster found.</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#&gt; 376 paired masses found</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt; 9 unique within RT clusters high frequency PMD(s) used for further investigation.</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt; 649 isotopologue(s) related paired mass found.</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; 685 multi-charger(s) related paired mass found.</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="kw"><a href="../reference/plotrtg.html">plotrtg</a></span>(pmd)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/rtg-1.png" width="700"></p>
<p>This plot would show the distribution of RT groups. The <code>rtcutoff</code> in function <code>getpaired</code> could be used to set the cutoff of the distances in retention time hierarchical clustering analysis.</p>
</div>
<div id="relationship-among-adducts-neutral-loss-isotopologues-and-commen-fragments-ions" class="section level3">
<h3 class="hasAnchor">
<a href="#relationship-among-adducts-neutral-loss-isotopologues-and-commen-fragments-ions" class="anchor"></a>Relationship among adducts, neutral loss, isotopologues and commen fragments ions</h3>
<p>The <code>ng</code> in function <code>getpaired</code> could be used to set cutoff of global PMDâ€™s retention time group numbers. If <code>ng</code> is 10, at least 10 of the retention time groups should contain the shown PMD relationship. You could use <code>plotpaired</code> to show the distribution.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="../reference/plotpaired.html">plotpaired</a></span>(pmd)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/pmd-1.png" width="700"></p>
<p>You could also show the distribution of PMD relationship by index:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># show the unique PMD found by getpaired function</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(pmd<span class="op">$</span>paired<span class="op">$</span>diff2))){</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">        diff &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(pmd<span class="op">$</span>paired<span class="op">$</span>diff2)[i]</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">        index &lt;-<span class="st"> </span>pmd<span class="op">$</span>paired<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span>diff</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">        <span class="kw"><a href="../reference/plotpaired.html">plotpaired</a></span>(pmd,index)</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">}</a></code></pre></div>
<p><img src="globalstd_files/figure-html/pmdindex-1.png" width="700"><img src="globalstd_files/figure-html/pmdindex-2.png" width="700"><img src="globalstd_files/figure-html/pmdindex-3.png" width="700"><img src="globalstd_files/figure-html/pmdindex-4.png" width="700"><img src="globalstd_files/figure-html/pmdindex-5.png" width="700"><img src="globalstd_files/figure-html/pmdindex-6.png" width="700"><img src="globalstd_files/figure-html/pmdindex-7.png" width="700"><img src="globalstd_files/figure-html/pmdindex-8.png" width="700"><img src="globalstd_files/figure-html/pmdindex-9.png" width="700"></p>
</div>
<div id="screen-the-independent-peaks" class="section level3">
<h3 class="hasAnchor">
<a href="#screen-the-independent-peaks" class="anchor"></a>Screen the independent peaks</h3>
<p>You could use <code>getstd</code> function to get the independent peaks.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">std &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getstd.html">getstd</a></span>(pmd)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt; 8 retention group(s) have single peaks. 14 23 32 33 54 55 56 75</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt; 11 group(s) with multiple peaks while no isotope/paired relationship 4 5 7 8 11 41 42 49 68 72 73</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt; 9 group(s) with multiple peaks with isotope without paired relationship 2 9 22 26 52 62 64 66 70</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; 4 group(s) with paired relationship without isotope 1 10 15 18</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; 43 group(s) with paired relationship and isotope 3 6 12 13 16 17 19 20 21 24 25 27 28 29 30 31 34 35 36 37 38 39 40 43 44 45 46 47 48 50 51 53 57 58 59 60 61 63 65 67 69 71 74</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt; 270 std mass found.</span></a></code></pre></div>
<p>Here you could plot the peaks by <code>plotstd</code> function to show the distribution of independent peaks:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="../reference/plotstd.html">plotstd</a></span>(std)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/stdplot-1.png" width="700"></p>
<p>You could also plot the peaks distribution by assign a retention time group via <code>plotstdrt</code>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">23</span>,<span class="dt">main =</span> <span class="st">'Retention time group 23'</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">9</span>,<span class="dt">main =</span> <span class="st">'Retention time group 9'</span>)</a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">18</span>,<span class="dt">main =</span> <span class="st">'Retention time group 18'</span>)</a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">67</span>,<span class="dt">main =</span> <span class="st">'Retention time group 67'</span>)</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">49</span>,<span class="dt">main =</span> <span class="st">'Retention time group 49'</span>)</a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">6</span>,<span class="dt">main =</span> <span class="st">'Retention time group 6'</span>)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/stdrtplot-1.png" width="700"></p>
</div>
<div id="use-independent-peaks-for-msms-validation" class="section level3">
<h3 class="hasAnchor">
<a href="#use-independent-peaks-for-msms-validation" class="anchor"></a>Use independent peaks for MS/MS validation</h3>
<p>Independent peaks are supporsing generated from different compounds. We could use those peaks for MS/MS analysis instead of DIA or DDA. Here we need multiple injections for one sample since it might be impossible to get all ionsâ€™ fragmental ions in one injection with good sensitivity. You could use <code>gettarget</code> to generate the index for the injections and output the peaks for each run.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># you need retention time for independent peaks</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">index &lt;-<span class="st"> </span><span class="kw"><a href="../reference/gettarget.html">gettarget</a></span>(std<span class="op">$</span>rt[std<span class="op">$</span>stdmassindex])</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&gt; You need 7 injections!</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co"># output the ions for each injection</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/base/table.html">table</a></span>(index)</a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt; index</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt;  1  2  3  4  5  6  7 </span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt; 44 31 33 26 42 44 50</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co"># show the ions for the first injection</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10">std<span class="op">$</span>mz[index<span class="op">==</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt;   [1] 103.0547 118.0652 120.0448 125.9874 136.0492 139.9877 140.0600</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt;   [8] 140.9956 143.9602 146.1183 154.0586 155.1293 155.1294 156.0426</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#&gt;  [15] 156.1777 156.9622 157.4607 158.9638 159.1575 161.0600 161.0967</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#&gt;  [22] 161.0967 162.1128 166.2924 167.0709 168.9988 171.0960 175.0873</span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">#&gt;  [29] 181.9872 192.1487 195.1745 220.1184 220.9350 223.0652 226.1823</span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="co">#&gt;  [36] 226.1822 227.9565 232.1334 235.4382 236.9406 240.2335 242.2863</span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="co">#&gt;  [43] 242.2863 244.0288 254.2122 259.9651 261.2214 263.2015 267.0639</span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="co">#&gt;  [50] 270.3185 270.3185 270.3172 270.3185 270.3185 270.3185 271.3217</span></a>
<a class="sourceLine" id="cb8-19" data-line-number="19"><span class="co">#&gt;  [57] 271.3216 271.3216 271.9179 272.0665 272.3234 273.1685 274.8744</span></a>
<a class="sourceLine" id="cb8-20" data-line-number="20"><span class="co">#&gt;  [64] 276.1944 277.1418 277.1815 278.2482 281.0519 282.2811 283.1760</span></a>
<a class="sourceLine" id="cb8-21" data-line-number="21"><span class="co">#&gt;  [71] 284.2956 286.3101 295.1910 303.3062 307.1107 320.3322 320.8698</span></a>
<a class="sourceLine" id="cb8-22" data-line-number="22"><span class="co">#&gt;  [78] 323.3221 324.3266 325.3294 328.0824 331.0031 335.2953 336.2980</span></a>
<a class="sourceLine" id="cb8-23" data-line-number="23"><span class="co">#&gt;  [85] 337.8946 340.2606 340.3593 341.0180 352.3215 358.2640 359.2410</span></a>
<a class="sourceLine" id="cb8-24" data-line-number="24"><span class="co">#&gt;  [92] 363.3114 365.8035 368.3904 369.3534 370.3567 371.3345 372.3197</span></a>
<a class="sourceLine" id="cb8-25" data-line-number="25"><span class="co">#&gt;  [99] 377.3224 378.9015 379.2844 383.1282 383.2052 383.2804 383.3671</span></a>
<a class="sourceLine" id="cb8-26" data-line-number="26"><span class="co">#&gt; [106] 384.3350 385.3484 386.2783 387.1807 387.2851 389.2529 393.2199</span></a>
<a class="sourceLine" id="cb8-27" data-line-number="27"><span class="co">#&gt; [113] 394.3014 395.2208 399.2514 403.2859 409.3125 416.8073 420.3568</span></a>
<a class="sourceLine" id="cb8-28" data-line-number="28"><span class="co">#&gt; [120] 438.2669 439.2698 441.3330 442.3373 442.8446 446.1216 448.2959</span></a>
<a class="sourceLine" id="cb8-29" data-line-number="29"><span class="co">#&gt; [127] 452.2768 454.4255 463.1472 470.1010 477.2934 478.8354 494.8110</span></a>
<a class="sourceLine" id="cb8-30" data-line-number="30"><span class="co">#&gt; [134] 504.1096 506.3375 514.8764 520.1386 526.2952 526.4841 527.2976</span></a>
<a class="sourceLine" id="cb8-31" data-line-number="31"><span class="co">#&gt; [141] 528.4989 532.8946 537.3405 538.3150 538.3435 540.1628 541.1208</span></a>
<a class="sourceLine" id="cb8-32" data-line-number="32"><span class="co">#&gt; [148] 541.3942 542.1221 542.3991 543.4015 545.3435 546.3560 546.8234</span></a>
<a class="sourceLine" id="cb8-33" data-line-number="33"><span class="co">#&gt; [155] 549.2836 557.0950 559.1521 559.5175 561.3616 566.1776 575.4280</span></a>
<a class="sourceLine" id="cb8-34" data-line-number="34"><span class="co">#&gt; [162] 582.1904 590.3223 619.6137 620.4358 621.4412 623.4241 624.8488</span></a>
<a class="sourceLine" id="cb8-35" data-line-number="35"><span class="co">#&gt; [169] 634.8774 638.3081 642.1942 644.4936 650.8519 657.4778 663.4529</span></a>
<a class="sourceLine" id="cb8-36" data-line-number="36"><span class="co">#&gt; [176] 664.4577 677.8593 689.8645 691.4631 695.6533 702.6369 705.1376</span></a>
<a class="sourceLine" id="cb8-37" data-line-number="37"><span class="co">#&gt; [183] 705.7223 707.8415 708.4889 709.3670 712.8208 715.5204 716.5241</span></a>
<a class="sourceLine" id="cb8-38" data-line-number="38"><span class="co">#&gt; [190] 722.4391 723.8579 727.4611 730.3384 731.6537 732.5472 734.8119</span></a>
<a class="sourceLine" id="cb8-39" data-line-number="39"><span class="co">#&gt; [197] 736.4916 736.8574 737.8603 744.8477 750.6089 752.5158 758.3546</span></a>
<a class="sourceLine" id="cb8-40" data-line-number="40"><span class="co">#&gt; [204] 766.3701 773.6523 786.8255 791.5414 825.6769 825.8384 830.6313</span></a>
<a class="sourceLine" id="cb8-41" data-line-number="41"><span class="co">#&gt; [211] 831.6352 832.3212 837.6840 841.5715 847.8263 853.7083 861.5014</span></a>
<a class="sourceLine" id="cb8-42" data-line-number="42"><span class="co">#&gt; [218] 867.4427 869.8223 871.3033 884.4968 900.3092 903.8164 908.8258</span></a>
<a class="sourceLine" id="cb8-43" data-line-number="43"><span class="co">#&gt; [225] 917.7920 927.8191 929.4891 930.1575 934.3019 938.7728 943.7976</span></a>
<a class="sourceLine" id="cb8-44" data-line-number="44"><span class="co">#&gt; [232] 946.7398 946.8063 950.1442 952.4848 952.7628 962.3132 968.2956</span></a>
<a class="sourceLine" id="cb8-45" data-line-number="45"><span class="co">#&gt; [239] 970.7962 973.4945 975.1471 975.3138 976.8122 983.7978 985.4324</span></a>
<a class="sourceLine" id="cb8-46" data-line-number="46"><span class="co">#&gt; [246] 991.7894 998.7737</span></a>
<a class="sourceLine" id="cb8-47" data-line-number="47">std<span class="op">$</span>rt[index<span class="op">==</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb8-48" data-line-number="48"><span class="co">#&gt;   [1]  348.1340  639.2070  511.7220 1079.6500  212.7820   84.8490  511.0515</span></a>
<a class="sourceLine" id="cb8-49" data-line-number="49"><span class="co">#&gt;   [8]   86.3490   85.4930  288.1300  212.6560  775.8610  804.4690  218.6020</span></a>
<a class="sourceLine" id="cb8-50" data-line-number="50"><span class="co">#&gt;  [15]  405.3890  145.5380  144.3705  213.7130  470.3640  620.6270  645.5280</span></a>
<a class="sourceLine" id="cb8-51" data-line-number="51"><span class="co">#&gt;  [22]  490.7225  256.1585  511.2940  538.2950  135.4660  226.2130  511.2940</span></a>
<a class="sourceLine" id="cb8-52" data-line-number="52"><span class="co">#&gt;  [29]   48.8480  611.4120  594.4850  170.8240  213.8030  467.3650  611.4120</span></a>
<a class="sourceLine" id="cb8-53" data-line-number="53"><span class="co">#&gt;  [36]  416.1050  213.7270  403.6780  144.0400  147.8960  639.1010  747.3660</span></a>
<a class="sourceLine" id="cb8-54" data-line-number="54"><span class="co">#&gt;  [43]  611.4110  212.6665  451.6785  145.9660  556.7660  592.9810  568.7680</span></a>
<a class="sourceLine" id="cb8-55" data-line-number="55"><span class="co">#&gt;  [50]  538.0815  880.3720    4.0610  447.3925  838.9070  802.2200  669.4930</span></a>
<a class="sourceLine" id="cb8-56" data-line-number="56"><span class="co">#&gt;  [57]  715.1720  781.0040   76.1710  141.0400  742.6450  336.5620  218.5540</span></a>
<a class="sourceLine" id="cb8-57" data-line-number="57"><span class="co">#&gt;  [64]  482.4720  482.5790  588.6960  559.5550  762.5750  639.1000  170.3910</span></a>
<a class="sourceLine" id="cb8-58" data-line-number="58"><span class="co">#&gt;  [71]    3.9535  732.0395  518.1520  639.1000  212.7520  639.0990  218.2260</span></a>
<a class="sourceLine" id="cb8-59" data-line-number="59"><span class="co">#&gt;  [78]  639.3130  628.9860  629.1980  560.1960  509.3650  582.6960  582.2700</span></a>
<a class="sourceLine" id="cb8-60" data-line-number="60"><span class="co">#&gt;  [85]  145.4960  340.8480  658.6000  717.1835  551.4120  480.8010  213.7505</span></a>
<a class="sourceLine" id="cb8-61" data-line-number="61"><span class="co">#&gt;  [92]  561.2685  639.2065  682.3870  688.3880  688.3880  551.7325  659.8815</span></a>
<a class="sourceLine" id="cb8-62" data-line-number="62"><span class="co">#&gt;  [99]  594.6960  215.8460  573.0530  577.9840  574.3400  547.0180  699.7440</span></a>
<a class="sourceLine" id="cb8-63" data-line-number="63"><span class="co">#&gt; [106]  656.0105  644.4580  493.3975  482.3650  492.8650  383.1060  613.5540</span></a>
<a class="sourceLine" id="cb8-64" data-line-number="64"><span class="co">#&gt; [113]  659.6710  613.7680  551.4100  570.0540  611.4140  503.1515  655.9035</span></a>
<a class="sourceLine" id="cb8-65" data-line-number="65"><span class="co">#&gt; [120]  639.3140  639.3130  656.0280  404.5340  643.3840  717.1020  404.7480</span></a>
<a class="sourceLine" id="cb8-66" data-line-number="66"><span class="co">#&gt; [127]  482.3650  628.5540  717.0775  717.1020  705.3160  218.1010  830.5500</span></a>
<a class="sourceLine" id="cb8-67" data-line-number="67"><span class="co">#&gt; [134]  762.5750  423.1770  215.7020  762.5750  493.5080  638.9925  493.5080</span></a>
<a class="sourceLine" id="cb8-68" data-line-number="68"><span class="co">#&gt; [141]  643.4925  213.5300  537.2230  520.8340  537.2240  762.3620  762.5770</span></a>
<a class="sourceLine" id="cb8-69" data-line-number="69"><span class="co">#&gt; [148]  439.6770  762.5760  439.6780  439.2500  511.0800  529.0810  218.1225</span></a>
<a class="sourceLine" id="cb8-70" data-line-number="70"><span class="co">#&gt; [155]  461.7930  762.5765  161.3970  705.7430  457.8285  762.5770  213.0735</span></a>
<a class="sourceLine" id="cb8-71" data-line-number="71"><span class="co">#&gt; [162]  762.4675  510.4370  618.4840  531.0080  531.0090  455.1505  215.9880</span></a>
<a class="sourceLine" id="cb8-72" data-line-number="72"><span class="co">#&gt; [169]  213.7270  630.7000  818.7645  454.9370  215.6410  468.6500  800.2900</span></a>
<a class="sourceLine" id="cb8-73" data-line-number="73"><span class="co">#&gt; [176]  800.0760  214.8145  213.4215  525.0090  639.3120  639.1000  639.2070</span></a>
<a class="sourceLine" id="cb8-74" data-line-number="74"><span class="co">#&gt; [183]  658.8150  214.2010  525.0090  481.2940  214.7985  481.0790  481.0790</span></a>
<a class="sourceLine" id="cb8-75" data-line-number="75"><span class="co">#&gt; [190]  573.0545  213.5020  538.8305  213.3840  595.1270  481.0785  216.7260</span></a>
<a class="sourceLine" id="cb8-76" data-line-number="76"><span class="co">#&gt; [197]  714.7460  213.5090  213.6305  214.3560  624.2710  522.4370  213.5120</span></a>
<a class="sourceLine" id="cb8-77" data-line-number="77"><span class="co">#&gt; [204]  462.0070  613.5550  215.4870  780.1460  628.5550  213.4215  628.4490</span></a>
<a class="sourceLine" id="cb8-78" data-line-number="78"><span class="co">#&gt; [211]  628.3420  213.5140  646.7070  517.2940  214.7070  646.6610  213.3395</span></a>
<a class="sourceLine" id="cb8-79" data-line-number="79"><span class="co">#&gt; [218]  494.3650  213.5020  639.2070  213.3590  213.5480  213.5020  213.6560</span></a>
<a class="sourceLine" id="cb8-80" data-line-number="80"><span class="co">#&gt; [225]  215.2080  213.5105  213.3110  213.5310  213.6405  216.4125  214.0705</span></a>
<a class="sourceLine" id="cb8-81" data-line-number="81"><span class="co">#&gt; [232]  800.2900  213.6155  213.3340  213.4230  654.3150  213.6560  213.5120</span></a>
<a class="sourceLine" id="cb8-82" data-line-number="82"><span class="co">#&gt; [239]  213.9110  500.9015  213.4215  213.5480  213.8565  214.6300  388.0330</span></a>
<a class="sourceLine" id="cb8-83" data-line-number="83"><span class="co">#&gt; [246]  215.3500  215.6570</span></a></code></pre></div>
</div>
<div id="validation-by-principal-components-analysispca" class="section level3">
<h3 class="hasAnchor">
<a href="#validation-by-principal-components-analysispca" class="anchor"></a>Validation by principal components analysis(PCA)</h3>
<p>You need to check the GlobalStd algorithmâ€™s results by principal components analysis(PCA).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(enviGCMS)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html">plotpca</a></span>(std<span class="op">$</span>data,<span class="dt">lv =</span> <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(std<span class="op">$</span>group)),<span class="dt">main =</span> <span class="kw"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="kw"><a href="https://rdrr.io/r/grDevices/plotmath.html">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(all peaks)"</span>)))</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html">plotpca</a></span>(std<span class="op">$</span>data[std<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(std<span class="op">$</span>group)),<span class="dt">main =</span> <span class="kw"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="kw"><a href="https://rdrr.io/r/grDevices/plotmath.html">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))</a></code></pre></div>
<p><img src="globalstd_files/figure-html/pca-1.png" width="700"></p>
</div>
<div id="comparision-with-other-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#comparision-with-other-packages" class="anchor"></a>Comparision with other packages</h3>
<p>GlobalStd algorithm in <code>pmd</code> package could be treated as a way to extract pseudospectra. You could use <code>getcluster</code> to get peaks groups information for all GlobalStd peaks. Then you could choose export peaks with the highest intensities in each GlobalStd peaks groups.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">stdcluster &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getcluster.html">getcluster</a></span>(std)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co"># extract pseudospectra for std peak 71</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(stdcluster<span class="op">$</span>cluster<span class="op">$</span>mz[stdcluster<span class="op">$</span>cluster<span class="op">$</span>i<span class="op">==</span><span class="dv">71</span>],stdcluster<span class="op">$</span>cluster<span class="op">$</span>ins[stdcluster<span class="op">$</span>cluster<span class="op">$</span>i<span class="op">==</span><span class="dv">71</span>],<span class="dt">type =</span> <span class="st">'h'</span>,<span class="dt">xlab =</span> <span class="st">'m/z'</span>,<span class="dt">ylab =</span> <span class="st">'intensity'</span>,<span class="dt">main =</span> <span class="st">'pseudospectra for GlobalStd peak 711'</span>)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/comp-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># export peaks with the highest intensities in each GlobalStd peaks groups.</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">data &lt;-<span class="st"> </span>stdcluster<span class="op">$</span>data[stdcluster<span class="op">$</span>stdmassindex2,]</a></code></pre></div>
<p>You could also use <code>getcorcluster</code> to find peaks groups by correlation analysis only.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">corcluster &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getcorcluster.html">getcorcluster</a></span>(spmeinvivo)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co">#&gt; 75 retention time cluster found.</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html">plotpca</a></span>(std<span class="op">$</span>data,<span class="dt">lv =</span> <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(std<span class="op">$</span>group)),<span class="dt">main =</span> <span class="kw"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="kw"><a href="https://rdrr.io/r/grDevices/plotmath.html">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(all peaks)"</span>)))</a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html">plotpca</a></span>(std<span class="op">$</span>data[std<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(std<span class="op">$</span>group)),<span class="dt">main =</span> <span class="kw"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="kw"><a href="https://rdrr.io/r/grDevices/plotmath.html">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))</a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html">plotpca</a></span>(std<span class="op">$</span>data[corcluster<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(std<span class="op">$</span>group)),<span class="dt">main =</span> <span class="kw"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="kw"><a href="https://rdrr.io/r/grDevices/plotmath.html">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks by correlationship)"</span>)))</a></code></pre></div>
<p><img src="globalstd_files/figure-html/corcomp-1.png" width="700"></p>
</div>
<div id="globalstd-algorithm-with-intensity-data" class="section level3">
<h3 class="hasAnchor">
<a href="#globalstd-algorithm-with-intensity-data" class="anchor"></a>GlobalStd algorithm with intensity data</h3>
<p>GlobalStd algorithm is designed to analysis data without intensity data. However, if you have intensity data, the independant peaks could be selected with more confindence. You could set up cutoff of Pearson Correlation Coefficient between peaks to refine the peaks selected by GlobalStd within same retention time groups.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">std2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getstd.html">getstd</a></span>(pmd,<span class="dt">corcutoff =</span> <span class="fl">0.9</span>)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="co">#&gt; 8 retention group(s) have single peaks. 14 23 32 33 54 55 56 75</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="co">#&gt; 24 group(s) with multiple peaks while no isotope/paired relationship 2 4 5 7 8 10 11 15 18 22 26 35 39 41 42 49 50 59 62 68 69 70 72 73</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co">#&gt; 13 group(s) with multiple peaks with isotope without paired relationship 9 12 24 27 28 34 51 52 57 60 64 66 71</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="co">#&gt; 3 group(s) with paired relationship without isotope 1 53 74</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co">#&gt; 27 group(s) with paired relationship and isotope 3 6 13 16 17 19 20 21 25 29 30 31 36 37 38 40 43 44 45 46 47 48 58 61 63 65 67</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="co">#&gt; 118 std mass found.</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="kw"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html">plotpca</a></span>(std2<span class="op">$</span>data,<span class="dt">lv =</span> <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(std2<span class="op">$</span>group)),<span class="dt">main =</span> <span class="kw"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="kw"><a href="https://rdrr.io/r/grDevices/plotmath.html">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(all peaks)"</span>)))</a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="kw"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html">plotpca</a></span>(std<span class="op">$</span>data[std<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(std<span class="op">$</span>group)),<span class="dt">main =</span> <span class="kw"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="kw"><a href="https://rdrr.io/r/grDevices/plotmath.html">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))</a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="kw"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html">plotpca</a></span>(std2<span class="op">$</span>data[std2<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(std2<span class="op">$</span>group)),<span class="dt">main =</span> <span class="kw"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="kw"><a href="https://rdrr.io/r/grDevices/plotmath.html">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))</a></code></pre></div>
<p><img src="globalstd_files/figure-html/globalcor-1.png" width="700"></p>
</div>
</div>
<div id="structurereaction-directed-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#structurereaction-directed-analysis" class="anchor"></a>Structure/Reaction directed analysis</h2>
<p><code>getsda</code> function could be used to perform Structure/reaction directed analysis. <code>freqcutoff</code> could be used to filter the PMD with high frequncy.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">sda &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getsda.html">getsda</a></span>(std, <span class="dt">freqcutoff =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="co">#&gt; Top 50 high frequency PMD groups were remained.</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="co">#&gt; 20 groups were found as high frequency PMD group.</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="co">#&gt; 0 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="co">#&gt; 1.98 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">#&gt; 2.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="co">#&gt; 13.98 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="co">#&gt; 14.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="co">#&gt; 14.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="co">#&gt; 15.99 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"><span class="co">#&gt; 16.03 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12"><span class="co">#&gt; 28.03 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13"><span class="co">#&gt; 30.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="co">#&gt; 42.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-15" data-line-number="15"><span class="co">#&gt; 49.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-16" data-line-number="16"><span class="co">#&gt; 58.04 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-17" data-line-number="17"><span class="co">#&gt; 66.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-18" data-line-number="18"><span class="co">#&gt; 68.06 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-19" data-line-number="19"><span class="co">#&gt; 74.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-20" data-line-number="20"><span class="co">#&gt; 82.08 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-21" data-line-number="21"><span class="co">#&gt; 88.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-22" data-line-number="22"><span class="co">#&gt; 116.08 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-23" data-line-number="23"><span class="co">#&gt; 126.14 were found as high frequency PMD.</span></a></code></pre></div>
<p>You could use <code>plotstdsda</code> to show the distribution of the selected paired peaks.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/stdsda-1.png" width="700"></p>
<p>You could also use index to show the distribution of certain PMDs.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>,<span class="dv">3</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">13.98</span>)</a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">15.99</span>)</a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">14.02</span>)</a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">28.03</span>)</a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">58.04</span>)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/stdsdaidx-1.png" width="700"></p>
<p>Structure/reaction directed analysis could be directily performed on all the peaks, which is slow to process:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">sdaall &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getsda.html">getsda</a></span>(spmeinvivo)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>,<span class="dv">3</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">13.98</span>)</a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">15.99</span>)</a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">14.02</span>)</a>
<a class="sourceLine" id="cb17-7" data-line-number="7"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">28.03</span>)</a>
<a class="sourceLine" id="cb17-8" data-line-number="8"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">58.04</span>)</a></code></pre></div>
<div id="structurereaction-directed-analysis-for-peakscompounds-only" class="section level3">
<h3 class="hasAnchor">
<a href="#structurereaction-directed-analysis-for-peakscompounds-only" class="anchor"></a>Structure/reaction directed analysis for peaks/compounds only</h3>
<p>When you only have data of peaks without retention time or compounds list, structure/reaction directed analysis could also be done by <code>getrda</code> function.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">sda &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getrda.html">getrda</a></span>(spmeinvivo<span class="op">$</span>mz[std<span class="op">$</span>stdmassindex])</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="co">#&gt; 31441 pmd found.</span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="co">#&gt; 9 pmd used.</span></a></code></pre></div>
</div>
<div id="structurereaction-network" class="section level3">
<h3 class="hasAnchor">
<a href="#structurereaction-network" class="anchor"></a>Structure/Reaction Network</h3>
<p>One peak or compounds could be involved in multiple reactions. You could construct a network by such relationship.</p>
<p>If you have a specific compound and want to check the metabolites of certain PMD, you could use <code>getchain</code> to extract the network of that compounds</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(igraph)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="co">#&gt; Attaching package: 'igraph'</span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="co">#&gt; The following objects are masked from 'package:stats':</span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="co">#&gt;     decompose, spectrum</span></a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="co">#&gt; The following object is masked from 'package:base':</span></a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb19-9" data-line-number="9"><span class="co">#&gt;     union</span></a>
<a class="sourceLine" id="cb19-10" data-line-number="10"><span class="co"># check metabolites of C18H39NO</span></a>
<a class="sourceLine" id="cb19-11" data-line-number="11">chain &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getchain.html">getchain</a></span>(spmeinvivo,<span class="dt">diff =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2.02</span>,<span class="fl">14.02</span>,<span class="fl">15.99</span>,<span class="fl">58.04</span>,<span class="fl">13.98</span>),<span class="dt">mass =</span> <span class="fl">286.3101</span>,<span class="dt">digits =</span> <span class="dv">2</span>,<span class="dt">corcutoff =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb19-12" data-line-number="12"><span class="co"># show as network</span></a>
<a class="sourceLine" id="cb19-13" data-line-number="13">net &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html">graph_from_data_frame</a></span>(chain<span class="op">$</span>sdac,<span class="dt">directed =</span> F)</a>
<a class="sourceLine" id="cb19-14" data-line-number="14">pal &lt;-<span class="st"> </span>(grDevices<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rev.html">rev</a></span>(RColorBrewer<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span>(<span class="dv">11</span>,<span class="st">"RdYlBu"</span>)</a>
<a class="sourceLine" id="cb19-15" data-line-number="15">                )))(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb19-16" data-line-number="16"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(net,<span class="dt">vertex.label=</span><span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span>(net)<span class="op">$</span>name),<span class="dv">2</span>),<span class="dt">vertex.size =</span><span class="dv">5</span>,<span class="dt">edge.width =</span> <span class="dv">5</span>,<span class="dt">edge.color =</span> pal[<span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span>(net)<span class="op">$</span>diff2))],<span class="dt">vertex.label.dist=</span><span class="dv">1</span>,<span class="dt">vertex.color=</span><span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span>(net)<span class="op">$</span>name),<span class="dv">4</span>) <span class="op">%in%</span><span class="st"> </span><span class="fl">286.3101</span>,<span class="st">'red'</span>,<span class="st">'black'</span>),<span class="dt">main =</span> <span class="st">'PMD network'</span>)</a>
<a class="sourceLine" id="cb19-17" data-line-number="17"><span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>,<span class="dt">bty =</span> <span class="st">"n"</span>,</a>
<a class="sourceLine" id="cb19-18" data-line-number="18">       <span class="dt">legend=</span><span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span>(net)<span class="op">$</span>diff2),</a>
<a class="sourceLine" id="cb19-19" data-line-number="19">       <span class="dt">fill=</span><span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(pal[<span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span>(net)<span class="op">$</span>diff2))]), <span class="dt">border=</span><span class="ot">NA</span>,<span class="dt">horiz =</span> F)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/tarnet-1.png" width="700"></p>
<p>If you want to see all the independant peaksâ€™ high frequency PMDs as a network, the following code will help</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">sda &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getsda.html">getsda</a></span>(std, <span class="dt">freqcutoff =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="co">#&gt; Top 50 high frequency PMD groups were remained.</span></a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="co">#&gt; 20 groups were found as high frequency PMD group.</span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="co">#&gt; 0 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="co">#&gt; 1.98 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6"><span class="co">#&gt; 2.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="co">#&gt; 13.98 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="co">#&gt; 14.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="co">#&gt; 14.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-10" data-line-number="10"><span class="co">#&gt; 15.99 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-11" data-line-number="11"><span class="co">#&gt; 16.03 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-12" data-line-number="12"><span class="co">#&gt; 28.03 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-13" data-line-number="13"><span class="co">#&gt; 30.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-14" data-line-number="14"><span class="co">#&gt; 42.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-15" data-line-number="15"><span class="co">#&gt; 49.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-16" data-line-number="16"><span class="co">#&gt; 58.04 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-17" data-line-number="17"><span class="co">#&gt; 66.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-18" data-line-number="18"><span class="co">#&gt; 68.06 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-19" data-line-number="19"><span class="co">#&gt; 74.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-20" data-line-number="20"><span class="co">#&gt; 82.08 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-21" data-line-number="21"><span class="co">#&gt; 88.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-22" data-line-number="22"><span class="co">#&gt; 116.08 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-23" data-line-number="23"><span class="co">#&gt; 126.14 were found as high frequency PMD.</span></a>
<a class="sourceLine" id="cb20-24" data-line-number="24">df &lt;-<span class="st"> </span>sda<span class="op">$</span>sda</a>
<a class="sourceLine" id="cb20-25" data-line-number="25">net &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html">graph_from_data_frame</a></span>(df,<span class="dt">directed =</span> F)</a>
<a class="sourceLine" id="cb20-26" data-line-number="26">pal &lt;-<span class="st"> </span>(grDevices<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rev.html">rev</a></span>(RColorBrewer<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span>(<span class="dv">11</span>,<span class="st">"RdYlBu"</span>)</a>
<a class="sourceLine" id="cb20-27" data-line-number="27">                )))(<span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span>(net)<span class="op">$</span>diff2)))</a>
<a class="sourceLine" id="cb20-28" data-line-number="28"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(net,<span class="dt">vertex.label=</span><span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span>(net)<span class="op">$</span>name)),<span class="dt">vertex.size =</span> <span class="dv">7</span>,<span class="dt">edge.width =</span> <span class="dv">5</span>,<span class="dt">edge.color =</span> pal[<span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span>(net)<span class="op">$</span>diff2))],<span class="dt">main =</span> <span class="st">'PMD network'</span>)</a>
<a class="sourceLine" id="cb20-29" data-line-number="29"><span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>,<span class="dt">bty =</span> <span class="st">"n"</span>,</a>
<a class="sourceLine" id="cb20-30" data-line-number="30">       <span class="dt">legend=</span><span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span>(net)<span class="op">$</span>diff2),</a>
<a class="sourceLine" id="cb20-31" data-line-number="31">       <span class="dt">fill=</span><span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(pal[<span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span>(net)<span class="op">$</span>diff2))]), <span class="dt">border=</span><span class="ot">NA</span>,<span class="dt">horiz =</span> F)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/net-1.png" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="co"># Check the degree of the nodes</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="co"># Show the degree distribution of the vertices</span></a>
<a class="sourceLine" id="cb21-3" data-line-number="3">deg &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/igraph/man/degree.html">degree</a></span>(net, <span class="dt">mode=</span><span class="st">"all"</span>)</a>
<a class="sourceLine" id="cb21-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/pkg/igraph/man/degree.html">degree_distribution</a></span>(net)</a>
<a class="sourceLine" id="cb21-5" data-line-number="5"><span class="co">#&gt;  [1] 0.000000000 0.286764706 0.257352941 0.095588235 0.088235294</span></a>
<a class="sourceLine" id="cb21-6" data-line-number="6"><span class="co">#&gt;  [6] 0.058823529 0.036764706 0.058823529 0.036764706 0.044117647</span></a>
<a class="sourceLine" id="cb21-7" data-line-number="7"><span class="co">#&gt; [11] 0.007352941 0.000000000 0.007352941 0.000000000 0.000000000</span></a>
<a class="sourceLine" id="cb21-8" data-line-number="8"><span class="co">#&gt; [16] 0.000000000 0.014705882 0.000000000 0.000000000 0.000000000</span></a>
<a class="sourceLine" id="cb21-9" data-line-number="9"><span class="co">#&gt; [21] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000</span></a>
<a class="sourceLine" id="cb21-10" data-line-number="10"><span class="co">#&gt; [26] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000</span></a>
<a class="sourceLine" id="cb21-11" data-line-number="11"><span class="co">#&gt; [31] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000</span></a>
<a class="sourceLine" id="cb21-12" data-line-number="12"><span class="co">#&gt; [36] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000</span></a>
<a class="sourceLine" id="cb21-13" data-line-number="13"><span class="co">#&gt; [41] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000</span></a>
<a class="sourceLine" id="cb21-14" data-line-number="14"><span class="co">#&gt; [46] 0.000000000 0.000000000 0.000000000 0.007352941</span></a>
<a class="sourceLine" id="cb21-15" data-line-number="15"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(net, <span class="dt">vertex.size=</span>deg<span class="op">/</span><span class="dv">2</span>,<span class="dt">vertex.label=</span><span class="ot">NA</span>,<span class="dt">vertex.size =</span> <span class="dv">7</span>, <span class="dt">edge.width =</span> <span class="dv">5</span>)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/net-2.png" width="700"></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="co"># network community structure detection</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2">ceb &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/igraph/man/cluster_edge_betweenness.html">cluster_edge_betweenness</a></span>(net,<span class="dt">weights =</span> <span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span>(net)<span class="op">$</span>cor), <span class="dt">directed =</span> F) </a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="co">#&gt; Warning in cluster_edge_betweenness(net, weights = abs(E(net)$cor),</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="co">#&gt; directed = F): At community.c:460 :Membership vector will be selected based</span></a>
<a class="sourceLine" id="cb22-5" data-line-number="5"><span class="co">#&gt; on the lowest modularity score.</span></a>
<a class="sourceLine" id="cb22-6" data-line-number="6"><span class="co">#&gt; Warning in cluster_edge_betweenness(net, weights = abs(E(net)$cor),</span></a>
<a class="sourceLine" id="cb22-7" data-line-number="7"><span class="co">#&gt; directed = F): At community.c:467 :Modularity calculation with weighted</span></a>
<a class="sourceLine" id="cb22-8" data-line-number="8"><span class="co">#&gt; edge betweenness community detection might not make sense -- modularity</span></a>
<a class="sourceLine" id="cb22-9" data-line-number="9"><span class="co">#&gt; treats edge weights as similarities while edge betwenness treats them as</span></a>
<a class="sourceLine" id="cb22-10" data-line-number="10"><span class="co">#&gt; distances</span></a>
<a class="sourceLine" id="cb22-11" data-line-number="11"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(ceb, net,<span class="dt">vertex.label=</span><span class="ot">NA</span>,) </a></code></pre></div>
<p><img src="globalstd_files/figure-html/net-3.png" width="700"></p>
</div>
</div>
<div id="parameters-selection" class="section level2">
<h2 class="hasAnchor">
<a href="#parameters-selection" class="anchor"></a>Parameters selection</h2>
<p>Retention time cluster cutoff should fit the peak picking algorithm. For HPLC, 10 is suggested and 5 could be used for UPLC.</p>
<p>Global PMDâ€™s retention time group numbers should be around 20 percent of the retention time cluster numbers. For example, if you find 100 retention time clusters, I suggested you use 20 as the empirical global PMDâ€™s retention time group numbers.</p>
<p>As for the cutoff of the frequency of PMDs, you could change the frequency until you find certain PMD which youâ€™re sure that it should appear in your dataset. For example, 16 should be considered as a good start. Any pmd with the frequency larger than PMD 16 could be further discussed.</p>
<p>Another important hint is that pre-filter your peak list by black samples or other quality control samples. Otherwise the running time would be long and lots of pmd relationship would be just from noise.</p>
</div>
<div id="wrap-function" class="section level2">
<h2 class="hasAnchor">
<a href="#wrap-function" class="anchor"></a>Wrap function</h2>
<p><code>globalstd</code> function is a wrap funtion to process GlobalStd algorithm and structure/reaction directed analysis in one line. All the plot function could be directly used on the <code>list</code> objects from <code>globalstd</code> function.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">result &lt;-<span class="st"> </span><span class="kw"><a href="../reference/globalstd.html">globalstd</a></span>(spmeinvivo)</a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="co">#&gt; 75 retention time cluster found.</span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="co">#&gt; 376 paired masses found</span></a>
<a class="sourceLine" id="cb23-4" data-line-number="4"><span class="co">#&gt; 9 unique within RT clusters high frequency PMD(s) used for further investigation.</span></a>
<a class="sourceLine" id="cb23-5" data-line-number="5"><span class="co">#&gt; 649 isotopologue(s) related paired mass found.</span></a>
<a class="sourceLine" id="cb23-6" data-line-number="6"><span class="co">#&gt; 685 multi-charger(s) related paired mass found.</span></a>
<a class="sourceLine" id="cb23-7" data-line-number="7"><span class="co">#&gt; 8 retention group(s) have single peaks. 14 23 32 33 54 55 56 75</span></a>
<a class="sourceLine" id="cb23-8" data-line-number="8"><span class="co">#&gt; 11 group(s) with multiple peaks while no isotope/paired relationship 4 5 7 8 11 41 42 49 68 72 73</span></a>
<a class="sourceLine" id="cb23-9" data-line-number="9"><span class="co">#&gt; 9 group(s) with multiple peaks with isotope without paired relationship 2 9 22 26 52 62 64 66 70</span></a>
<a class="sourceLine" id="cb23-10" data-line-number="10"><span class="co">#&gt; 4 group(s) with paired relationship without isotope 1 10 15 18</span></a>
<a class="sourceLine" id="cb23-11" data-line-number="11"><span class="co">#&gt; 43 group(s) with paired relationship and isotope 3 6 12 13 16 17 19 20 21 24 25 27 28 29 30 31 34 35 36 37 38 39 40 43 44 45 46 47 48 50 51 53 57 58 59 60 61 63 65 67 69 71 74</span></a>
<a class="sourceLine" id="cb23-12" data-line-number="12"><span class="co">#&gt; 270 std mass found.</span></a>
<a class="sourceLine" id="cb23-13" data-line-number="13"><span class="co">#&gt; Top 50 high frequency PMD groups were remained.</span></a>
<a class="sourceLine" id="cb23-14" data-line-number="14"><span class="co">#&gt; 20 groups were found as high frequency PMD group.</span></a>
<a class="sourceLine" id="cb23-15" data-line-number="15"><span class="co">#&gt; 0 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-16" data-line-number="16"><span class="co">#&gt; 1.98 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-17" data-line-number="17"><span class="co">#&gt; 2.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-18" data-line-number="18"><span class="co">#&gt; 13.98 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-19" data-line-number="19"><span class="co">#&gt; 14.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-20" data-line-number="20"><span class="co">#&gt; 14.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-21" data-line-number="21"><span class="co">#&gt; 15.99 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-22" data-line-number="22"><span class="co">#&gt; 16.03 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-23" data-line-number="23"><span class="co">#&gt; 28.03 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-24" data-line-number="24"><span class="co">#&gt; 30.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-25" data-line-number="25"><span class="co">#&gt; 42.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-26" data-line-number="26"><span class="co">#&gt; 49.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-27" data-line-number="27"><span class="co">#&gt; 58.04 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-28" data-line-number="28"><span class="co">#&gt; 66.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-29" data-line-number="29"><span class="co">#&gt; 68.06 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-30" data-line-number="30"><span class="co">#&gt; 74.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-31" data-line-number="31"><span class="co">#&gt; 82.08 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-32" data-line-number="32"><span class="co">#&gt; 88.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-33" data-line-number="33"><span class="co">#&gt; 116.08 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-34" data-line-number="34"><span class="co">#&gt; 126.14 were found as high frequency PMD.</span></a></code></pre></div>
</div>
<div id="shiny-application" class="section level2">
<h2 class="hasAnchor">
<a href="#shiny-application" class="anchor"></a>Shiny application</h2>
<p>An interactive document has been included in this package to perform PMD analysis. You need to prepare a csv file with m/z and retention time of peaks. Such csv file could be generated by run <code><a href="https://rdrr.io/pkg/enviGCMS/man/getmzrtcsv.html">enviGCMS::getmzrtcsv()</a></code> on the <code>list</code> object from <code><a href="https://rdrr.io/pkg/enviGCMS/man/getmzrt.html">enviGCMS::getmzrt(xset)</a></code> or <code><a href="https://rdrr.io/pkg/enviGCMS/man/getmzrt2.html">enviGCMS::getmzrt2(xset)</a></code> function. You could also generate the csv file by <code><a href="https://rdrr.io/pkg/enviGCMS/man/getmzrt.html">enviGCMS::getmzrt(xset,name = 'test')</a></code> or <code><a href="https://rdrr.io/pkg/enviGCMS/man/getmzrt2.html">enviGCMS::getmzrt2(xset, name = 'test')</a></code>. You will find the csv file in the working dictionary named <code>test.csv</code>.</p>
<p>Then you could run <code><a href="../reference/runPMD.html">runPMD()</a></code> to start the Graphical user interface(GUI) for GlobalStd algorithm and structure/reaction directed analysis. The PMD network for certain compound could be generated by run <code><a href="../reference/runPMDnet.html">runPMDnet()</a></code>.</p>
</div>
<div id="conclusion" class="section level2">
<h2 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h2>
<p><code>pmd</code> package could be used to reduce the redundancy peaks for GC/LC-MS based research and perform structure/reaction directed analysis to screen known and unknown important compounds or reactions.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction-of-paired-mass-distance-analysis">Introduction of Paired Mass Distance analysis</a></li>
      <li><a href="#data-format">Data format</a></li>
      <li><a href="#globalstd-algorithm">GlobalStd algorithm</a></li>
      <li><a href="#structurereaction-directed-analysis">Structure/Reaction directed analysis</a></li>
      <li><a href="#parameters-selection">Parameters selection</a></li>
      <li><a href="#wrap-function">Wrap function</a></li>
      <li><a href="#shiny-application">Shiny application</a></li>
      <li><a href="#conclusion">Conclusion</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Miao YU.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
