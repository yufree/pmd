<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis • pmd</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-58201304-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-58201304-1');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pmd</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/globalstd.html">Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis</h1>
                        <h4 class="author">Miao Yu</h4>
            
            <h4 class="date">2019-08-21</h4>
      
      
      <div class="hidden name"><code>globalstd.Rmd</code></div>

    </div>

    
    
<div id="introduction-of-paired-mass-distance-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction-of-paired-mass-distance-analysis" class="anchor"></a>Introduction of Paired Mass Distance analysis</h2>
<p><code>pmd</code> package use Paired Mass Distance (PMD) relationship to analysis the GC/LC-MS based non-targeted data. PMD means the distance between two masses or mass to charge ratios. In mass spectrometry, PMD would keep the same between two masses or two mass to charge ratios(m/z). There are twe kinds of PMD involved in this package: PMD within same retention time group and PMD from different retention time groups.</p>
<div id="pmd-within-same-retention-time-group" class="section level3">
<h3 class="hasAnchor">
<a href="#pmd-within-same-retention-time-group" class="anchor"></a>PMD within same retention time group</h3>
<p>In GC/LC-MS based non-targeted analysis, peaks could be seperated by chromatograph. We could build retention time(RT) bins to assign peaks into different RT groups by retention time hierarchical clustering analysis. For each RT group, the peaks should come from same compounds or co-elutes. If certain PMD appeared in multiple RT groups, it would be related to the relationship about adducts, neutral loss, isotopologues or commen fragments ions.</p>
</div>
<div id="pmd-from-different-retention-time-groups" class="section level3">
<h3 class="hasAnchor">
<a href="#pmd-from-different-retention-time-groups" class="anchor"></a>PMD from different retention time groups</h3>
<p>The peaks from different retention time groups would like to be different compounds seperated by chromatograph. The PMD would reflect the relationship about homologous series or chemical reactions.</p>
<p>GlobalStd algorithm use the PMD within same RT group to find independent peaks among certain dataset. Structure/reaction directed analysis use PMD from different RT groups to screen important compounds or reactions.</p>
</div>
</div>
<div id="data-format" class="section level2">
<h2 class="hasAnchor">
<a href="#data-format" class="anchor"></a>Data format</h2>
<p>The input data should be a <code>list</code> object with at least two elements from a peaks list:</p>
<ul>
<li>mass to charge ratio with name of <code>mz</code>, high resolution mass spectrometry is required</li>
<li>retention time with name of <code>rt</code>
</li>
</ul>
<p>However, I suggested to add intensity and group information to the list for validation of PMD analysis.</p>
<p>In this package, a dataset from <em>in vivo</em> solid phase micro-extraction(SPME) was attached. This dataset contain 9 samples from 3 fish with triplicates samples for each fish. Here is the data strcture:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(pmd)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"spmeinvivo"</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(spmeinvivo)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt; List of 4</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#&gt;  $ data : num [1:1459, 1:9] 1095 10439 10154 2797 90211 ...</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt;   .. ..$ : chr [1:1459] "100.1/170" "100.5/86" "101/85" "103.1/348" ...</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt;   .. ..$ : chr [1:9] "1405_Fish1_F1" "1405_Fish1_F2" "1405_Fish1_F3" "1405_Fish2_F1" ...</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt;  $ group: chr [1:9] "fish1" "fish1" "fish1" "fish2" ...</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt;  $ mz   : num [1:1459] 100 101 101 103 104 ...</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">#&gt;  $ rt   : num [1:1459] 170.2 86.3 84.9 348.1 48.8 ...</span></a></code></pre></div>
<p>You could build this <code>list</code> object from the <code>xcms</code> objects via <code>enviGCMS</code> package. When you have a <code>xcmsSet</code> object or <code>XCMSnExp</code> object named <code>xset</code>, you could use <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt">enviGCMS::getmzrt(xset)</a></code> or <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt2">enviGCMS::getmzrt2(xset)</a></code> to get such list. Of course you could build such list by yourself.</p>
</div>
<div id="globalstd-algorithm" class="section level2">
<h2 class="hasAnchor">
<a href="#globalstd-algorithm" class="anchor"></a>GlobalStd algorithm</h2>
<p>GlobalStd algorithm try to find independent peaks among certain peaks list. The first step is retention time hierarchical clustering analysis. The second step is to find the relationship among adducts, neutral loss, isotopologues and commen fragments ions. The third step is to screen the independent peaks.</p>
<div id="retention-time-hierarchical-clustering" class="section level3">
<h3 class="hasAnchor">
<a href="#retention-time-hierarchical-clustering" class="anchor"></a>Retention time hierarchical clustering</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">pmd &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getpaired.html">getpaired</a></span>(spmeinvivo, <span class="dt">rtcutoff =</span> <span class="dv">10</span>, <span class="dt">ng =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt; 75 retention time cluster found.</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#&gt; 376 paired masses found</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt; 9 unique within RT clusters high frequency PMD(s) used for further investigation.</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt; 649 isotopologue(s) related paired mass found.</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; 685 multi-charger(s) related paired mass found.</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="kw"><a href="../reference/plotrtg.html">plotrtg</a></span>(pmd)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/rtg-1.png" width="700"></p>
<p>This plot would show the distribution of RT groups. The <code>rtcutoff</code> in function <code>getpaired</code> could be used to set the cutoff of the distances in retention time hierarchical clustering analysis.</p>
</div>
<div id="relationship-among-adducts-neutral-loss-isotopologues-and-commen-fragments-ions" class="section level3">
<h3 class="hasAnchor">
<a href="#relationship-among-adducts-neutral-loss-isotopologues-and-commen-fragments-ions" class="anchor"></a>Relationship among adducts, neutral loss, isotopologues and commen fragments ions</h3>
<p>The <code>ng</code> in function <code>getpaired</code> could be used to set cutoff of global PMD’s retention time group numbers. If <code>ng</code> is 10, at least 10 of the retention time groups should contain the shown PMD relationship. You could use <code>plotpaired</code> to show the distribution.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="../reference/plotpaired.html">plotpaired</a></span>(pmd)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/pmd-1.png" width="700"></p>
<p>You could also show the distribution of PMD relationship by index:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># show the unique PMD found by getpaired function</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(pmd<span class="op">$</span>paired<span class="op">$</span>diff2))){</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">        diff &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(pmd<span class="op">$</span>paired<span class="op">$</span>diff2)[i]</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">        index &lt;-<span class="st"> </span>pmd<span class="op">$</span>paired<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span>diff</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">        <span class="kw"><a href="../reference/plotpaired.html">plotpaired</a></span>(pmd,index)</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">}</a></code></pre></div>
<p><img src="globalstd_files/figure-html/pmdindex-1.png" width="700"><img src="globalstd_files/figure-html/pmdindex-2.png" width="700"><img src="globalstd_files/figure-html/pmdindex-3.png" width="700"><img src="globalstd_files/figure-html/pmdindex-4.png" width="700"><img src="globalstd_files/figure-html/pmdindex-5.png" width="700"><img src="globalstd_files/figure-html/pmdindex-6.png" width="700"><img src="globalstd_files/figure-html/pmdindex-7.png" width="700"><img src="globalstd_files/figure-html/pmdindex-8.png" width="700"><img src="globalstd_files/figure-html/pmdindex-9.png" width="700"></p>
</div>
<div id="screen-the-independent-peaks" class="section level3">
<h3 class="hasAnchor">
<a href="#screen-the-independent-peaks" class="anchor"></a>Screen the independent peaks</h3>
<p>You could use <code>getstd</code> function to get the independent peaks.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">std &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getstd.html">getstd</a></span>(pmd)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt; 8 retention group(s) have single peaks. 14 23 32 33 54 55 56 75</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt; 11 group(s) with multiple peaks while no isotope/paired relationship 4 5 7 8 11 41 42 49 68 72 73</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt; 9 group(s) with multiple peaks with isotope without paired relationship 2 9 22 26 52 62 64 66 70</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; 4 group(s) with paired relationship without isotope 1 10 15 18</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; 43 group(s) with paired relationship and isotope 3 6 12 13 16 17 19 20 21 24 25 27 28 29 30 31 34 35 36 37 38 39 40 43 44 45 46 47 48 50 51 53 57 58 59 60 61 63 65 67 69 71 74</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt; 270 std mass found.</span></a></code></pre></div>
<p>Here you could plot the peaks by <code>plotstd</code> function to show the distribution of independent peaks:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="../reference/plotstd.html">plotstd</a></span>(std)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/stdplot-1.png" width="700"></p>
<p>You could also plot the peaks distribution by assign a retention time group via <code>plotstdrt</code>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">23</span>,<span class="dt">main =</span> <span class="st">'Retention time group 23'</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">9</span>,<span class="dt">main =</span> <span class="st">'Retention time group 9'</span>)</a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">18</span>,<span class="dt">main =</span> <span class="st">'Retention time group 18'</span>)</a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">67</span>,<span class="dt">main =</span> <span class="st">'Retention time group 67'</span>)</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">49</span>,<span class="dt">main =</span> <span class="st">'Retention time group 49'</span>)</a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">6</span>,<span class="dt">main =</span> <span class="st">'Retention time group 6'</span>)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/stdrtplot-1.png" width="700"></p>
</div>
<div id="use-independent-peaks-for-msms-validation" class="section level3">
<h3 class="hasAnchor">
<a href="#use-independent-peaks-for-msms-validation" class="anchor"></a>Use independent peaks for MS/MS validation</h3>
<p>Independent peaks are supporsing generated from different compounds. We could use those peaks for MS/MS analysis instead of DIA or DDA. Here we need multiple injections for one sample since it might be impossible to get all ions’ fragmental ions in one injection with good sensitivity. You could use <code>gettarget</code> to generate the index for the injections and output the peaks for each run.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># you need retention time for independent peaks</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">index &lt;-<span class="st"> </span><span class="kw"><a href="../reference/gettarget.html">gettarget</a></span>(std<span class="op">$</span>rt[std<span class="op">$</span>stdmassindex])</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&gt; You need 7 injections!</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co"># output the ions for each injection</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/table">table</a></span>(index)</a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt; index</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt;  1  2  3  4  5  6  7 </span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt; 43 55 49 41 32 32 18</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co"># show the ions for the first injection</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10">std<span class="op">$</span>mz[index<span class="op">==</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt;   [1] 100.5107 104.1082 112.0183 134.1185 137.9884 138.1031 139.0591</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt;   [8] 141.9594 147.1175 149.0236 153.1277 156.1777 157.4607 162.0558</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#&gt;  [15] 165.0787 166.0867 170.0932 172.9566 173.1335 188.6484 192.1380</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#&gt;  [22] 192.1487 193.1632 195.1138 197.9893 198.1853 201.2040 203.0532</span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">#&gt;  [29] 204.1239 204.1391 205.1954 208.1693 208.1696 209.1552 229.2008</span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="co">#&gt;  [36] 236.1626 240.2335 244.0288 244.1300 244.1921 247.2072 249.1869</span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="co">#&gt;  [43] 252.0510 252.9981 255.1591 257.9694 265.4216 268.1893 269.2687</span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="co">#&gt;  [50] 269.9189 270.3185 270.3185 270.3185 270.3185 271.9179 272.3234</span></a>
<a class="sourceLine" id="cb8-19" data-line-number="19"><span class="co">#&gt;  [57] 277.1817 280.1630 280.2641 283.3000 285.3002 285.3002 300.1148</span></a>
<a class="sourceLine" id="cb8-20" data-line-number="20"><span class="co">#&gt;  [64] 303.2325 303.3062 305.1578 307.0973 308.0887 308.2953 309.1672</span></a>
<a class="sourceLine" id="cb8-21" data-line-number="21"><span class="co">#&gt;  [71] 309.2046 309.2279 309.3159 310.3117 311.1865 311.2377 311.2560</span></a>
<a class="sourceLine" id="cb8-22" data-line-number="22"><span class="co">#&gt;  [78] 329.0928 335.3135 337.8946 341.0180 341.0937 341.2662 342.0183</span></a>
<a class="sourceLine" id="cb8-23" data-line-number="23"><span class="co">#&gt;  [85] 344.3500 349.3476 351.3455 352.9085 356.3423 365.1361 367.3375</span></a>
<a class="sourceLine" id="cb8-24" data-line-number="24"><span class="co">#&gt;  [92] 368.3169 368.3395 371.3173 373.2203 375.2147 377.2696 383.2052</span></a>
<a class="sourceLine" id="cb8-25" data-line-number="25"><span class="co">#&gt;  [99] 383.3671 387.3532 392.2873 392.3131 398.2762 399.3940 400.3301</span></a>
<a class="sourceLine" id="cb8-26" data-line-number="26"><span class="co">#&gt; [106] 413.2687 416.3062 416.8073 418.3398 420.3193 422.2952 424.8970</span></a>
<a class="sourceLine" id="cb8-27" data-line-number="27"><span class="co">#&gt; [113] 426.2189 426.3146 427.1184 428.3378 429.3192 429.8709 430.0895</span></a>
<a class="sourceLine" id="cb8-28" data-line-number="28"><span class="co">#&gt; [120] 430.3765 447.3469 453.3436 463.1472 478.8354 479.2613 480.3100</span></a>
<a class="sourceLine" id="cb8-29" data-line-number="29"><span class="co">#&gt; [127] 485.2901 491.3195 494.8112 494.8113 497.3440 501.3829 517.8314</span></a>
<a class="sourceLine" id="cb8-30" data-line-number="30"><span class="co">#&gt; [134] 521.3439 524.1178 525.9831 528.4109 533.9698 534.9708 537.1654</span></a>
<a class="sourceLine" id="cb8-31" data-line-number="31"><span class="co">#&gt; [141] 541.1208 542.1221 547.5201 555.2922 556.4416 560.4165 562.1811</span></a>
<a class="sourceLine" id="cb8-32" data-line-number="32"><span class="co">#&gt; [148] 563.3761 579.2935 581.3659 582.1904 584.8611 589.5800 593.5980</span></a>
<a class="sourceLine" id="cb8-33" data-line-number="33"><span class="co">#&gt; [155] 594.3765 597.8743 598.8366 599.4366 599.4370 600.8824 603.4105</span></a>
<a class="sourceLine" id="cb8-34" data-line-number="34"><span class="co">#&gt; [162] 604.4152 605.2231 636.8788 642.8627 650.8519 664.4577 664.4627</span></a>
<a class="sourceLine" id="cb8-35" data-line-number="35"><span class="co">#&gt; [169] 665.4444 666.8256 669.3724 675.6790 676.8604 679.4600 684.2033</span></a>
<a class="sourceLine" id="cb8-36" data-line-number="36"><span class="co">#&gt; [176] 699.8553 703.3651 704.6384 704.8667 708.3638 709.5932 710.8511</span></a>
<a class="sourceLine" id="cb8-37" data-line-number="37"><span class="co">#&gt; [183] 712.2190 723.8579 730.3384 737.3591 739.6479 740.8400 757.8509</span></a>
<a class="sourceLine" id="cb8-38" data-line-number="38"><span class="co">#&gt; [190] 759.2230 760.8210 779.3404 786.5069 786.8255 788.5237 791.1193</span></a>
<a class="sourceLine" id="cb8-39" data-line-number="39"><span class="co">#&gt; [197] 793.6270 794.8123 796.5418 797.5461 798.3265 799.8284 801.8376</span></a>
<a class="sourceLine" id="cb8-40" data-line-number="40"><span class="co">#&gt; [204] 803.5434 804.5530 804.8442 839.8413 848.6295 861.5014 871.3033</span></a>
<a class="sourceLine" id="cb8-41" data-line-number="41"><span class="co">#&gt; [211] 871.8053 872.3052 873.3057 873.8334 880.8217 883.7184 884.7221</span></a>
<a class="sourceLine" id="cb8-42" data-line-number="42"><span class="co">#&gt; [218] 889.8086 915.3139 922.7991 925.4477 925.7373 932.4055 940.8177</span></a>
<a class="sourceLine" id="cb8-43" data-line-number="43"><span class="co">#&gt; [225] 941.7605 942.7638 952.4848 962.3132 975.8147 982.7763 982.8002</span></a>
<a class="sourceLine" id="cb8-44" data-line-number="44"><span class="co">#&gt; [232] 997.8091</span></a>
<a class="sourceLine" id="cb8-45" data-line-number="45">std<span class="op">$</span>rt[index<span class="op">==</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb8-46" data-line-number="46"><span class="co">#&gt;   [1]   86.3490  254.2280   85.3860  355.8470  817.6920  874.6950  511.2940</span></a>
<a class="sourceLine" id="cb8-47" data-line-number="47"><span class="co">#&gt;   [8] 1079.4300  611.4110  583.7690  524.9460  405.3890  144.3705  430.6780</span></a>
<a class="sourceLine" id="cb8-48" data-line-number="48"><span class="co">#&gt;  [15]  511.3690  511.2940  235.9920  129.4890  611.4120  639.2075  462.2210</span></a>
<a class="sourceLine" id="cb8-49" data-line-number="49"><span class="co">#&gt;  [22]  611.4120  337.6330  169.9680  145.5380  639.3130  521.5790  144.8840</span></a>
<a class="sourceLine" id="cb8-50" data-line-number="50"><span class="co">#&gt;  [29]  370.8900  563.8380  639.1010  611.4110  415.6780  611.4120  614.6260</span></a>
<a class="sourceLine" id="cb8-51" data-line-number="51"><span class="co">#&gt;  [36]  430.6770  639.1010  212.6665  504.6540  614.8420  606.2690  645.4960</span></a>
<a class="sourceLine" id="cb8-52" data-line-number="52"><span class="co">#&gt;  [43]  606.2680  509.7940  482.5790  146.3970  145.8285  452.5345  639.1010</span></a>
<a class="sourceLine" id="cb8-53" data-line-number="53"><span class="co">#&gt;  [50]  144.6810  572.8400  564.9110  767.5050  681.3155   76.1710  742.6450</span></a>
<a class="sourceLine" id="cb8-54" data-line-number="54"><span class="co">#&gt;  [57]  491.1510  583.7700  576.6950  679.6010  631.8765  670.6010  447.6060</span></a>
<a class="sourceLine" id="cb8-55" data-line-number="55"><span class="co">#&gt;  [64]  586.1240  639.1000  169.8415  475.5070  549.6960  601.1260  237.5130</span></a>
<a class="sourceLine" id="cb8-56" data-line-number="56"><span class="co">#&gt;  [71]  600.9120  360.5630  594.0550  618.4820  495.2220  596.4120  585.6975</span></a>
<a class="sourceLine" id="cb8-57" data-line-number="57"><span class="co">#&gt;  [78]  212.3870  608.1990  145.4960  717.1835  574.0185  564.2670  717.1025</span></a>
<a class="sourceLine" id="cb8-58" data-line-number="58"><span class="co">#&gt;  [85]  638.9930  659.2440  626.0920  144.0390  594.4830  578.1970  644.2420</span></a>
<a class="sourceLine" id="cb8-59" data-line-number="59"><span class="co">#&gt;  [92]  570.0560  644.2430  659.6710  424.8935  218.8600  557.8390  574.3400</span></a>
<a class="sourceLine" id="cb8-60" data-line-number="60"><span class="co">#&gt;  [99]  699.7440  644.6705  665.0280  567.4840  492.2220  595.0195  582.3750</span></a>
<a class="sourceLine" id="cb8-61" data-line-number="61"><span class="co">#&gt; [106]  512.7510  503.1510  503.1515  582.2680  687.8085  639.5290  213.7130</span></a>
<a class="sourceLine" id="cb8-62" data-line-number="62"><span class="co">#&gt; [113]  601.1275  404.5330  519.0090  547.1240  557.1970  145.2170  717.1010</span></a>
<a class="sourceLine" id="cb8-63" data-line-number="63"><span class="co">#&gt; [120]  704.8880  711.4240  170.5045  717.0775  218.1010  557.4110  513.6510</span></a>
<a class="sourceLine" id="cb8-64" data-line-number="64"><span class="co">#&gt; [127]  582.6970  401.9620  803.7190  862.5875  536.5865  422.9630  144.7890</span></a>
<a class="sourceLine" id="cb8-65" data-line-number="65"><span class="co">#&gt; [134]  515.0340  690.5290  639.0980  422.7495  639.2075  639.0995  762.5740</span></a>
<a class="sourceLine" id="cb8-66" data-line-number="66"><span class="co">#&gt; [141]  762.5770  762.5760  627.8060  512.7070  546.9100  537.8650  762.3630</span></a>
<a class="sourceLine" id="cb8-67" data-line-number="67"><span class="co">#&gt; [148]  439.4630  583.7680  533.7950  762.4675  215.7865  889.0520  772.2180</span></a>
<a class="sourceLine" id="cb8-68" data-line-number="68"><span class="co">#&gt; [155]  561.2680  213.2320  216.9670  454.9350  632.6270  213.5090  530.7950</span></a>
<a class="sourceLine" id="cb8-69" data-line-number="69"><span class="co">#&gt; [162]  529.9730  762.5750  213.7425  214.5700  215.6410  800.0760  527.7950</span></a>
<a class="sourceLine" id="cb8-70" data-line-number="70"><span class="co">#&gt; [169]  449.3220  216.7620  213.5285  638.8870  214.3560  468.4360  883.2670</span></a>
<a class="sourceLine" id="cb8-71" data-line-number="71"><span class="co">#&gt; [176]  213.3340  213.5480  639.0980  213.9270  481.0780  619.9850  214.4150</span></a>
<a class="sourceLine" id="cb8-72" data-line-number="72"><span class="co">#&gt; [183]  883.6945  213.5020  213.3840  213.5480  639.1005  213.7855  213.2940</span></a>
<a class="sourceLine" id="cb8-73" data-line-number="73"><span class="co">#&gt; [190]  700.1720  215.6320  214.9615  692.8890  215.4870  730.6470  639.9560</span></a>
<a class="sourceLine" id="cb8-74" data-line-number="74"><span class="co">#&gt; [197]  613.5555  215.7855  519.8660  519.7585  213.7260  214.1780  213.5020</span></a>
<a class="sourceLine" id="cb8-75" data-line-number="75"><span class="co">#&gt; [204]  665.0290  631.5555  213.5090  213.7720  503.2585  213.3395  639.2070</span></a>
<a class="sourceLine" id="cb8-76" data-line-number="76"><span class="co">#&gt; [211]  639.1000  639.0990  639.2070  213.5090  214.2320  632.1990  632.0920</span></a>
<a class="sourceLine" id="cb8-77" data-line-number="77"><span class="co">#&gt; [218]  215.2605  214.9660  215.2830  476.5790  636.9560  380.5340  213.5480</span></a>
<a class="sourceLine" id="cb8-78" data-line-number="78"><span class="co">#&gt; [225]  636.9310  636.9060  213.4230  213.6560  213.7270  640.2780  214.4360</span></a>
<a class="sourceLine" id="cb8-79" data-line-number="79"><span class="co">#&gt; [232]  213.3590</span></a></code></pre></div>
</div>
<div id="validation-by-principal-components-analysispca" class="section level3">
<h3 class="hasAnchor">
<a href="#validation-by-principal-components-analysispca" class="anchor"></a>Validation by principal components analysis(PCA)</h3>
<p>You need to check the GlobalStd algorithm’s results by principal components analysis(PCA).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(enviGCMS)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data,<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(std<span class="op">$</span>group)),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(all peaks)"</span>)))</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data[std<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(std<span class="op">$</span>group)),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))</a></code></pre></div>
<p><img src="globalstd_files/figure-html/pca-1.png" width="700"></p>
</div>
<div id="comparision-with-other-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#comparision-with-other-packages" class="anchor"></a>Comparision with other packages</h3>
<p>GlobalStd algorithm in <code>pmd</code> package could be treated as a way to extract pseudospectra. You could use <code>getcluster</code> to get peaks groups information for all GlobalStd peaks. Then you could choose export peaks with the highest intensities in each GlobalStd peaks groups.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">stdcluster &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getcluster.html">getcluster</a></span>(std)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co"># extract pseudospectra for std peak 71</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(stdcluster<span class="op">$</span>cluster<span class="op">$</span>mz[stdcluster<span class="op">$</span>cluster<span class="op">$</span>i<span class="op">==</span><span class="dv">71</span>],stdcluster<span class="op">$</span>cluster<span class="op">$</span>ins[stdcluster<span class="op">$</span>cluster<span class="op">$</span>i<span class="op">==</span><span class="dv">71</span>],<span class="dt">type =</span> <span class="st">'h'</span>,<span class="dt">xlab =</span> <span class="st">'m/z'</span>,<span class="dt">ylab =</span> <span class="st">'intensity'</span>,<span class="dt">main =</span> <span class="st">'pseudospectra for GlobalStd peak 711'</span>)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/comp-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># export peaks with the highest intensities in each GlobalStd peaks groups.</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">data &lt;-<span class="st"> </span>stdcluster<span class="op">$</span>data[stdcluster<span class="op">$</span>stdmassindex2,]</a></code></pre></div>
<p>You could also use <code>getcorcluster</code> to find peaks groups by correlation analysis only.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">corcluster &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getcorcluster.html">getcorcluster</a></span>(spmeinvivo)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co">#&gt; 75 retention time cluster found.</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data,<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(std<span class="op">$</span>group)),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(all peaks)"</span>)))</a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data[std<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(std<span class="op">$</span>group)),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))</a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data[corcluster<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(std<span class="op">$</span>group)),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks by correlationship)"</span>)))</a></code></pre></div>
<p><img src="globalstd_files/figure-html/corcomp-1.png" width="700"></p>
</div>
<div id="globalstd-algorithm-with-intensity-data" class="section level3">
<h3 class="hasAnchor">
<a href="#globalstd-algorithm-with-intensity-data" class="anchor"></a>GlobalStd algorithm with intensity data</h3>
<p>GlobalStd algorithm is designed to analysis data without intensity data. However, if you have intensity data, the independant peaks could be selected with more confindence. You could set up cutoff of Pearson Correlation Coefficient between peaks to refine the peaks selected by GlobalStd within same retention time groups.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">std2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getstd.html">getstd</a></span>(pmd,<span class="dt">corcutoff =</span> <span class="fl">0.9</span>)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="co">#&gt; 8 retention group(s) have single peaks. 14 23 32 33 54 55 56 75</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="co">#&gt; 24 group(s) with multiple peaks while no isotope/paired relationship 2 4 5 7 8 10 11 15 18 22 26 35 39 41 42 49 50 59 62 68 69 70 72 73</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co">#&gt; 13 group(s) with multiple peaks with isotope without paired relationship 9 12 24 27 28 34 51 52 57 60 64 66 71</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="co">#&gt; 3 group(s) with paired relationship without isotope 1 53 74</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co">#&gt; 27 group(s) with paired relationship and isotope 3 6 13 16 17 19 20 21 25 29 30 31 36 37 38 40 43 44 45 46 47 48 58 61 63 65 67</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="co">#&gt; 118 std mass found.</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std2<span class="op">$</span>data,<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(std2<span class="op">$</span>group)),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(all peaks)"</span>)))</a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data[std<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(std<span class="op">$</span>group)),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))</a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std2<span class="op">$</span>data[std2<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(std2<span class="op">$</span>group)),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))</a></code></pre></div>
<p><img src="globalstd_files/figure-html/globalcor-1.png" width="700"></p>
</div>
</div>
<div id="structurereaction-directed-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#structurereaction-directed-analysis" class="anchor"></a>Structure/Reaction directed analysis</h2>
<p><code>getsda</code> function could be used to perform Structure/reaction directed analysis. <code>freqcutoff</code> could be used to filter the PMD with high frequncy.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">sda &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getsda.html">getsda</a></span>(std, <span class="dt">freqcutoff =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="co">#&gt; Top 50 high frequency PMD groups were remained.</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="co">#&gt; 20 groups were found as high frequency PMD group.</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="co">#&gt; 0 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="co">#&gt; 1.98 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">#&gt; 2.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="co">#&gt; 13.98 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="co">#&gt; 14.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="co">#&gt; 14.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="co">#&gt; 15.99 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"><span class="co">#&gt; 16.03 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12"><span class="co">#&gt; 28.03 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13"><span class="co">#&gt; 30.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="co">#&gt; 42.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-15" data-line-number="15"><span class="co">#&gt; 49.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-16" data-line-number="16"><span class="co">#&gt; 58.04 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-17" data-line-number="17"><span class="co">#&gt; 66.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-18" data-line-number="18"><span class="co">#&gt; 68.06 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-19" data-line-number="19"><span class="co">#&gt; 74.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-20" data-line-number="20"><span class="co">#&gt; 82.08 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-21" data-line-number="21"><span class="co">#&gt; 88.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-22" data-line-number="22"><span class="co">#&gt; 116.08 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-23" data-line-number="23"><span class="co">#&gt; 126.14 were found as high frequency PMD.</span></a></code></pre></div>
<p>You could use <code>plotstdsda</code> to show the distribution of the selected paired peaks.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/stdsda-1.png" width="700"></p>
<p>You could also use index to show the distribution of certain PMDs.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>,<span class="dv">3</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">13.98</span>)</a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">15.99</span>)</a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">14.02</span>)</a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">28.03</span>)</a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">58.04</span>)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/stdsdaidx-1.png" width="700"></p>
<p>Structure/reaction directed analysis could be directily performed on all the peaks, which is slow to process:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">sdaall &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getsda.html">getsda</a></span>(spmeinvivo)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>,<span class="dv">3</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">13.98</span>)</a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">15.99</span>)</a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">14.02</span>)</a>
<a class="sourceLine" id="cb17-7" data-line-number="7"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">28.03</span>)</a>
<a class="sourceLine" id="cb17-8" data-line-number="8"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">58.04</span>)</a></code></pre></div>
<div id="structurereaction-directed-analysis-for-peakscompounds-only" class="section level3">
<h3 class="hasAnchor">
<a href="#structurereaction-directed-analysis-for-peakscompounds-only" class="anchor"></a>Structure/reaction directed analysis for peaks/compounds only</h3>
<p>When you only have data of peaks without retention time or compounds list, structure/reaction directed analysis could also be done by <code>getrda</code> function.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">sda &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getrda.html">getrda</a></span>(spmeinvivo<span class="op">$</span>mz[std<span class="op">$</span>stdmassindex])</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="co">#&gt; 31441 pmd found.</span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="co">#&gt; 9 pmd used.</span></a></code></pre></div>
</div>
<div id="structurereaction-network" class="section level3">
<h3 class="hasAnchor">
<a href="#structurereaction-network" class="anchor"></a>Structure/Reaction Network</h3>
<p>One peak or compounds could be involved in multiple reactions. You could construct a network by such relationship.</p>
<p>If you have a specific compound and want to check the metabolites of certain PMD, you could use <code>getchain</code> to extract the network of that compounds</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(igraph)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="co">#&gt; Attaching package: 'igraph'</span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="co">#&gt; The following objects are masked from 'package:stats':</span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="co">#&gt;     decompose, spectrum</span></a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="co">#&gt; The following object is masked from 'package:base':</span></a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb19-9" data-line-number="9"><span class="co">#&gt;     union</span></a>
<a class="sourceLine" id="cb19-10" data-line-number="10"><span class="co"># check metabolites of C18H39NO</span></a>
<a class="sourceLine" id="cb19-11" data-line-number="11">chain &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getchain.html">getchain</a></span>(spmeinvivo,<span class="dt">diff =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">2.02</span>,<span class="fl">14.02</span>,<span class="fl">15.99</span>,<span class="fl">58.04</span>,<span class="fl">13.98</span>),<span class="dt">mass =</span> <span class="fl">286.3101</span>)</a>
<a class="sourceLine" id="cb19-12" data-line-number="12"><span class="co"># show as network</span></a>
<a class="sourceLine" id="cb19-13" data-line-number="13">net &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/graph_from_data_frame">graph_from_data_frame</a></span>(chain<span class="op">$</span>sdac,<span class="dt">directed =</span> F)</a>
<a class="sourceLine" id="cb19-14" data-line-number="14"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(net,<span class="dt">vertex.label=</span><span class="ot">NA</span>,<span class="dt">vertex.size =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>((<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/V">V</a></span>(net))))<span class="op">/</span><span class="dv">25</span>,<span class="dt">edge.width =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/E">E</a></span>(net)<span class="op">$</span>diff2<span class="op">/</span><span class="dv">20</span><span class="fl">+0.00001</span>)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/tarnet-1.png" width="700"></p>
<p>If you want to see all the independant peaks’ high frequency PMDs as a network, the following code will help</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">sda &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getsda.html">getsda</a></span>(std, <span class="dt">freqcutoff =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="co">#&gt; Top 50 high frequency PMD groups were remained.</span></a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="co">#&gt; 20 groups were found as high frequency PMD group.</span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="co">#&gt; 0 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="co">#&gt; 1.98 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6"><span class="co">#&gt; 2.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="co">#&gt; 13.98 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="co">#&gt; 14.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="co">#&gt; 14.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-10" data-line-number="10"><span class="co">#&gt; 15.99 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-11" data-line-number="11"><span class="co">#&gt; 16.03 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-12" data-line-number="12"><span class="co">#&gt; 28.03 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-13" data-line-number="13"><span class="co">#&gt; 30.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-14" data-line-number="14"><span class="co">#&gt; 42.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-15" data-line-number="15"><span class="co">#&gt; 49.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-16" data-line-number="16"><span class="co">#&gt; 58.04 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-17" data-line-number="17"><span class="co">#&gt; 66.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-18" data-line-number="18"><span class="co">#&gt; 68.06 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-19" data-line-number="19"><span class="co">#&gt; 74.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-20" data-line-number="20"><span class="co">#&gt; 82.08 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-21" data-line-number="21"><span class="co">#&gt; 88.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-22" data-line-number="22"><span class="co">#&gt; 116.08 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-23" data-line-number="23"><span class="co">#&gt; 126.14 were found as high frequency PMD.</span></a>
<a class="sourceLine" id="cb20-24" data-line-number="24">df &lt;-<span class="st"> </span>sda<span class="op">$</span>sda</a>
<a class="sourceLine" id="cb20-25" data-line-number="25">net &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/graph_from_data_frame">graph_from_data_frame</a></span>(df,<span class="dt">directed =</span> F)</a>
<a class="sourceLine" id="cb20-26" data-line-number="26"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(net,<span class="dt">vertex.label=</span><span class="ot">NA</span>,<span class="dt">vertex.size =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>((<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/V">V</a></span>(net))))<span class="op">/</span><span class="dv">25</span>,<span class="dt">edge.width =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/E">E</a></span>(net)<span class="op">$</span>diff2<span class="op">/</span><span class="dv">20</span><span class="fl">+0.00001</span>)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/net-1.png" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="co"># Check the degree of the nodes</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="co"># Show the degree distribution of the vertices</span></a>
<a class="sourceLine" id="cb21-3" data-line-number="3">deg &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/degree">degree</a></span>(net, <span class="dt">mode=</span><span class="st">"all"</span>)</a>
<a class="sourceLine" id="cb21-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/degree">degree_distribution</a></span>(net)</a>
<a class="sourceLine" id="cb21-5" data-line-number="5"><span class="co">#&gt;  [1] 0.000000000 0.286764706 0.257352941 0.095588235 0.088235294</span></a>
<a class="sourceLine" id="cb21-6" data-line-number="6"><span class="co">#&gt;  [6] 0.058823529 0.036764706 0.058823529 0.036764706 0.044117647</span></a>
<a class="sourceLine" id="cb21-7" data-line-number="7"><span class="co">#&gt; [11] 0.007352941 0.000000000 0.007352941 0.000000000 0.000000000</span></a>
<a class="sourceLine" id="cb21-8" data-line-number="8"><span class="co">#&gt; [16] 0.000000000 0.014705882 0.000000000 0.000000000 0.000000000</span></a>
<a class="sourceLine" id="cb21-9" data-line-number="9"><span class="co">#&gt; [21] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000</span></a>
<a class="sourceLine" id="cb21-10" data-line-number="10"><span class="co">#&gt; [26] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000</span></a>
<a class="sourceLine" id="cb21-11" data-line-number="11"><span class="co">#&gt; [31] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000</span></a>
<a class="sourceLine" id="cb21-12" data-line-number="12"><span class="co">#&gt; [36] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000</span></a>
<a class="sourceLine" id="cb21-13" data-line-number="13"><span class="co">#&gt; [41] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000</span></a>
<a class="sourceLine" id="cb21-14" data-line-number="14"><span class="co">#&gt; [46] 0.000000000 0.000000000 0.000000000 0.007352941</span></a>
<a class="sourceLine" id="cb21-15" data-line-number="15"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(net, <span class="dt">vertex.size=</span>deg<span class="op">/</span><span class="dv">2</span>,<span class="dt">vertex.label=</span><span class="ot">NA</span>,<span class="dt">vertex.size =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>((<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/V">V</a></span>(net))))<span class="op">/</span><span class="dv">25</span>, <span class="dt">edge.width =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/E">E</a></span>(net)<span class="op">$</span>diff2<span class="op">/</span><span class="dv">20</span><span class="fl">+0.00001</span>)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/net-2.png" width="700"></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="co"># network community structure detection</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2">ceb &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/cluster_edge_betweenness">cluster_edge_betweenness</a></span>(net,<span class="dt">weights =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/E">E</a></span>(net)<span class="op">$</span>cor), <span class="dt">directed =</span> F) </a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="co">#&gt; Warning in cluster_edge_betweenness(net, weights = abs(E(net)$cor),</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="co">#&gt; directed = F): At community.c:460 :Membership vector will be selected based</span></a>
<a class="sourceLine" id="cb22-5" data-line-number="5"><span class="co">#&gt; on the lowest modularity score.</span></a>
<a class="sourceLine" id="cb22-6" data-line-number="6"><span class="co">#&gt; Warning in cluster_edge_betweenness(net, weights = abs(E(net)$cor),</span></a>
<a class="sourceLine" id="cb22-7" data-line-number="7"><span class="co">#&gt; directed = F): At community.c:467 :Modularity calculation with weighted</span></a>
<a class="sourceLine" id="cb22-8" data-line-number="8"><span class="co">#&gt; edge betweenness community detection might not make sense -- modularity</span></a>
<a class="sourceLine" id="cb22-9" data-line-number="9"><span class="co">#&gt; treats edge weights as similarities while edge betwenness treats them as</span></a>
<a class="sourceLine" id="cb22-10" data-line-number="10"><span class="co">#&gt; distances</span></a>
<a class="sourceLine" id="cb22-11" data-line-number="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(ceb, net,<span class="dt">vertex.label=</span><span class="ot">NA</span>,) </a></code></pre></div>
<p><img src="globalstd_files/figure-html/net-3.png" width="700"></p>
</div>
</div>
<div id="parameters-selection" class="section level2">
<h2 class="hasAnchor">
<a href="#parameters-selection" class="anchor"></a>Parameters selection</h2>
<p>Retention time cluster cutoff should fit the peak picking algorithm. For HPLC, 10 is suggested and 5 could be used for UPLC.</p>
<p>Global PMD’s retention time group numbers should be around 20 percent of the retention time cluster numbers. For example, if you find 100 retention time clusters, I suggested you use 20 as the empirical global PMD’s retention time group numbers.</p>
<p>As for the cutoff of the frequency of PMDs, you could change the frequency until you find certain PMD which you’re sure that it should appear in your dataset. For example, 16 should be considered as a good start. Any pmd with the frequency larger than PMD 16 could be further discussed.</p>
<p>Another important hint is that pre-filter your peak list by black samples or other quality control samples. Otherwise the running time would be long and lots of pmd relationship would be just from noise.</p>
</div>
<div id="wrap-function" class="section level2">
<h2 class="hasAnchor">
<a href="#wrap-function" class="anchor"></a>Wrap function</h2>
<p><code>globalstd</code> function is a wrap funtion to process GlobalStd algorithm and structure/reaction directed analysis in one line. All the plot function could be directly used on the <code>list</code> objects from <code>globalstd</code> function.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">result &lt;-<span class="st"> </span><span class="kw"><a href="../reference/globalstd.html">globalstd</a></span>(spmeinvivo)</a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="co">#&gt; 75 retention time cluster found.</span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="co">#&gt; 376 paired masses found</span></a>
<a class="sourceLine" id="cb23-4" data-line-number="4"><span class="co">#&gt; 9 unique within RT clusters high frequency PMD(s) used for further investigation.</span></a>
<a class="sourceLine" id="cb23-5" data-line-number="5"><span class="co">#&gt; 649 isotopologue(s) related paired mass found.</span></a>
<a class="sourceLine" id="cb23-6" data-line-number="6"><span class="co">#&gt; 685 multi-charger(s) related paired mass found.</span></a>
<a class="sourceLine" id="cb23-7" data-line-number="7"><span class="co">#&gt; 8 retention group(s) have single peaks. 14 23 32 33 54 55 56 75</span></a>
<a class="sourceLine" id="cb23-8" data-line-number="8"><span class="co">#&gt; 11 group(s) with multiple peaks while no isotope/paired relationship 4 5 7 8 11 41 42 49 68 72 73</span></a>
<a class="sourceLine" id="cb23-9" data-line-number="9"><span class="co">#&gt; 9 group(s) with multiple peaks with isotope without paired relationship 2 9 22 26 52 62 64 66 70</span></a>
<a class="sourceLine" id="cb23-10" data-line-number="10"><span class="co">#&gt; 4 group(s) with paired relationship without isotope 1 10 15 18</span></a>
<a class="sourceLine" id="cb23-11" data-line-number="11"><span class="co">#&gt; 43 group(s) with paired relationship and isotope 3 6 12 13 16 17 19 20 21 24 25 27 28 29 30 31 34 35 36 37 38 39 40 43 44 45 46 47 48 50 51 53 57 58 59 60 61 63 65 67 69 71 74</span></a>
<a class="sourceLine" id="cb23-12" data-line-number="12"><span class="co">#&gt; 270 std mass found.</span></a>
<a class="sourceLine" id="cb23-13" data-line-number="13"><span class="co">#&gt; Top 50 high frequency PMD groups were remained.</span></a>
<a class="sourceLine" id="cb23-14" data-line-number="14"><span class="co">#&gt; 20 groups were found as high frequency PMD group.</span></a>
<a class="sourceLine" id="cb23-15" data-line-number="15"><span class="co">#&gt; 0 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-16" data-line-number="16"><span class="co">#&gt; 1.98 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-17" data-line-number="17"><span class="co">#&gt; 2.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-18" data-line-number="18"><span class="co">#&gt; 13.98 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-19" data-line-number="19"><span class="co">#&gt; 14.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-20" data-line-number="20"><span class="co">#&gt; 14.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-21" data-line-number="21"><span class="co">#&gt; 15.99 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-22" data-line-number="22"><span class="co">#&gt; 16.03 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-23" data-line-number="23"><span class="co">#&gt; 28.03 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-24" data-line-number="24"><span class="co">#&gt; 30.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-25" data-line-number="25"><span class="co">#&gt; 42.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-26" data-line-number="26"><span class="co">#&gt; 49.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-27" data-line-number="27"><span class="co">#&gt; 58.04 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-28" data-line-number="28"><span class="co">#&gt; 66.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-29" data-line-number="29"><span class="co">#&gt; 68.06 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-30" data-line-number="30"><span class="co">#&gt; 74.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-31" data-line-number="31"><span class="co">#&gt; 82.08 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-32" data-line-number="32"><span class="co">#&gt; 88.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-33" data-line-number="33"><span class="co">#&gt; 116.08 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-34" data-line-number="34"><span class="co">#&gt; 126.14 were found as high frequency PMD.</span></a></code></pre></div>
</div>
<div id="shiny-application" class="section level2">
<h2 class="hasAnchor">
<a href="#shiny-application" class="anchor"></a>Shiny application</h2>
<p>An interactive document has been included in this package to show PMD analysis. You could run <code><a href="../reference/runPMD.html">runPMD()</a></code> to start the Graphical user interface(GUI) for GlobalStd algorithm and structure/reaction directed analysis. You need to prepare a csv file with m/z and retention time of peaks. Such csv file could be generated by run <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrtcsv">enviGCMS::getmzrtcsv()</a></code> on the <code>list</code> object from <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt">enviGCMS::getmzrt(xset)</a></code> or <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt2">enviGCMS::getmzrt2(xset)</a></code> function. You could also generate the csv file by <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt">enviGCMS::getmzrt(xset,name = 'test')</a></code> or <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt2">enviGCMS::getmzrt2(xset, name = 'test')</a></code>. You will find the csv file in the working dictionary named <code>test.csv</code>.</p>
</div>
<div id="conclusion" class="section level2">
<h2 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h2>
<p><code>pmd</code> package could be used to reduce the redundancy peaks for GC/LC-MS based research and perform structure/reaction directed analysis to screen known and unknown important compounds or reactions.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction-of-paired-mass-distance-analysis">Introduction of Paired Mass Distance analysis</a></li>
      <li><a href="#data-format">Data format</a></li>
      <li><a href="#globalstd-algorithm">GlobalStd algorithm</a></li>
      <li><a href="#structurereaction-directed-analysis">Structure/Reaction directed analysis</a></li>
      <li><a href="#parameters-selection">Parameters selection</a></li>
      <li><a href="#wrap-function">Wrap function</a></li>
      <li><a href="#shiny-application">Shiny application</a></li>
      <li><a href="#conclusion">Conclusion</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Miao YU.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
