<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis • pmd</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis">
<meta property="og:description" content="pmd">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-58201304-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-58201304-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pmd</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/globalstd.html">Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/yufree/pmd/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis</h1>
                        <h4 class="author">Miao Yu</h4>
            
            <h4 class="date">2020-05-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/yufree/pmd/blob/master/vignettes/globalstd.Rmd"><code>vignettes/globalstd.Rmd</code></a></small>
      <div class="hidden name"><code>globalstd.Rmd</code></div>

    </div>

    
    
<div id="introduction-of-paired-mass-distance-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction-of-paired-mass-distance-analysis" class="anchor"></a>Introduction of Paired Mass Distance analysis</h2>
<p><code>pmd</code> package use Paired Mass Distance (PMD) relationship to analysis the GC/LC-MS based non-targeted data. PMD means the distance between two masses or mass to charge ratios. In mass spectrometry, PMD would keep the same between two masses or two mass to charge ratios(m/z). There are twe kinds of PMD involved in this package: PMD within same retention time group and PMD from different retention time groups.</p>
<div id="pmd-within-same-retention-time-group" class="section level3">
<h3 class="hasAnchor">
<a href="#pmd-within-same-retention-time-group" class="anchor"></a>PMD within same retention time group</h3>
<p>In GC/LC-MS based non-targeted analysis, peaks could be seperated by chromatograph. We could build retention time(RT) bins to assign peaks into different RT groups by retention time hierarchical clustering analysis. For each RT group, the peaks should come from same compounds or co-elutes. If certain PMD appeared in multiple RT groups, it would be related to the relationship about adducts, neutral loss, isotopologues or commen fragments ions.</p>
</div>
<div id="pmd-from-different-retention-time-groups" class="section level3">
<h3 class="hasAnchor">
<a href="#pmd-from-different-retention-time-groups" class="anchor"></a>PMD from different retention time groups</h3>
<p>The peaks from different retention time groups would like to be different compounds seperated by chromatograph. The PMD would reflect the relationship about homologous series or chemical reactions.</p>
<p>GlobalStd algorithm use the PMD within same RT group to find independent peaks among certain dataset. Structure/reaction directed analysis use PMD from different RT groups to screen important compounds or reactions.</p>
</div>
</div>
<div id="data-format" class="section level2">
<h2 class="hasAnchor">
<a href="#data-format" class="anchor"></a>Data format</h2>
<p>The input data should be a <code>list</code> object with at least two elements from a peaks list:</p>
<ul>
<li>mass to charge ratio with name of <code>mz</code>, high resolution mass spectrometry is required</li>
<li>retention time with name of <code>rt</code>
</li>
</ul>
<p>However, I suggested to add intensity and group information to the list for validation of PMD analysis.</p>
<p>In this package, a dataset from <em>in vivo</em> solid phase micro-extraction(SPME) was attached. This dataset contain 9 samples from 3 fish with triplicates samples for each fish. Here is the data strcture:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">pmd</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"spmeinvivo"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">spmeinvivo</span>)
<span class="co">#&gt; List of 4</span>
<span class="co">#&gt;  $ data : num [1:1459, 1:9] 1095 10439 10154 2797 90211 ...</span>
<span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span>
<span class="co">#&gt;   .. ..$ : chr [1:1459] "100.1/170" "100.5/86" "101/85" "103.1/348" ...</span>
<span class="co">#&gt;   .. ..$ : chr [1:9] "1405_Fish1_F1" "1405_Fish1_F2" "1405_Fish1_F3" "1405_Fish2_F1" ...</span>
<span class="co">#&gt;  $ group:'data.frame':   9 obs. of  2 variables:</span>
<span class="co">#&gt;   ..$ sample_name : chr [1:9] "1405_Fish1_F1" "1405_Fish1_F2" "1405_Fish1_F3" "1405_Fish2_F1" ...</span>
<span class="co">#&gt;   ..$ sample_group: chr [1:9] "fish1" "fish1" "fish1" "fish2" ...</span>
<span class="co">#&gt;  $ mz   : num [1:1459] 100 101 101 103 104 ...</span>
<span class="co">#&gt;  $ rt   : num [1:1459] 170.2 86.3 84.9 348.1 48.8 ...</span></pre></body></html></div>
<p>You could build this <code>list</code> object from the <code>xcms</code> objects via <code>enviGCMS</code> package. When you have a <code>xcmsSet</code> object or <code>XCMSnExp</code> object named <code>xset</code>, you could use <code><a href="https://rdrr.io/pkg/enviGCMS/man/getmzrt.html">enviGCMS::getmzrt(xset)</a></code> or <code><a href="https://rdrr.io/pkg/enviGCMS/man/getmzrt2.html">enviGCMS::getmzrt2(xset)</a></code> to get such list. Of course you could build such list by yourself.</p>
</div>
<div id="globalstd-algorithm" class="section level2">
<h2 class="hasAnchor">
<a href="#globalstd-algorithm" class="anchor"></a>GlobalStd algorithm</h2>
<p>GlobalStd algorithm try to find independent peaks among certain peaks list. The first step is retention time hierarchical clustering analysis. The second step is to find the relationship among adducts, neutral loss, isotopologues and commen fragments ions. The third step is to screen the independent peaks.</p>
<div id="retention-time-hierarchical-clustering" class="section level3">
<h3 class="hasAnchor">
<a href="#retention-time-hierarchical-clustering" class="anchor"></a>Retention time hierarchical clustering</h3>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">pmd</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/getpaired.html">getpaired</a></span>(<span class="no">spmeinvivo</span>, <span class="kw">rtcutoff</span> <span class="kw">=</span> <span class="fl">10</span>, <span class="kw">ng</span> <span class="kw">=</span> <span class="fl">10</span>)
<span class="co">#&gt; 75 retention time cluster found.</span>
<span class="co">#&gt; 380 paired masses found</span>
<span class="co">#&gt; 9 unique within RT clusters high frequency PMD(s) used for further investigation.</span>
<span class="co">#&gt; 719 isotopologue(s) related paired mass found.</span>
<span class="co">#&gt; 492 multi-charger(s) related paired mass found.</span>
<span class="fu"><a href="../reference/plotrtg.html">plotrtg</a></span>(<span class="no">pmd</span>)</pre></body></html></div>
<p><img src="globalstd_files/figure-html/rtg-1.png" width="700"></p>
<p>This plot would show the distribution of RT groups. The <code>rtcutoff</code> in function <code>getpaired</code> could be used to set the cutoff of the distances in retention time hierarchical clustering analysis.</p>
</div>
<div id="relationship-among-adducts-neutral-loss-isotopologues-and-commen-fragments-ions" class="section level3">
<h3 class="hasAnchor">
<a href="#relationship-among-adducts-neutral-loss-isotopologues-and-commen-fragments-ions" class="anchor"></a>Relationship among adducts, neutral loss, isotopologues and commen fragments ions</h3>
<p>The <code>ng</code> in function <code>getpaired</code> could be used to set cutoff of global PMD’s retention time group numbers. If <code>ng</code> is 10, at least 10 of the retention time groups should contain the shown PMD relationship. You could use <code>plotpaired</code> to show the distribution.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="../reference/plotpaired.html">plotpaired</a></span>(<span class="no">pmd</span>)</pre></body></html></div>
<p><img src="globalstd_files/figure-html/pmd-1.png" width="700"></p>
<p>You could also show the distribution of PMD relationship by index:</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="co"># show the unique PMD found by getpaired function</span>
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">pmd</span>$<span class="no">paired</span>$<span class="no">diff2</span>))){
        <span class="no">diff</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">pmd</span>$<span class="no">paired</span>$<span class="no">diff2</span>)[<span class="no">i</span>]
        <span class="no">index</span> <span class="kw">&lt;-</span> <span class="no">pmd</span>$<span class="no">paired</span>$<span class="no">diff2</span> <span class="kw">==</span> <span class="no">diff</span>
        <span class="fu"><a href="../reference/plotpaired.html">plotpaired</a></span>(<span class="no">pmd</span>,<span class="no">index</span>)
}</pre></body></html></div>
<p><img src="globalstd_files/figure-html/pmdindex-1.png" width="700"><img src="globalstd_files/figure-html/pmdindex-2.png" width="700"><img src="globalstd_files/figure-html/pmdindex-3.png" width="700"><img src="globalstd_files/figure-html/pmdindex-4.png" width="700"><img src="globalstd_files/figure-html/pmdindex-5.png" width="700"><img src="globalstd_files/figure-html/pmdindex-6.png" width="700"><img src="globalstd_files/figure-html/pmdindex-7.png" width="700"><img src="globalstd_files/figure-html/pmdindex-8.png" width="700"><img src="globalstd_files/figure-html/pmdindex-9.png" width="700"></p>
</div>
<div id="screen-the-independent-peaks" class="section level3">
<h3 class="hasAnchor">
<a href="#screen-the-independent-peaks" class="anchor"></a>Screen the independent peaks</h3>
<p>You could use <code>getstd</code> function to get the independent peaks.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">std</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/getstd.html">getstd</a></span>(<span class="no">pmd</span>)
<span class="co">#&gt; 8 retention group(s) have single peaks. 14 23 32 33 54 55 56 75</span>
<span class="co">#&gt; 11 group(s) with multiple peaks while no isotope/paired relationship 4 5 7 8 11 41 42 49 68 72 73</span>
<span class="co">#&gt; 9 group(s) with multiple peaks with isotope without paired relationship 2 9 22 26 52 62 64 66 70</span>
<span class="co">#&gt; 4 group(s) with paired relationship without isotope 1 10 15 18</span>
<span class="co">#&gt; 43 group(s) with paired relationship and isotope 3 6 12 13 16 17 19 20 21 24 25 27 28 29 30 31 34 35 36 37 38 39 40 43 44 45 46 47 48 50 51 53 57 58 59 60 61 63 65 67 69 71 74</span>
<span class="co">#&gt; 297 std mass found.</span></pre></body></html></div>
<p>Here you could plot the peaks by <code>plotstd</code> function to show the distribution of independent peaks:</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="../reference/plotstd.html">plotstd</a></span>(<span class="no">std</span>)</pre></body></html></div>
<p><img src="globalstd_files/figure-html/stdplot-1.png" width="700"></p>
<p>You could also plot the peaks distribution by assign a retention time group via <code>plotstdrt</code>:</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>,<span class="fl">3</span>))
<span class="fu"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(<span class="no">std</span>,<span class="kw">rtcluster</span> <span class="kw">=</span> <span class="fl">23</span>,<span class="kw">main</span> <span class="kw">=</span> <span class="st">'Retention time group 23'</span>)
<span class="fu"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(<span class="no">std</span>,<span class="kw">rtcluster</span> <span class="kw">=</span> <span class="fl">9</span>,<span class="kw">main</span> <span class="kw">=</span> <span class="st">'Retention time group 9'</span>)
<span class="fu"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(<span class="no">std</span>,<span class="kw">rtcluster</span> <span class="kw">=</span> <span class="fl">18</span>,<span class="kw">main</span> <span class="kw">=</span> <span class="st">'Retention time group 18'</span>)
<span class="fu"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(<span class="no">std</span>,<span class="kw">rtcluster</span> <span class="kw">=</span> <span class="fl">67</span>,<span class="kw">main</span> <span class="kw">=</span> <span class="st">'Retention time group 67'</span>)
<span class="fu"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(<span class="no">std</span>,<span class="kw">rtcluster</span> <span class="kw">=</span> <span class="fl">49</span>,<span class="kw">main</span> <span class="kw">=</span> <span class="st">'Retention time group 49'</span>)
<span class="fu"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(<span class="no">std</span>,<span class="kw">rtcluster</span> <span class="kw">=</span> <span class="fl">6</span>,<span class="kw">main</span> <span class="kw">=</span> <span class="st">'Retention time group 6'</span>)</pre></body></html></div>
<p><img src="globalstd_files/figure-html/stdrtplot-1.png" width="700"></p>
</div>
<div id="use-independent-peaks-for-msms-validation" class="section level3">
<h3 class="hasAnchor">
<a href="#use-independent-peaks-for-msms-validation" class="anchor"></a>Use independent peaks for MS/MS validation</h3>
<p>Independent peaks are supporsing generated from different compounds. We could use those peaks for MS/MS analysis instead of DIA or DDA. Here we need multiple injections for one sample since it might be impossible to get all ions’ fragmental ions in one injection with good sensitivity. You could use <code>gettarget</code> to generate the index for the injections and output the peaks for each run.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="co"># you need retention time for independent peaks</span>
<span class="no">index</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/gettarget.html">gettarget</a></span>(<span class="no">std</span>$<span class="no">rt</span>[<span class="no">std</span>$<span class="no">stdmassindex</span>])
<span class="co">#&gt; You need 10 injections!</span>
<span class="co"># output the ions for each injection</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">index</span>)
<span class="co">#&gt; index</span>
<span class="co">#&gt;  1  2  3  4  5  6  7  8  9 10 </span>
<span class="co">#&gt; 36 21 24 30 26 45 35 28 31 21</span>
<span class="co"># show the ions for the first injection</span>
<span class="no">std</span>$<span class="no">mz</span>[<span class="no">index</span><span class="kw">==</span><span class="fl">1</span>]
<span class="co">#&gt;   [1] 100.0763 100.5107 111.0203 132.0050 133.0794 136.0492 138.0549 139.9877</span>
<span class="co">#&gt;   [9] 140.0600 146.1183 154.0586 158.9638 162.0558 162.1128 166.4658 168.0923</span>
<span class="co">#&gt;  [17] 168.9988 170.1541 173.1335 174.1363 175.0873 180.1027 193.1597 205.1954</span>
<span class="co">#&gt;  [25] 214.9181 220.1184 226.1822 226.9522 227.9565 228.9561 229.2008 236.9406</span>
<span class="co">#&gt;  [33] 237.6615 244.1921 251.0476 252.0721 262.2258 263.2015 267.2693 270.3185</span>
<span class="co">#&gt;  [41] 270.3185 270.3184 271.3217 271.9179 272.0665 274.8744 278.2482 283.2841</span>
<span class="co">#&gt;  [49] 285.3002 286.3101 286.9218 293.1755 293.2853 295.1910 297.2985 299.9249</span>
<span class="co">#&gt;  [57] 301.9077 305.3118 311.2560 322.3185 329.2492 334.3101 336.3259 337.1058</span>
<span class="co">#&gt;  [65] 338.3435 339.3477 339.6388 342.0183 342.3637 355.0696 359.2410 362.3032</span>
<span class="co">#&gt;  [73] 372.3197 372.3478 378.9015 386.3523 387.2851 390.2490 393.2990 394.4045</span>
<span class="co">#&gt;  [81] 394.8754 399.2514 401.3421 409.1624 413.2660 414.2705 417.2462 418.9952</span>
<span class="co">#&gt;  [89] 419.3165 421.2521 425.2153 426.2189 429.2404 431.1792 444.3844 453.3436</span>
<span class="co">#&gt;  [97] 470.1010 479.2613 488.3591 492.8839 494.8112 494.8112 494.8113 502.3382</span>
<span class="co">#&gt; [105] 503.3190 520.2968 527.1586 532.3865 543.4015 544.3398 554.2887 563.1820</span>
<span class="co">#&gt; [113] 564.1885 565.3827 567.5729 568.3399 568.8923 576.4110 580.1907 590.3223</span>
<span class="co">#&gt; [121] 597.8743 599.4366 604.4152 607.4028 607.4262 611.1844 614.5358 616.4645</span>
<span class="co">#&gt; [129] 620.6167 629.8618 647.4366 665.4606 677.6839 681.4675 686.2013 689.8645</span>
<span class="co">#&gt; [137] 692.8343 695.5039 695.6533 703.6382 704.1390 714.4484 729.6484 731.8438</span>
<span class="co">#&gt; [145] 758.3546 758.4735 766.3701 776.2314 777.3853 780.8078 787.5110 788.5237</span>
<span class="co">#&gt; [153] 789.5260 793.5135 798.3265 811.5099 820.8196 825.3507 832.3212 836.3301</span>
<span class="co">#&gt; [161] 836.5243 839.1707 840.8392 841.8196 847.8263 861.5014 873.8334 889.8086</span>
<span class="co">#&gt; [169] 911.7489 917.7920 924.7999 925.7373 934.3019 938.7728 939.7749 948.8063</span>
<span class="co">#&gt; [177] 949.8072 979.7901 991.7894 998.1412</span>
<span class="no">std</span>$<span class="no">rt</span>[<span class="no">index</span><span class="kw">==</span><span class="fl">1</span>]
<span class="co">#&gt;   [1] 170.1810  86.3490  86.1350  49.4910 212.6560 212.7820 511.2940  84.8490</span>
<span class="co">#&gt;   [9] 511.0515 288.1300 212.6560 213.7130 430.6780 256.1585 144.0560 511.2940</span>
<span class="co">#&gt;  [17] 135.4660 638.9930 611.4120 611.4135 511.2940 553.3400 614.2000 639.1010</span>
<span class="co">#&gt;  [25]  76.9220 170.8240 416.1050 213.9270 213.7270 213.9650 614.6260 147.8960</span>
<span class="co">#&gt;  [33] 639.6355 614.8420 605.8400 678.3130 556.7670 592.9810 633.3765 699.3160</span>
<span class="co">#&gt;  [41] 823.9060 465.0070 699.9580  76.1710 141.0400 218.5540 559.5550 639.3120</span>
<span class="co">#&gt;  [49] 716.7800 631.8770 146.5170 553.5540 618.2710 518.1520 639.3130 146.2780</span>
<span class="co">#&gt;  [57] 144.1250 639.1000 585.6975 639.1000 596.4120 608.1990 594.9125 543.4380</span>
<span class="co">#&gt;  [65] 639.1010 639.1000 639.0990 717.1025 658.6000 819.6220 213.7505 613.1270</span>
<span class="co">#&gt;  [73] 659.8815 523.5950 215.8460 644.4580 492.8650 534.0100 659.6730 682.3135</span>
<span class="co">#&gt;  [81] 217.1550 551.4100 632.8410 482.4185 665.0290 665.0280 444.6075 819.1920</span>
<span class="co">#&gt;  [89] 687.9570 634.3425 601.3390 601.1275 665.0270 683.9940 582.4815 170.5045</span>
<span class="co">#&gt;  [97] 717.1020 557.4110 540.8660 213.7130 772.2180 890.7680 862.5875 511.5080</span>
<span class="co">#&gt; [105] 440.2150 639.5820 142.3240 537.2240 439.2500 511.2270 512.7940 762.3630</span>
<span class="co">#&gt; [113] 762.5770 439.2500 735.7900 510.6510 213.7270 534.0090 762.3610 510.4370</span>
<span class="co">#&gt; [121] 213.2320 454.9350 529.9730 434.9630 613.5560 818.7650 639.0990 454.9350</span>
<span class="co">#&gt; [129] 618.4850 214.6170 527.7950 800.2900 638.8870 468.5430 883.0525 213.4215</span>
<span class="co">#&gt; [137] 215.8555 698.3510 639.3120 638.8855 639.1000 525.0080 594.5905 214.1480</span>
<span class="co">#&gt; [145] 213.5120 522.4370 462.0070 689.2450 474.2205 214.7290 692.6730 730.6470</span>
<span class="co">#&gt; [153] 730.8590 213.1700 213.7260 682.8535 215.2830 367.0375 213.5140 213.3740</span>
<span class="co">#&gt; [161] 698.2460 213.1200 213.9270 213.8945 214.7070 213.3395 213.5090 215.2605</span>
<span class="co">#&gt; [169] 650.4570 215.2080 214.9990 636.9560 213.6405 216.4125 215.9885 214.2010</span>
<span class="co">#&gt; [177] 214.6300 213.9410 215.3500 213.1700</span></pre></body></html></div>
</div>
<div id="validation-by-principal-components-analysispca" class="section level3">
<h3 class="hasAnchor">
<a href="#validation-by-principal-components-analysispca" class="anchor"></a>Validation by principal components analysis(PCA)</h3>
<p>You need to check the GlobalStd algorithm’s results by principal components analysis(PCA).</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">enviGCMS</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>),<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span>)+<span class="fl">0.1</span>)
<span class="fu"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html">plotpca</a></span>(<span class="no">std</span>$<span class="no">data</span>,<span class="kw">lv</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">std</span>$<span class="no">group</span>)),<span class="kw">main</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(all peaks)"</span>)))
<span class="fu"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html">plotpca</a></span>(<span class="no">std</span>$<span class="no">data</span>[<span class="no">std</span>$<span class="no">stdmassindex</span>,],<span class="kw">lv</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">std</span>$<span class="no">group</span>)),<span class="kw">main</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))</pre></body></html></div>
<p><img src="globalstd_files/figure-html/pca-1.png" width="700"></p>
</div>
<div id="comparision-with-other-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#comparision-with-other-packages" class="anchor"></a>Comparision with other packages</h3>
<p>GlobalStd algorithm in <code>pmd</code> package could be treated as a method to extract pseudospectra. You could use <code>getcluster</code> to get peaks groups information for all GlobalStd peaks. This function would consider the merge of GlobalStd peaks when certain peak is involved in multiple clusters. Then you could choose export peaks with the highest intensities in each GlobalStd merged peaks groups.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">stdcluster</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/getcluster.html">getcluster</a></span>(<span class="no">std</span>)
<span class="co"># extract pseudospectra for std peak 71</span>
<span class="no">idx</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">stdcluster</span>$<span class="no">cluster</span>$<span class="no">largei</span>[<span class="no">stdcluster</span>$<span class="no">cluster</span>$<span class="no">i</span><span class="kw">==</span><span class="fl">71</span>])
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">stdcluster</span>$<span class="no">cluster</span>$<span class="no">mz</span>[<span class="no">stdcluster</span>$<span class="no">cluster</span>$<span class="no">largei</span><span class="kw">==</span><span class="no">idx</span>],<span class="no">stdcluster</span>$<span class="no">cluster</span>$<span class="no">ins</span>[<span class="no">stdcluster</span>$<span class="no">cluster</span>$<span class="no">largei</span><span class="kw">==</span><span class="no">idx</span>],<span class="kw">type</span> <span class="kw">=</span> <span class="st">'h'</span>,<span class="kw">xlab</span> <span class="kw">=</span> <span class="st">'m/z'</span>,<span class="kw">ylab</span> <span class="kw">=</span> <span class="st">'intensity'</span>,<span class="kw">main</span> <span class="kw">=</span> <span class="st">'pseudospectra for GlobalStd peak 71'</span>)</pre></body></html></div>
<p><img src="globalstd_files/figure-html/comp-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="co"># export peaks with the highest intensities in each GlobalStd peaks groups.</span>
<span class="no">data</span> <span class="kw">&lt;-</span> <span class="no">stdcluster</span>$<span class="no">data</span>[<span class="no">stdcluster</span>$<span class="no">stdmassindex2</span>,]</pre></body></html></div>
<p>You could also use <code>getcorcluster</code> to find peaks groups by correlation analysis only.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">corcluster</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/getcorcluster.html">getcorcluster</a></span>(<span class="no">spmeinvivo</span>)
<span class="co">#&gt; 75 retention time cluster found.</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">3</span>),<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span>)+<span class="fl">0.1</span>)
<span class="fu"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html">plotpca</a></span>(<span class="no">std</span>$<span class="no">data</span>,<span class="kw">lv</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">std</span>$<span class="no">group</span>)),<span class="kw">main</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(all peaks)"</span>)))
<span class="fu"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html">plotpca</a></span>(<span class="no">std</span>$<span class="no">data</span>[<span class="no">std</span>$<span class="no">stdmassindex</span>,],<span class="kw">lv</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">std</span>$<span class="no">group</span>)),<span class="kw">main</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))
<span class="fu"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html">plotpca</a></span>(<span class="no">std</span>$<span class="no">data</span>[<span class="no">corcluster</span>$<span class="no">stdmassindex</span>,],<span class="kw">lv</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">std</span>$<span class="no">group</span>)),<span class="kw">main</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks by correlationship)"</span>)))</pre></body></html></div>
<p><img src="globalstd_files/figure-html/corcomp-1.png" width="700"></p>
</div>
<div id="globalstd-algorithm-with-intensity-data" class="section level3">
<h3 class="hasAnchor">
<a href="#globalstd-algorithm-with-intensity-data" class="anchor"></a>GlobalStd algorithm with intensity data</h3>
<p>GlobalStd algorithm is designed to analysis data without intensity data. However, if you have intensity data, the independant peaks could be selected with more confindence. You could set up cutoff of Pearson Correlation Coefficient between peaks to refine the peaks selected by GlobalStd within same retention time groups.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">std2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/getstd.html">getstd</a></span>(<span class="no">pmd</span>,<span class="kw">corcutoff</span> <span class="kw">=</span> <span class="fl">0.9</span>)
<span class="co">#&gt; 8 retention group(s) have single peaks. 14 23 32 33 54 55 56 75</span>
<span class="co">#&gt; 23 group(s) with multiple peaks while no isotope/paired relationship 2 4 5 7 8 10 11 15 18 26 35 39 41 42 49 50 59 62 68 69 70 72 73</span>
<span class="co">#&gt; 14 group(s) with multiple peaks with isotope without paired relationship 9 12 22 24 27 28 34 51 52 57 60 64 66 71</span>
<span class="co">#&gt; 3 group(s) with paired relationship without isotope 1 53 74</span>
<span class="co">#&gt; 27 group(s) with paired relationship and isotope 3 6 13 16 17 19 20 21 25 29 30 31 36 37 38 40 43 44 45 46 47 48 58 61 63 65 67</span>
<span class="co">#&gt; 120 std mass found.</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">3</span>),<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span>)+<span class="fl">0.1</span>)
<span class="fu"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html">plotpca</a></span>(<span class="no">std2</span>$<span class="no">data</span>,<span class="kw">lv</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">std2</span>$<span class="no">group</span>)),<span class="kw">main</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(all peaks)"</span>)))
<span class="fu"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html">plotpca</a></span>(<span class="no">std</span>$<span class="no">data</span>[<span class="no">std</span>$<span class="no">stdmassindex</span>,],<span class="kw">lv</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">std</span>$<span class="no">group</span>)),<span class="kw">main</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))
<span class="fu"><a href="https://rdrr.io/pkg/enviGCMS/man/plotpca.html">plotpca</a></span>(<span class="no">std2</span>$<span class="no">data</span>[<span class="no">std2</span>$<span class="no">stdmassindex</span>,],<span class="kw">lv</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">std2</span>$<span class="no">group</span>)),<span class="kw">main</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))</pre></body></html></div>
<p><img src="globalstd_files/figure-html/globalcor-1.png" width="700"></p>
</div>
</div>
<div id="structurereaction-directed-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#structurereaction-directed-analysis" class="anchor"></a>Structure/Reaction directed analysis</h2>
<p><code>getsda</code> function could be used to perform Structure/reaction directed analysis. The cutoff of frequency is automately found by PMD network analysis with most cluster numbers.</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="no">sda</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/getsda.html">getsda</a></span>(<span class="no">std</span>)
<span class="co">#&gt; PMD frequency cutoff is 6 by PMD network analysis with largest network average distance 5.99 .</span>
<span class="co">#&gt; 57 groups were found as high frequency PMD group.</span>
<span class="co">#&gt; 0 was found as high frequency PMD. </span>
<span class="co">#&gt; 1.98 was found as high frequency PMD. </span>
<span class="co">#&gt; 2.01 was found as high frequency PMD. </span>
<span class="co">#&gt; 2.02 was found as high frequency PMD. </span>
<span class="co">#&gt; 6.97 was found as high frequency PMD. </span>
<span class="co">#&gt; 11.96 was found as high frequency PMD. </span>
<span class="co">#&gt; 12 was found as high frequency PMD. </span>
<span class="co">#&gt; 12.04 was found as high frequency PMD. </span>
<span class="co">#&gt; 13.98 was found as high frequency PMD. </span>
<span class="co">#&gt; 14.02 was found as high frequency PMD. </span>
<span class="co">#&gt; 14.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 15.99 was found as high frequency PMD. </span>
<span class="co">#&gt; 16.03 was found as high frequency PMD. </span>
<span class="co">#&gt; 19.04 was found as high frequency PMD. </span>
<span class="co">#&gt; 28.03 was found as high frequency PMD. </span>
<span class="co">#&gt; 30.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 31.99 was found as high frequency PMD. </span>
<span class="co">#&gt; 37.02 was found as high frequency PMD. </span>
<span class="co">#&gt; 42.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 48.04 was found as high frequency PMD. </span>
<span class="co">#&gt; 48.98 was found as high frequency PMD. </span>
<span class="co">#&gt; 49.02 was found as high frequency PMD. </span>
<span class="co">#&gt; 54.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 56.06 was found as high frequency PMD. </span>
<span class="co">#&gt; 56.1 was found as high frequency PMD. </span>
<span class="co">#&gt; 58.04 was found as high frequency PMD. </span>
<span class="co">#&gt; 58.08 was found as high frequency PMD. </span>
<span class="co">#&gt; 58.11 was found as high frequency PMD. </span>
<span class="co">#&gt; 63.96 was found as high frequency PMD. </span>
<span class="co">#&gt; 66.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 68.06 was found as high frequency PMD. </span>
<span class="co">#&gt; 70.04 was found as high frequency PMD. </span>
<span class="co">#&gt; 70.08 was found as high frequency PMD. </span>
<span class="co">#&gt; 74.02 was found as high frequency PMD. </span>
<span class="co">#&gt; 80.03 was found as high frequency PMD. </span>
<span class="co">#&gt; 82.08 was found as high frequency PMD. </span>
<span class="co">#&gt; 88.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 91.1 was found as high frequency PMD. </span>
<span class="co">#&gt; 93.12 was found as high frequency PMD. </span>
<span class="co">#&gt; 96.09 was found as high frequency PMD. </span>
<span class="co">#&gt; 101.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 108.13 was found as high frequency PMD. </span>
<span class="co">#&gt; 110.11 was found as high frequency PMD. </span>
<span class="co">#&gt; 112.16 was found as high frequency PMD. </span>
<span class="co">#&gt; 116.08 was found as high frequency PMD. </span>
<span class="co">#&gt; 122.15 was found as high frequency PMD. </span>
<span class="co">#&gt; 124.16 was found as high frequency PMD. </span>
<span class="co">#&gt; 126.14 was found as high frequency PMD. </span>
<span class="co">#&gt; 148.04 was found as high frequency PMD. </span>
<span class="co">#&gt; 150.2 was found as high frequency PMD. </span>
<span class="co">#&gt; 173.18 was found as high frequency PMD. </span>
<span class="co">#&gt; 191.08 was found as high frequency PMD. </span>
<span class="co">#&gt; 191.15 was found as high frequency PMD. </span>
<span class="co">#&gt; 192.19 was found as high frequency PMD. </span>
<span class="co">#&gt; 194.2 was found as high frequency PMD. </span>
<span class="co">#&gt; 267.25 was found as high frequency PMD. </span>
<span class="co">#&gt; 325.3 was found as high frequency PMD.</span></pre></body></html></div>
<p>You could use <code>plotstdsda</code> to show the distribution of the selected paired peaks.</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fu"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(<span class="no">sda</span>)</pre></body></html></div>
<p><img src="globalstd_files/figure-html/stdsda-1.png" width="700"></p>
<p>You could also use index to show the distribution of certain PMDs.</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">3</span>),<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span>)+<span class="fl">0.1</span>)
<span class="fu"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(<span class="no">sda</span>,<span class="no">sda</span>$<span class="no">sda</span>$<span class="no">diff2</span> <span class="kw">==</span> <span class="fl">2.02</span>)
<span class="fu"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(<span class="no">sda</span>,<span class="no">sda</span>$<span class="no">sda</span>$<span class="no">diff2</span> <span class="kw">==</span> <span class="fl">28.03</span>)
<span class="fu"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(<span class="no">sda</span>,<span class="no">sda</span>$<span class="no">sda</span>$<span class="no">diff2</span> <span class="kw">==</span> <span class="fl">58.04</span>)</pre></body></html></div>
<p><img src="globalstd_files/figure-html/stdsdaidx-1.png" width="700"></p>
<p>Structure/reaction directed analysis could be directily performed on all the peaks, which is slow to process:</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">sdaall</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/getsda.html">getsda</a></span>(<span class="no">spmeinvivo</span>)
<span class="co">#&gt; PMD frequency cutoff is 104 by PMD network analysis with largest network average distance 14.06 .</span>
<span class="co">#&gt; 6 groups were found as high frequency PMD group.</span>
<span class="co">#&gt; 0 was found as high frequency PMD. </span>
<span class="co">#&gt; 2.02 was found as high frequency PMD. </span>
<span class="co">#&gt; 28.03 was found as high frequency PMD. </span>
<span class="co">#&gt; 31.01 was found as high frequency PMD. </span>
<span class="co">#&gt; 58.04 was found as high frequency PMD. </span>
<span class="co">#&gt; 116.08 was found as high frequency PMD.</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">3</span>),<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span>)+<span class="fl">0.1</span>)
<span class="fu"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(<span class="no">sdaall</span>,<span class="no">sdaall</span>$<span class="no">sda</span>$<span class="no">diff2</span> <span class="kw">==</span> <span class="fl">2.02</span>)
<span class="fu"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(<span class="no">sdaall</span>,<span class="no">sdaall</span>$<span class="no">sda</span>$<span class="no">diff2</span> <span class="kw">==</span> <span class="fl">28.03</span>)
<span class="fu"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(<span class="no">sdaall</span>,<span class="no">sdaall</span>$<span class="no">sda</span>$<span class="no">diff2</span> <span class="kw">==</span> <span class="fl">58.04</span>)</pre></body></html></div>
<p><img src="globalstd_files/figure-html/all-1.png" width="700"></p>
<div id="structurereaction-directed-analysis-for-peakscompounds-only" class="section level3">
<h3 class="hasAnchor">
<a href="#structurereaction-directed-analysis-for-peakscompounds-only" class="anchor"></a>Structure/reaction directed analysis for peaks/compounds only</h3>
<p>When you only have data of peaks without retention time or compounds list, structure/reaction directed analysis could also be done by <code>getrda</code> function.</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="no">sda</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/getrda.html">getrda</a></span>(<span class="no">spmeinvivo</span>$<span class="no">mz</span>[<span class="no">std</span>$<span class="no">stdmassindex</span>])
<span class="co">#&gt; 38116 pmd found.</span>
<span class="co">#&gt; 11 pmd used.</span></pre></body></html></div>
</div>
<div id="structurereaction-network" class="section level3">
<h3 class="hasAnchor">
<a href="#structurereaction-network" class="anchor"></a>Structure/Reaction Network</h3>
<p>One peak or compounds could be involved in multiple reactions. You could construct a network by such relationship.</p>
<p>If you have a specific compound and want to check the metabolites of certain PMD, you could use <code>getchain</code> to extract the network of that compounds</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">igraph</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'igraph'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     decompose, spectrum</span>
<span class="co">#&gt; The following object is masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     union</span>
<span class="co"># check metabolites of C18H39NO</span>
<span class="no">chain</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/getchain.html">getchain</a></span>(<span class="no">spmeinvivo</span>,<span class="kw">diff</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2.02</span>,<span class="fl">14.02</span>,<span class="fl">15.99</span>,<span class="fl">58.04</span>,<span class="fl">13.98</span>),<span class="kw">mass</span> <span class="kw">=</span> <span class="fl">286.3101</span>,<span class="kw">digits</span> <span class="kw">=</span> <span class="fl">2</span>,<span class="kw">corcutoff</span> <span class="kw">=</span> <span class="fl">0</span>)
<span class="co"># show as network</span>
<span class="no">net</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html">graph_from_data_frame</a></span>(<span class="no">chain</span>$<span class="no">sdac</span>,<span class="kw">directed</span> <span class="kw">=</span> <span class="no">F</span>)
<span class="no">pal</span> <span class="kw">&lt;-</span> (<span class="kw pkg">grDevices</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span>(<span class="kw pkg">RColorBrewer</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span>(<span class="fl">11</span>,<span class="st">"RdYlBu"</span>)
                )))(<span class="fl">5</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">net</span>,<span class="kw">vertex.label</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span>(<span class="no">net</span>)$<span class="no">name</span>),<span class="fl">2</span>),<span class="kw">vertex.size</span> <span class="kw">=</span><span class="fl">5</span>,<span class="kw">edge.width</span> <span class="kw">=</span> <span class="fl">5</span>,<span class="kw">edge.color</span> <span class="kw">=</span> <span class="no">pal</span>[<span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span>(<span class="no">net</span>)$<span class="no">diff2</span>))],<span class="kw">vertex.label.dist</span><span class="kw">=</span><span class="fl">1</span>,<span class="kw">vertex.color</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span>(<span class="no">net</span>)$<span class="no">name</span>),<span class="fl">4</span>) <span class="kw">%in%</span> <span class="fl">286.3101</span>,<span class="st">'red'</span>,<span class="st">'black'</span>),<span class="kw">main</span> <span class="kw">=</span> <span class="st">'PMD network'</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>,<span class="kw">bty</span> <span class="kw">=</span> <span class="st">"n"</span>,
       <span class="kw">legend</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span>(<span class="no">net</span>)$<span class="no">diff2</span>),
       <span class="kw">fill</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">pal</span>[<span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span>(<span class="no">net</span>)$<span class="no">diff2</span>))]), <span class="kw">border</span><span class="kw">=</span><span class="fl">NA</span>,<span class="kw">horiz</span> <span class="kw">=</span> <span class="no">F</span>)</pre></body></html></div>
<p><img src="globalstd_files/figure-html/tarnet-1.png" width="700"></p>
<p>If you want to see all the independant peaks’ high frequency PMDs as a network, the following code will help</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="no">sda</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/getsda.html">getsda</a></span>(<span class="no">std</span>)
<span class="co">#&gt; PMD frequency cutoff is 6 by PMD network analysis with largest network average distance 5.99 .</span>
<span class="co">#&gt; 57 groups were found as high frequency PMD group.</span>
<span class="co">#&gt; 0 was found as high frequency PMD. </span>
<span class="co">#&gt; 1.98 was found as high frequency PMD. </span>
<span class="co">#&gt; 2.01 was found as high frequency PMD. </span>
<span class="co">#&gt; 2.02 was found as high frequency PMD. </span>
<span class="co">#&gt; 6.97 was found as high frequency PMD. </span>
<span class="co">#&gt; 11.96 was found as high frequency PMD. </span>
<span class="co">#&gt; 12 was found as high frequency PMD. </span>
<span class="co">#&gt; 12.04 was found as high frequency PMD. </span>
<span class="co">#&gt; 13.98 was found as high frequency PMD. </span>
<span class="co">#&gt; 14.02 was found as high frequency PMD. </span>
<span class="co">#&gt; 14.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 15.99 was found as high frequency PMD. </span>
<span class="co">#&gt; 16.03 was found as high frequency PMD. </span>
<span class="co">#&gt; 19.04 was found as high frequency PMD. </span>
<span class="co">#&gt; 28.03 was found as high frequency PMD. </span>
<span class="co">#&gt; 30.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 31.99 was found as high frequency PMD. </span>
<span class="co">#&gt; 37.02 was found as high frequency PMD. </span>
<span class="co">#&gt; 42.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 48.04 was found as high frequency PMD. </span>
<span class="co">#&gt; 48.98 was found as high frequency PMD. </span>
<span class="co">#&gt; 49.02 was found as high frequency PMD. </span>
<span class="co">#&gt; 54.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 56.06 was found as high frequency PMD. </span>
<span class="co">#&gt; 56.1 was found as high frequency PMD. </span>
<span class="co">#&gt; 58.04 was found as high frequency PMD. </span>
<span class="co">#&gt; 58.08 was found as high frequency PMD. </span>
<span class="co">#&gt; 58.11 was found as high frequency PMD. </span>
<span class="co">#&gt; 63.96 was found as high frequency PMD. </span>
<span class="co">#&gt; 66.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 68.06 was found as high frequency PMD. </span>
<span class="co">#&gt; 70.04 was found as high frequency PMD. </span>
<span class="co">#&gt; 70.08 was found as high frequency PMD. </span>
<span class="co">#&gt; 74.02 was found as high frequency PMD. </span>
<span class="co">#&gt; 80.03 was found as high frequency PMD. </span>
<span class="co">#&gt; 82.08 was found as high frequency PMD. </span>
<span class="co">#&gt; 88.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 91.1 was found as high frequency PMD. </span>
<span class="co">#&gt; 93.12 was found as high frequency PMD. </span>
<span class="co">#&gt; 96.09 was found as high frequency PMD. </span>
<span class="co">#&gt; 101.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 108.13 was found as high frequency PMD. </span>
<span class="co">#&gt; 110.11 was found as high frequency PMD. </span>
<span class="co">#&gt; 112.16 was found as high frequency PMD. </span>
<span class="co">#&gt; 116.08 was found as high frequency PMD. </span>
<span class="co">#&gt; 122.15 was found as high frequency PMD. </span>
<span class="co">#&gt; 124.16 was found as high frequency PMD. </span>
<span class="co">#&gt; 126.14 was found as high frequency PMD. </span>
<span class="co">#&gt; 148.04 was found as high frequency PMD. </span>
<span class="co">#&gt; 150.2 was found as high frequency PMD. </span>
<span class="co">#&gt; 173.18 was found as high frequency PMD. </span>
<span class="co">#&gt; 191.08 was found as high frequency PMD. </span>
<span class="co">#&gt; 191.15 was found as high frequency PMD. </span>
<span class="co">#&gt; 192.19 was found as high frequency PMD. </span>
<span class="co">#&gt; 194.2 was found as high frequency PMD. </span>
<span class="co">#&gt; 267.25 was found as high frequency PMD. </span>
<span class="co">#&gt; 325.3 was found as high frequency PMD.</span>
<span class="no">df</span> <span class="kw">&lt;-</span> <span class="no">sda</span>$<span class="no">sda</span>
<span class="no">net</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html">graph_from_data_frame</a></span>(<span class="no">df</span>,<span class="kw">directed</span> <span class="kw">=</span> <span class="no">F</span>)
<span class="no">pal</span> <span class="kw">&lt;-</span> (<span class="kw pkg">grDevices</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span>(<span class="kw pkg">RColorBrewer</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span>(<span class="fl">11</span>,<span class="st">"RdYlBu"</span>)
                )))(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span>(<span class="no">net</span>)$<span class="no">diff2</span>)))
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">net</span>,<span class="kw">vertex.label</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span>(<span class="no">net</span>)$<span class="no">name</span>)),<span class="kw">vertex.size</span> <span class="kw">=</span> <span class="fl">7</span>,<span class="kw">edge.width</span> <span class="kw">=</span> <span class="fl">5</span>,<span class="kw">edge.color</span> <span class="kw">=</span> <span class="no">pal</span>[<span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span>(<span class="no">net</span>)$<span class="no">diff2</span>))],<span class="kw">main</span> <span class="kw">=</span> <span class="st">'PMD network'</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>,<span class="kw">bty</span> <span class="kw">=</span> <span class="st">"n"</span>,
       <span class="kw">legend</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span>(<span class="no">net</span>)$<span class="no">diff2</span>),
       <span class="kw">fill</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">pal</span>[<span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span>(<span class="no">net</span>)$<span class="no">diff2</span>))]), <span class="kw">border</span><span class="kw">=</span><span class="fl">NA</span>,<span class="kw">horiz</span> <span class="kw">=</span> <span class="no">F</span>)</pre></body></html></div>
<p><img src="globalstd_files/figure-html/net-1.png" width="700"></p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="co"># Check the degree of the nodes</span>
<span class="co"># Show the degree distribution of the vertices</span>
<span class="no">deg</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/degree.html">degree</a></span>(<span class="no">net</span>, <span class="kw">mode</span><span class="kw">=</span><span class="st">"all"</span>)
<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/degree.html">degree_distribution</a></span>(<span class="no">net</span>)
<span class="co">#&gt;  [1] 0.000000000 0.280612245 0.163265306 0.096938776 0.102040816 0.076530612</span>
<span class="co">#&gt;  [7] 0.025510204 0.020408163 0.020408163 0.020408163 0.010204082 0.020408163</span>
<span class="co">#&gt; [13] 0.020408163 0.030612245 0.010204082 0.020408163 0.000000000 0.010204082</span>
<span class="co">#&gt; [19] 0.005102041 0.020408163 0.000000000 0.000000000 0.015306122 0.000000000</span>
<span class="co">#&gt; [25] 0.000000000 0.010204082 0.005102041 0.005102041 0.005102041 0.000000000</span>
<span class="co">#&gt; [31] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000</span>
<span class="co">#&gt; [37] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000</span>
<span class="co">#&gt; [43] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000</span>
<span class="co">#&gt; [49] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000</span>
<span class="co">#&gt; [55] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000</span>
<span class="co">#&gt; [61] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000</span>
<span class="co">#&gt; [67] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000</span>
<span class="co">#&gt; [73] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000</span>
<span class="co">#&gt; [79] 0.005102041</span>
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">net</span>, <span class="kw">vertex.size</span><span class="kw">=</span><span class="no">deg</span>/<span class="fl">2</span>,<span class="kw">vertex.label</span><span class="kw">=</span><span class="fl">NA</span>,<span class="kw">vertex.size</span> <span class="kw">=</span> <span class="fl">7</span>, <span class="kw">edge.width</span> <span class="kw">=</span> <span class="fl">5</span>)</pre></body></html></div>
<p><img src="globalstd_files/figure-html/net-2.png" width="700"></p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="co"># network community structure detection</span>
<span class="no">ceb</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/cluster_edge_betweenness.html">cluster_edge_betweenness</a></span>(<span class="no">net</span>,<span class="kw">weights</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span>(<span class="no">net</span>)$<span class="no">cor</span>), <span class="kw">directed</span> <span class="kw">=</span> <span class="no">F</span>)
<span class="co">#&gt; Warning in cluster_edge_betweenness(net, weights = abs(E(net)$cor), directed =</span>
<span class="co">#&gt; F): At community.c:460 :Membership vector will be selected based on the lowest</span>
<span class="co">#&gt; modularity score.</span>
<span class="co">#&gt; Warning in cluster_edge_betweenness(net, weights = abs(E(net)$cor), directed =</span>
<span class="co">#&gt; F): At community.c:467 :Modularity calculation with weighted edge betweenness</span>
<span class="co">#&gt; community detection might not make sense -- modularity treats edge weights as</span>
<span class="co">#&gt; similarities while edge betwenness treats them as distances</span>
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">ceb</span>, <span class="no">net</span>,<span class="kw">vertex.label</span><span class="kw">=</span><span class="fl">NA</span>,)</pre></body></html></div>
<p><img src="globalstd_files/figure-html/net-3.png" width="700"></p>
</div>
<div id="source-appointment" class="section level3">
<h3 class="hasAnchor">
<a href="#source-appointment" class="anchor"></a>Source appointment</h3>
<p>Peaks from samples could be from endogenous compounds or exogenous compounds. However, it’s hard to tell for untargeted analysis. In terms of PMD, if one peak belongs to a high frequency PMD network, it means a relatively high activity. If such sample belongs to a biological specimen, it might be endogenous compound. If a peak show no PMD network with other peaks, the biological system might not have enzyme to make reaction happen. Exogenous compounds will show a lower degree since they are xenbiotics. Since most of the peaks will show a low degree, the median of the degree could be used as cutoff. Then we could make source appointment if the assumption is hold.</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span>(<span class="no">deg</span>)
<span class="co">#&gt; [1] 3</span>
<span class="no">endogenous</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">deg</span>)[<span class="no">deg</span><span class="kw">&gt;</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span>(<span class="no">deg</span>)]
<span class="no">exogenous</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">deg</span>)[<span class="no">deg</span><span class="kw">&lt;=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span>(<span class="no">deg</span>)]</pre></body></html></div>
<p>In this case, we will have 90 endogenous compounds while 106 exogenous compounds. When you find a peak show differences between groups, you could check the degree to infer its sources.</p>
</div>
</div>
<div id="parameters-selection" class="section level2">
<h2 class="hasAnchor">
<a href="#parameters-selection" class="anchor"></a>Parameters selection</h2>
<p>Retention time cluster cutoff should fit the peak picking algorithm. For HPLC, 10 is suggested and 5 could be used for UPLC.</p>
<p>Global PMD’s retention time group numbers should be around 20 percent of the retention time cluster numbers. For example, if you find 100 retention time clusters, I suggested you use 20 as the empirical global PMD’s retention time group numbers.</p>
<p>Another important hint is that pre-filter your peak list by black samples or other quality control samples. Otherwise the running time would be long and lots of pmd relationship would be just from noise.</p>
</div>
<div id="wrap-function" class="section level2">
<h2 class="hasAnchor">
<a href="#wrap-function" class="anchor"></a>Wrap function</h2>
<p><code>globalstd</code> function is a wrap function to process GlobalStd algorithm and structure/reaction directed analysis in one line. All the plot function could be directly used on the <code>list</code> objects from <code>globalstd</code> function.</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="no">result</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/globalstd.html">globalstd</a></span>(<span class="no">spmeinvivo</span>,<span class="kw">ng</span><span class="kw">=</span><span class="fl">10</span>)
<span class="co">#&gt; 75 retention time cluster found.</span>
<span class="co">#&gt; 380 paired masses found</span>
<span class="co">#&gt; 9 unique within RT clusters high frequency PMD(s) used for further investigation.</span>
<span class="co">#&gt; 719 isotopologue(s) related paired mass found.</span>
<span class="co">#&gt; 492 multi-charger(s) related paired mass found.</span>
<span class="co">#&gt; 8 retention group(s) have single peaks. 14 23 32 33 54 55 56 75</span>
<span class="co">#&gt; 11 group(s) with multiple peaks while no isotope/paired relationship 4 5 7 8 11 41 42 49 68 72 73</span>
<span class="co">#&gt; 9 group(s) with multiple peaks with isotope without paired relationship 2 9 22 26 52 62 64 66 70</span>
<span class="co">#&gt; 4 group(s) with paired relationship without isotope 1 10 15 18</span>
<span class="co">#&gt; 43 group(s) with paired relationship and isotope 3 6 12 13 16 17 19 20 21 24 25 27 28 29 30 31 34 35 36 37 38 39 40 43 44 45 46 47 48 50 51 53 57 58 59 60 61 63 65 67 69 71 74</span>
<span class="co">#&gt; 297 std mass found.</span>
<span class="co">#&gt; PMD frequency cutoff is 6 by PMD network analysis with largest network average distance 5.99 .</span>
<span class="co">#&gt; 57 groups were found as high frequency PMD group.</span>
<span class="co">#&gt; 0 was found as high frequency PMD. </span>
<span class="co">#&gt; 1.98 was found as high frequency PMD. </span>
<span class="co">#&gt; 2.01 was found as high frequency PMD. </span>
<span class="co">#&gt; 2.02 was found as high frequency PMD. </span>
<span class="co">#&gt; 6.97 was found as high frequency PMD. </span>
<span class="co">#&gt; 11.96 was found as high frequency PMD. </span>
<span class="co">#&gt; 12 was found as high frequency PMD. </span>
<span class="co">#&gt; 12.04 was found as high frequency PMD. </span>
<span class="co">#&gt; 13.98 was found as high frequency PMD. </span>
<span class="co">#&gt; 14.02 was found as high frequency PMD. </span>
<span class="co">#&gt; 14.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 15.99 was found as high frequency PMD. </span>
<span class="co">#&gt; 16.03 was found as high frequency PMD. </span>
<span class="co">#&gt; 19.04 was found as high frequency PMD. </span>
<span class="co">#&gt; 28.03 was found as high frequency PMD. </span>
<span class="co">#&gt; 30.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 31.99 was found as high frequency PMD. </span>
<span class="co">#&gt; 37.02 was found as high frequency PMD. </span>
<span class="co">#&gt; 42.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 48.04 was found as high frequency PMD. </span>
<span class="co">#&gt; 48.98 was found as high frequency PMD. </span>
<span class="co">#&gt; 49.02 was found as high frequency PMD. </span>
<span class="co">#&gt; 54.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 56.06 was found as high frequency PMD. </span>
<span class="co">#&gt; 56.1 was found as high frequency PMD. </span>
<span class="co">#&gt; 58.04 was found as high frequency PMD. </span>
<span class="co">#&gt; 58.08 was found as high frequency PMD. </span>
<span class="co">#&gt; 58.11 was found as high frequency PMD. </span>
<span class="co">#&gt; 63.96 was found as high frequency PMD. </span>
<span class="co">#&gt; 66.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 68.06 was found as high frequency PMD. </span>
<span class="co">#&gt; 70.04 was found as high frequency PMD. </span>
<span class="co">#&gt; 70.08 was found as high frequency PMD. </span>
<span class="co">#&gt; 74.02 was found as high frequency PMD. </span>
<span class="co">#&gt; 80.03 was found as high frequency PMD. </span>
<span class="co">#&gt; 82.08 was found as high frequency PMD. </span>
<span class="co">#&gt; 88.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 91.1 was found as high frequency PMD. </span>
<span class="co">#&gt; 93.12 was found as high frequency PMD. </span>
<span class="co">#&gt; 96.09 was found as high frequency PMD. </span>
<span class="co">#&gt; 101.05 was found as high frequency PMD. </span>
<span class="co">#&gt; 108.13 was found as high frequency PMD. </span>
<span class="co">#&gt; 110.11 was found as high frequency PMD. </span>
<span class="co">#&gt; 112.16 was found as high frequency PMD. </span>
<span class="co">#&gt; 116.08 was found as high frequency PMD. </span>
<span class="co">#&gt; 122.15 was found as high frequency PMD. </span>
<span class="co">#&gt; 124.16 was found as high frequency PMD. </span>
<span class="co">#&gt; 126.14 was found as high frequency PMD. </span>
<span class="co">#&gt; 148.04 was found as high frequency PMD. </span>
<span class="co">#&gt; 150.2 was found as high frequency PMD. </span>
<span class="co">#&gt; 173.18 was found as high frequency PMD. </span>
<span class="co">#&gt; 191.08 was found as high frequency PMD. </span>
<span class="co">#&gt; 191.15 was found as high frequency PMD. </span>
<span class="co">#&gt; 192.19 was found as high frequency PMD. </span>
<span class="co">#&gt; 194.2 was found as high frequency PMD. </span>
<span class="co">#&gt; 267.25 was found as high frequency PMD. </span>
<span class="co">#&gt; 325.3 was found as high frequency PMD.</span></pre></body></html></div>
</div>
<div id="shiny-application" class="section level2">
<h2 class="hasAnchor">
<a href="#shiny-application" class="anchor"></a>Shiny application</h2>
<p>An interactive document has been included in this package to perform PMD analysis. You need to prepare a csv file with m/z and retention time of peaks. Such csv file could be generated by run <code><a href="https://rdrr.io/pkg/enviGCMS/man/getmzrtcsv.html">enviGCMS::getmzrtcsv()</a></code> on the <code>list</code> object from <code><a href="https://rdrr.io/pkg/enviGCMS/man/getmzrt.html">enviGCMS::getmzrt(xset)</a></code> or <code><a href="https://rdrr.io/pkg/enviGCMS/man/getmzrt2.html">enviGCMS::getmzrt2(xset)</a></code> function. You could also generate the csv file by <code><a href="https://rdrr.io/pkg/enviGCMS/man/getmzrt.html">enviGCMS::getmzrt(xset,name = 'test')</a></code> or <code><a href="https://rdrr.io/pkg/enviGCMS/man/getmzrt2.html">enviGCMS::getmzrt2(xset, name = 'test')</a></code>. You will find the csv file in the working dictionary named <code>test.csv</code>.</p>
<p>Then you could run <code><a href="../reference/runPMD.html">runPMD()</a></code> to start the Graphical user interface(GUI) for GlobalStd algorithm and structure/reaction directed analysis. The PMD network for certain compound could be generated by run <code><a href="../reference/runPMDnet.html">runPMDnet()</a></code>.</p>
</div>
<div id="database" class="section level2">
<h2 class="hasAnchor">
<a href="#database" class="anchor"></a>Database</h2>
<p>To check the pmd reaction database:</p>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="co"># all reaction</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"omics"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">omics</span>)
<span class="co">#&gt;   X   KEGG RHEA_ID DIRECTION MASTER_ID   ec ecocyc macie</span>
<span class="co">#&gt; 1 1 R00001   22455        BI     22452 &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;</span>
<span class="co">#&gt; 2 2 R00004   24579        BI     24576 &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;</span>
<span class="co">#&gt; 3 3 R00005   19032        BI     19029 &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;</span>
<span class="co">#&gt; 4 4 R00008   22751        BI     22748 &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;</span>
<span class="co">#&gt; 5 5 R00009   20312        BI     20309 &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;</span>
<span class="co">#&gt; 6 6 R00010   20871        BI     20868 &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;</span>
<span class="co">#&gt;                   metacyc reactome</span>
<span class="co">#&gt; 1 ENDOPOLYPHOSPHATASE-RXN     &lt;NA&gt;</span>
<span class="co">#&gt; 2   INORGPYROPHOSPHAT-RXN     &lt;NA&gt;</span>
<span class="co">#&gt; 3                    &lt;NA&gt;     &lt;NA&gt;</span>
<span class="co">#&gt; 4                    &lt;NA&gt;     &lt;NA&gt;</span>
<span class="co">#&gt; 5                    &lt;NA&gt;     &lt;NA&gt;</span>
<span class="co">#&gt; 6                    &lt;NA&gt;     &lt;NA&gt;</span>
<span class="co">#&gt;                                                compounds     pmd</span>
<span class="co">#&gt; 1  [phosphate](n+1) + n H2O &lt;=&gt; n H(+) + (n+1) phosphate      NA</span>
<span class="co">#&gt; 2               diphosphate + H2O &lt;=&gt; H(+) + 2 phosphate      NA</span>
<span class="co">#&gt; 3 3 H(+) + H2O + urea-1-carboxylate &lt;=&gt; 2 CO2 + 2 NH4(+)      NA</span>
<span class="co">#&gt; 4       4-hydroxy-4-methyl-2-oxoglutarate &lt;=&gt; 2 pyruvate      NA</span>
<span class="co">#&gt; 5                                  2 H2O2 &lt;=&gt; 2 H2O + O2      NA</span>
<span class="co">#&gt; 6            alpha,alpha-trehalose + H2O &lt;=&gt; 2 D-glucose 162.053</span>
<span class="co"># kegg reaction</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"keggrall"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">keggrall</span>)
<span class="co">#&gt;          ID      ms1      formula1      ms2       formula2     pmd  C  H O N P</span>
<span class="co">#&gt; 2    R00002 506.9957 C10H16N5O13P3 427.0294  C10H15N5O10P2  79.966  0  1 3 0 1</span>
<span class="co">#&gt; 8    R00010 342.1162     C12H22O11 180.0634        C6H12O6 162.053  6 10 5 0 0</span>
<span class="co">#&gt; 10   R00012 522.9907 C10H16N5O14P3 868.0381 C20H28N10O21P4 345.047 10 12 7 5 1</span>
<span class="co">#&gt; 12   R00014 425.0450 C12H19N4O7P2S 469.0712  C14H23N4O8P2S  44.026  2  4 1 0 0</span>
<span class="co">#&gt; 13.1 R00015 342.1162     C12H22O11 180.0634        C6H12O6 162.053  6 10 5 0 0</span>
<span class="co">#&gt; 13.2 R00015 342.1162     C12H22O11 504.1690      C18H32O16 162.053  6 10 5 0 0</span>
<span class="co">#&gt;      S</span>
<span class="co">#&gt; 2    0</span>
<span class="co">#&gt; 8    0</span>
<span class="co">#&gt; 10   0</span>
<span class="co">#&gt; 12   0</span>
<span class="co">#&gt; 13.1 0</span>
<span class="co">#&gt; 13.2 0</span>
<span class="co"># literature reaction for mass spectrometry</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"sda"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">sda</span>)
<span class="co">#&gt;         PMD                                                          origin</span>
<span class="co">#&gt; 1  0.984016                    OH ↔ NH2, e.g. de-amidiation, CHNO compounds</span>
<span class="co">#&gt; 2  1.995663 F ↔ OH, halogen exchange with hydroxy group (typically -F + OH)</span>
<span class="co">#&gt; 3  2.015650                         ± 2H, opening or forming of double bond</span>
<span class="co">#&gt; 4  7.004671                       F ↔ CN, halogen exchange with cyano group</span>
<span class="co">#&gt; 5  8.965779                      Cl ↔ CN, halogen exchange with cyano group</span>
<span class="co">#&gt; 6 13.979265               O ↔ 2H, e.g. Oxidation follwed by H2O elimination</span>
<span class="co">#&gt;                                            Ref. mode</span>
<span class="co">#&gt; 1 https://doi.org/10.1016/S1044-0305(99)00090-2 both</span>
<span class="co">#&gt; 2 https://doi.org/10.1016/S1044-0305(99)00090-2 both</span>
<span class="co">#&gt; 3 https://doi.org/10.1016/S1044-0305(99)00090-2 both</span>
<span class="co">#&gt; 4 https://doi.org/10.1016/S1044-0305(99)00090-2 both</span>
<span class="co">#&gt; 5 https://doi.org/10.1016/S1044-0305(99)00090-2 both</span>
<span class="co">#&gt; 6 https://doi.org/10.1016/S1044-0305(99)00090-2 both</span></pre></body></html></div>
<p>To check the HMDB pmd database:</p>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"hmdb"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">hmdb</span>)
<span class="co">#&gt;    C  H  O N P S   pmd pmd2 percentage</span>
<span class="co">#&gt; 1 -3  4  2 0 0 0 0.021 0.02  0.9623060</span>
<span class="co">#&gt; 2  1  4 -1 0 0 0 0.036 0.04  0.9503645</span>
<span class="co">#&gt; 3  5  4 -4 0 0 0 0.052 0.05  0.9412861</span>
<span class="co">#&gt; 4  2  8 -2 0 0 0 0.073 0.07  0.9617834</span>
<span class="co">#&gt; 5  6  8 -5 0 0 0 0.088 0.09  0.9247730</span>
<span class="co">#&gt; 6 -1 12  0 0 0 0 0.094 0.09  0.9648936</span></pre></body></html></div>
</div>
<div id="conclusion" class="section level2">
<h2 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h2>
<p><code>pmd</code> package could be used to reduce the redundancy peaks for GC/LC-MS based research and perform structure/reaction directed analysis to screen known and unknown important compounds or reactions.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Miao YU.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
