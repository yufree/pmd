<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis â€¢ pmd</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-58201304-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-58201304-1');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pmd</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/globalstd.html">Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Paired Mass Distance(PMD) analysis for GC/LC-MS based non-targeted analysis</h1>
                        <h4 class="author">Miao Yu</h4>
            
            <h4 class="date">2019-07-22</h4>
      
      
      <div class="hidden name"><code>globalstd.Rmd</code></div>

    </div>

    
    
<div id="introduction-of-paired-mass-distance-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction-of-paired-mass-distance-analysis" class="anchor"></a>Introduction of Paired Mass Distance analysis</h2>
<p><code>pmd</code> package use Paired Mass Distance (PMD) relationship to analysis the GC/LC-MS based non-targeted data. PMD means the distance between two masses or mass to charge ratios. In mass spectrometry, PMD would keep the same between two masses or two mass to charge ratios(m/z). There are twe kinds of PMD involved in this package: PMD within same retention time group and PMD from different retention time groups.</p>
<div id="pmd-within-same-retention-time-group" class="section level3">
<h3 class="hasAnchor">
<a href="#pmd-within-same-retention-time-group" class="anchor"></a>PMD within same retention time group</h3>
<p>In GC/LC-MS based non-targeted analysis, peaks could be seperated by chromatograph. We could build retention time(RT) bins to assign peaks into different RT groups by retention time hierarchical clustering analysis. For each RT group, the peaks should come from same compounds or co-elutes. If certain PMD appeared in multiple RT groups, it would be related to the relationship about adducts, neutral loss, isotopologues or commen fragments ions.</p>
</div>
<div id="pmd-from-different-retention-time-groups" class="section level3">
<h3 class="hasAnchor">
<a href="#pmd-from-different-retention-time-groups" class="anchor"></a>PMD from different retention time groups</h3>
<p>The peaks from different retention time groups would like to be different compounds seperated by chromatograph. The PMD would reflect the relationship about homologous series or chemical reactions.</p>
<p>GlobalStd algorithm use the PMD within same RT group to find independent peaks among certain dataset. Structure/reaction directed analysis use PMD from different RT groups to screen important compounds or reactions.</p>
</div>
</div>
<div id="data-format" class="section level2">
<h2 class="hasAnchor">
<a href="#data-format" class="anchor"></a>Data format</h2>
<p>The input data should be a <code>list</code> object with at least two elements from a peaks list:</p>
<ul>
<li>mass to charge ratio with name of <code>mz</code>, high resolution mass spectrometry is required</li>
<li>retention time with name of <code>rt</code>
</li>
</ul>
<p>However, I suggested to add intensity and group information to the list for validation of PMD analysis.</p>
<p>In this package, a dataset from <em>in vivo</em> solid phase micro-extraction(SPME) was attached. This dataset contain 9 samples from 3 fish with triplicates samples for each fish. Here is the data strcture:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(pmd)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"spmeinvivo"</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(spmeinvivo)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt; List of 4</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#&gt;  $ data : num [1:1459, 1:9] 1095 10439 10154 2797 90211 ...</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt;   .. ..$ : chr [1:1459] "100.1/170" "100.5/86" "101/85" "103.1/348" ...</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt;   .. ..$ : chr [1:9] "1405_Fish1_F1" "1405_Fish1_F2" "1405_Fish1_F3" "1405_Fish2_F1" ...</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt;  $ group: chr [1:9] "fish1" "fish1" "fish1" "fish2" ...</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt;  $ mz   : num [1:1459] 100 101 101 103 104 ...</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">#&gt;  $ rt   : num [1:1459] 170.2 86.3 84.9 348.1 48.8 ...</span></a></code></pre></div>
<p>You could build this <code>list</code> object from the <code>xcms</code> objects via <code>enviGCMS</code> package. When you have a <code>xcmsSet</code> object or <code>XCMSnExp</code> object named <code>xset</code>, you could use <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt">enviGCMS::getmzrt(xset)</a></code> or <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt2">enviGCMS::getmzrt2(xset)</a></code> to get such list. Of course you could build such list by yourself.</p>
</div>
<div id="globalstd-algorithm" class="section level2">
<h2 class="hasAnchor">
<a href="#globalstd-algorithm" class="anchor"></a>GlobalStd algorithm</h2>
<p>GlobalStd algorithm try to find independent peaks among certain peaks list. The first step is retention time hierarchical clustering analysis. The second step is to find the relationship among adducts, neutral loss, isotopologues and commen fragments ions. The third step is to screen the independent peaks.</p>
<div id="retention-time-hierarchical-clustering" class="section level3">
<h3 class="hasAnchor">
<a href="#retention-time-hierarchical-clustering" class="anchor"></a>Retention time hierarchical clustering</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">pmd &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getpaired.html">getpaired</a></span>(spmeinvivo, <span class="dt">rtcutoff =</span> <span class="dv">10</span>, <span class="dt">ng =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt; 75 retention time cluster found.</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#&gt; 435 paired masses found</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt; 10 unique within RT clusters high frequency PMD(s) used for further investigation.</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt; 583 isotopologue(s) related paired mass found.</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; 685 multi-charger(s) related paired mass found.</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="kw"><a href="../reference/plotrtg.html">plotrtg</a></span>(pmd)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/rtg-1.png" width="700"></p>
<p>This plot would show the distribution of RT groups. The <code>rtcutoff</code> in function <code>getpaired</code> could be used to set the cutoff of the distances in retention time hierarchical clustering analysis.</p>
</div>
<div id="relationship-among-adducts-neutral-loss-isotopologues-and-commen-fragments-ions" class="section level3">
<h3 class="hasAnchor">
<a href="#relationship-among-adducts-neutral-loss-isotopologues-and-commen-fragments-ions" class="anchor"></a>Relationship among adducts, neutral loss, isotopologues and commen fragments ions</h3>
<p>The <code>ng</code> in function <code>getpaired</code> could be used to set cutoff of global PMDâ€™s retention time group numbers. If <code>ng</code> is 10, at least 10 of the retention time groups should contain the shown PMD relationship. You could use <code>plotpaired</code> to show the distribution.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="../reference/plotpaired.html">plotpaired</a></span>(pmd)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/pmd-1.png" width="700"></p>
<p>You could also show the distribution of PMD relationship by index:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># show the unique PMD found by getpaired function</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(pmd<span class="op">$</span>paired<span class="op">$</span>diff2))){</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">        diff &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(pmd<span class="op">$</span>paired<span class="op">$</span>diff2)[i]</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">        index &lt;-<span class="st"> </span>pmd<span class="op">$</span>paired<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span>diff</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">        <span class="kw"><a href="../reference/plotpaired.html">plotpaired</a></span>(pmd,index)</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">}</a></code></pre></div>
<p><img src="globalstd_files/figure-html/pmdindex-1.png" width="700"><img src="globalstd_files/figure-html/pmdindex-2.png" width="700"><img src="globalstd_files/figure-html/pmdindex-3.png" width="700"><img src="globalstd_files/figure-html/pmdindex-4.png" width="700"><img src="globalstd_files/figure-html/pmdindex-5.png" width="700"><img src="globalstd_files/figure-html/pmdindex-6.png" width="700"><img src="globalstd_files/figure-html/pmdindex-7.png" width="700"><img src="globalstd_files/figure-html/pmdindex-8.png" width="700"><img src="globalstd_files/figure-html/pmdindex-9.png" width="700"><img src="globalstd_files/figure-html/pmdindex-10.png" width="700"></p>
</div>
<div id="screen-the-independent-peaks" class="section level3">
<h3 class="hasAnchor">
<a href="#screen-the-independent-peaks" class="anchor"></a>Screen the independent peaks</h3>
<p>You could use <code>getstd</code> function to get the independent peaks.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">std &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getstd.html">getstd</a></span>(pmd)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt; 11 group(s) with multiple peaks while no isotope/paired relationship</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt; 8 group(s) with multiple peaks with isotope without paired relationship</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt; 4 group(s) with paired relationship without isotope</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; 44 group(s) with paired relationship and isotope</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; 257 std mass found.</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt; 8 retention group(s) have single peaks.</span></a></code></pre></div>
<p>Here you could plot the peaks by <code>plotstd</code> function to show the distribution of independent peaks:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="../reference/plotstd.html">plotstd</a></span>(std)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/stdplot-1.png" width="700"></p>
<p>You could also plot the peaks distribution by assign a retention time group via <code>plotstdrt</code>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">23</span>,<span class="dt">main =</span> <span class="st">'Retention time group 23'</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">9</span>,<span class="dt">main =</span> <span class="st">'Retention time group 9'</span>)</a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">18</span>,<span class="dt">main =</span> <span class="st">'Retention time group 18'</span>)</a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">67</span>,<span class="dt">main =</span> <span class="st">'Retention time group 67'</span>)</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">49</span>,<span class="dt">main =</span> <span class="st">'Retention time group 49'</span>)</a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="kw"><a href="../reference/plotstdrt.html">plotstdrt</a></span>(std,<span class="dt">rtcluster =</span> <span class="dv">6</span>,<span class="dt">main =</span> <span class="st">'Retention time group 6'</span>)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/stdrtplot-1.png" width="700"></p>
</div>
<div id="use-independent-peaks-for-msms-validation" class="section level3">
<h3 class="hasAnchor">
<a href="#use-independent-peaks-for-msms-validation" class="anchor"></a>Use independent peaks for MS/MS validation</h3>
<p>Independent peaks are supporsing generated from different compounds. We could use those peaks for MS/MS analysis instead of DIA or DDA. Here we need multiple injections for one sample since it might be impossible to get all ionsâ€™ fragmental ions in one injection with good sensitivity. You could use <code>gettarget</code> to generate the index for the injections and output the peaks for each run.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># you need retention time for independent peaks</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">index &lt;-<span class="st"> </span><span class="kw"><a href="../reference/gettarget.html">gettarget</a></span>(std<span class="op">$</span>rt[std<span class="op">$</span>stdmassindex])</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&gt; You need 6 injections!</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co"># output the ions for each injection</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/table">table</a></span>(index)</a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt; index</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt;  1  2  3  4  5  6 </span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt; 49 35 52 35 36 50</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co"># show the ions for the first injection</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10">std<span class="op">$</span>mz[index<span class="op">==</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt;   [1] 106.9509 110.0092 118.0873 132.0779 135.1168 136.4826 137.0472</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt;   [8] 138.0549 141.9594 143.9602 145.0358 145.9553 152.0578 154.9677</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#&gt;  [15] 155.1294 155.1295 156.0426 156.0776 156.9622 159.1575 161.0713</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#&gt;  [22] 162.0558 163.1487 166.4658 167.0134 167.0901 170.0931 172.1705</span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">#&gt;  [29] 175.0873 175.1481 177.1640 181.1597 188.6484 192.1380 210.1577</span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="co">#&gt;  [36] 213.2050 215.1272 217.1483 217.6492 219.0540 226.9523 227.9565</span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="co">#&gt;  [43] 235.1692 236.1730 237.2228 242.2863 242.2863 242.2863 242.9260</span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="co">#&gt;  [50] 251.0008 251.0476 255.2511 259.9651 261.2214 262.1453 262.1656</span></a>
<a class="sourceLine" id="cb8-19" data-line-number="19"><span class="co">#&gt;  [57] 264.1944 267.1772 267.2693 267.9535 268.1893 270.3185 270.3185</span></a>
<a class="sourceLine" id="cb8-20" data-line-number="20"><span class="co">#&gt;  [64] 270.3185 270.3185 270.3185 270.3185 270.3185 271.3217 271.3216</span></a>
<a class="sourceLine" id="cb8-21" data-line-number="21"><span class="co">#&gt;  [71] 272.0665 273.1685 277.0970 277.1418 277.1817 279.2697 281.0519</span></a>
<a class="sourceLine" id="cb8-22" data-line-number="22"><span class="co">#&gt;  [78] 283.3000 284.2956 285.3002 286.3101 293.2853 295.9069 309.2279</span></a>
<a class="sourceLine" id="cb8-23" data-line-number="23"><span class="co">#&gt;  [85] 310.9380 311.3144 312.0163 312.3261 313.1439 319.9302 321.3165</span></a>
<a class="sourceLine" id="cb8-24" data-line-number="24"><span class="co">#&gt;  [92] 328.0132 329.0052 329.2492 335.1258 336.3259 337.1058 337.8946</span></a>
<a class="sourceLine" id="cb8-25" data-line-number="25"><span class="co">#&gt;  [99] 340.7613 341.0180 349.0556 352.9085 354.2845 355.3391 356.3423</span></a>
<a class="sourceLine" id="cb8-26" data-line-number="26"><span class="co">#&gt; [106] 357.8170 361.2353 361.3266 362.3032 362.9280 365.3023 366.3006</span></a>
<a class="sourceLine" id="cb8-27" data-line-number="27"><span class="co">#&gt; [113] 367.3375 367.3373 368.3395 368.3904 370.3330 372.3478 375.2147</span></a>
<a class="sourceLine" id="cb8-28" data-line-number="28"><span class="co">#&gt; [120] 377.2696 378.9015 383.1282 383.1414 383.2804 385.2753 386.2783</span></a>
<a class="sourceLine" id="cb8-29" data-line-number="29"><span class="co">#&gt; [127] 392.2873 392.3135 394.4045 398.2762 401.3421 404.2360 419.3519</span></a>
<a class="sourceLine" id="cb8-30" data-line-number="30"><span class="co">#&gt; [134] 422.2952 425.3120 426.2189 426.3146 427.1184 431.0687 432.0690</span></a>
<a class="sourceLine" id="cb8-31" data-line-number="31"><span class="co">#&gt; [141] 439.2698 442.3376 442.8446 446.1216 447.9910 448.2959 449.2874</span></a>
<a class="sourceLine" id="cb8-32" data-line-number="32"><span class="co">#&gt; [148] 463.1472 463.3975 478.8354 493.3138 494.8112 494.8112 494.8113</span></a>
<a class="sourceLine" id="cb8-33" data-line-number="33"><span class="co">#&gt; [155] 496.3410 501.2808 501.3829 502.2931 502.3382 506.3375 508.3041</span></a>
<a class="sourceLine" id="cb8-34" data-line-number="34"><span class="co">#&gt; [162] 512.4158 514.8764 516.3893 517.8314 519.1401 522.3557 525.9831</span></a>
<a class="sourceLine" id="cb8-35" data-line-number="35"><span class="co">#&gt; [169] 527.1586 530.8496 534.9708 535.4718 537.1654 538.3435 539.5420</span></a>
<a class="sourceLine" id="cb8-36" data-line-number="36"><span class="co">#&gt; [176] 543.3280 544.3398 547.5201 555.2922 560.2193 561.4023 580.2907</span></a>
<a class="sourceLine" id="cb8-37" data-line-number="37"><span class="co">#&gt; [183] 582.3700 584.8611 585.4215 586.4524 587.8828 598.8366 600.8824</span></a>
<a class="sourceLine" id="cb8-38" data-line-number="38"><span class="co">#&gt; [190] 608.8745 613.1827 614.1816 620.6167 625.3928 628.1949 630.7621</span></a>
<a class="sourceLine" id="cb8-39" data-line-number="39"><span class="co">#&gt; [197] 639.8539 640.1961 651.8520 663.4529 664.4627 665.4606 665.8615</span></a>
<a class="sourceLine" id="cb8-40" data-line-number="40"><span class="co">#&gt; [204] 669.4185 675.6790 676.2120 676.6791 676.8604 680.4633 683.5412</span></a>
<a class="sourceLine" id="cb8-41" data-line-number="41"><span class="co">#&gt; [211] 685.2035 685.3464 690.3683 690.6403 691.6443 696.5070 698.7711</span></a>
<a class="sourceLine" id="cb8-42" data-line-number="42"><span class="co">#&gt; [218] 702.1381 703.2147 704.8667 705.1376 707.6675 708.8218 710.2184</span></a>
<a class="sourceLine" id="cb8-43" data-line-number="43"><span class="co">#&gt; [225] 718.8373 719.9400 727.4611 731.8438 738.5066 744.8477 773.3274</span></a>
<a class="sourceLine" id="cb8-44" data-line-number="44"><span class="co">#&gt; [232] 775.8295 778.8378 779.3404 779.5153 780.8078 790.5377 792.3470</span></a>
<a class="sourceLine" id="cb8-45" data-line-number="45"><span class="co">#&gt; [239] 801.4967 803.5434 804.8442 812.8331 816.5102 820.8196 825.6769</span></a>
<a class="sourceLine" id="cb8-46" data-line-number="46"><span class="co">#&gt; [246] 836.6816 837.5278 846.8256 860.3354 862.7985 864.3202 866.3142</span></a>
<a class="sourceLine" id="cb8-47" data-line-number="47"><span class="co">#&gt; [253] 868.4448 872.8054 872.8314 873.3057 873.3343 878.3781 880.8217</span></a>
<a class="sourceLine" id="cb8-48" data-line-number="48"><span class="co">#&gt; [260] 883.7184 884.1633 884.8301 886.7613 888.8064 896.7943 900.8085</span></a>
<a class="sourceLine" id="cb8-49" data-line-number="49"><span class="co">#&gt; [267] 904.8150 907.4933 914.8115 915.3139 916.7821 922.7991 925.4477</span></a>
<a class="sourceLine" id="cb8-50" data-line-number="50"><span class="co">#&gt; [274] 938.7728 940.8177 942.7638 947.7443 964.7811 973.4945</span></a>
<a class="sourceLine" id="cb8-51" data-line-number="51">std<span class="op">$</span>rt[index<span class="op">==</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb8-52" data-line-number="52"><span class="co">#&gt;   [1]  216.1970 1079.6500  165.6830  212.6550  639.3135  144.8960  161.8250</span></a>
<a class="sourceLine" id="cb8-53" data-line-number="53"><span class="co">#&gt;   [8]  511.2940 1079.4300   85.4930   48.6340   85.3855  219.5120   70.2770</span></a>
<a class="sourceLine" id="cb8-54" data-line-number="54"><span class="co">#&gt;  [15]  804.4690  785.8260  218.6020  227.6550  145.5380  470.3640  389.9630</span></a>
<a class="sourceLine" id="cb8-55" data-line-number="55"><span class="co">#&gt;  [22]  430.6780  612.9110  144.0560   76.2780  511.2940  226.0540  478.9360</span></a>
<a class="sourceLine" id="cb8-56" data-line-number="56"><span class="co">#&gt;  [29]  511.2940  614.4130  639.3140  615.0530  639.2075  462.2210  611.4130</span></a>
<a class="sourceLine" id="cb8-57" data-line-number="57"><span class="co">#&gt;  [36]  594.9115  169.7485  638.8870  639.3130  169.5380 1029.1800  213.7270</span></a>
<a class="sourceLine" id="cb8-58" data-line-number="58"><span class="co">#&gt;  [43]  576.9100  576.9100  639.1010  631.5560  747.3660  780.5760  216.0600</span></a>
<a class="sourceLine" id="cb8-59" data-line-number="59"><span class="co">#&gt;  [50]  509.7940  605.8400  639.1000  145.9660  556.7660  491.1510  408.3895</span></a>
<a class="sourceLine" id="cb8-60" data-line-number="60"><span class="co">#&gt;  [57]  473.1445  416.1050  633.3765  146.3950  452.5345  880.3720  572.8400</span></a>
<a class="sourceLine" id="cb8-61" data-line-number="61"><span class="co">#&gt;  [64]  604.7690  838.9070  767.5050  823.9060  681.3155  744.1460  781.0040</span></a>
<a class="sourceLine" id="cb8-62" data-line-number="62"><span class="co">#&gt;  [71]  141.0400  336.5620  169.5500  482.5790  491.1510  639.1000  762.5750</span></a>
<a class="sourceLine" id="cb8-63" data-line-number="63"><span class="co">#&gt;  [78]  679.6010    3.9535  564.8035  732.0395  618.2710  145.0030  360.5630</span></a>
<a class="sourceLine" id="cb8-64" data-line-number="64"><span class="co">#&gt;  [85]  145.6800  618.4830  212.8675  636.9570  581.3045  145.2280  639.1000</span></a>
<a class="sourceLine" id="cb8-65" data-line-number="65"><span class="co">#&gt;  [92]  509.1510  509.3650  596.4120  581.4100  594.9125  543.4380  145.4960</span></a>
<a class="sourceLine" id="cb8-66" data-line-number="66"><span class="co">#&gt;  [99]  172.7590  717.1835  136.3250  144.0390  749.9320  594.4820  594.4830</span></a>
<a class="sourceLine" id="cb8-67" data-line-number="67"><span class="co">#&gt; [106]  639.0990  550.5530  639.0970  613.1270  213.9270  639.0990  561.9110</span></a>
<a class="sourceLine" id="cb8-68" data-line-number="68"><span class="co">#&gt; [113]  644.2420  585.2700  644.2430  682.3870  551.8380  523.5950  218.8600</span></a>
<a class="sourceLine" id="cb8-69" data-line-number="69"><span class="co">#&gt; [120]  557.8390  215.8460  577.9840  605.5200  547.0180  493.0800  493.3975</span></a>
<a class="sourceLine" id="cb8-70" data-line-number="70"><span class="co">#&gt; [127]  665.0280  551.6260  682.3135  492.2220  632.8410  601.4480  656.0290</span></a>
<a class="sourceLine" id="cb8-71" data-line-number="71"><span class="co">#&gt; [134]  639.5290  404.7480  601.1275  404.5330  519.0090  762.3630  762.3610</span></a>
<a class="sourceLine" id="cb8-72" data-line-number="72"><span class="co">#&gt; [141]  639.3130  656.2430  643.3840  717.1020  212.6570  404.7480  543.8650</span></a>
<a class="sourceLine" id="cb8-73" data-line-number="73"><span class="co">#&gt; [148]  717.0775  582.3755  218.1010  540.6520  817.9060  803.7190  782.9350</span></a>
<a class="sourceLine" id="cb8-74" data-line-number="74"><span class="co">#&gt; [155]  536.5800  477.4360  422.9630  492.2230  511.5080  423.1770  532.7230</span></a>
<a class="sourceLine" id="cb8-75" data-line-number="75"><span class="co">#&gt; [162]  550.3385  215.7020  540.8620  144.7890  762.3620  546.4830  639.0980</span></a>
<a class="sourceLine" id="cb8-76" data-line-number="76"><span class="co">#&gt; [169]  142.3240  217.0145  639.0995  639.3130  762.5740  537.2240  705.4235</span></a>
<a class="sourceLine" id="cb8-77" data-line-number="77"><span class="co">#&gt; [176]  492.4360  511.2270  627.8060  512.7070  340.9965  546.8030  508.5080</span></a>
<a class="sourceLine" id="cb8-78" data-line-number="78"><span class="co">#&gt; [183]  534.0090  215.7865  434.7490  439.2500  213.5090  216.9670  213.5090</span></a>
<a class="sourceLine" id="cb8-79" data-line-number="79"><span class="co">#&gt; [190]  213.9410  819.1920  818.8705  618.4850  530.7950  642.7435  145.1850</span></a>
<a class="sourceLine" id="cb8-80" data-line-number="80"><span class="co">#&gt; [197]  214.1780  818.9790  215.7110  800.2900  527.7950  800.2900  213.3840</span></a>
<a class="sourceLine" id="cb8-81" data-line-number="81"><span class="co">#&gt; [204]  527.7950  638.8870  819.4080  638.8870  214.3560  468.4360  551.4100</span></a>
<a class="sourceLine" id="cb8-82" data-line-number="82"><span class="co">#&gt; [211]  883.1575  215.9255  213.1890  594.0550  594.0560  698.6730  218.0975</span></a>
<a class="sourceLine" id="cb8-83" data-line-number="83"><span class="co">#&gt; [218]  639.1005  663.7645  213.9270  639.2070  594.4830  214.8000  883.9070</span></a>
<a class="sourceLine" id="cb8-84" data-line-number="84"><span class="co">#&gt; [225]  215.4870  212.6510  538.8305  214.1480  481.2930  214.3560  370.5620</span></a>
<a class="sourceLine" id="cb8-85" data-line-number="85"><span class="co">#&gt; [232]  214.1480  214.5700  214.9615  519.6690  214.7290  780.5760  213.4660</span></a>
<a class="sourceLine" id="cb8-86" data-line-number="86"><span class="co">#&gt; [239]  520.0790  665.0290  213.5090  214.4150  213.3340  215.2830  628.5550</span></a>
<a class="sourceLine" id="cb8-87" data-line-number="87"><span class="co">#&gt; [246]  646.6000  698.2460  214.4150  213.5055  215.8575  639.2070  213.3840</span></a>
<a class="sourceLine" id="cb8-88" data-line-number="88"><span class="co">#&gt; [253]  493.9370  639.1010  213.5090  639.2070  213.5480  381.9255  214.2320</span></a>
<a class="sourceLine" id="cb8-89" data-line-number="89"><span class="co">#&gt; [260]  632.1990  213.5090  213.5140  217.3700  215.0690  215.4870  213.7720</span></a>
<a class="sourceLine" id="cb8-90" data-line-number="90"><span class="co">#&gt; [267]  213.3595  213.0430  214.4360  214.9660  214.6500  215.2830  476.5790</span></a>
<a class="sourceLine" id="cb8-91" data-line-number="91"><span class="co">#&gt; [274]  216.4125  213.5480  636.9060  800.0770  215.6320  500.9015</span></a></code></pre></div>
</div>
<div id="validation-by-principal-components-analysispca" class="section level3">
<h3 class="hasAnchor">
<a href="#validation-by-principal-components-analysispca" class="anchor"></a>Validation by principal components analysis(PCA)</h3>
<p>You need to check the GlobalStd algorithmâ€™s results by principal components analysis(PCA).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(enviGCMS)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data,<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(std<span class="op">$</span>group)),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(all peaks)"</span>)))</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data[std<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(std<span class="op">$</span>group)),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))</a></code></pre></div>
<p><img src="globalstd_files/figure-html/pca-1.png" width="700"></p>
</div>
<div id="comparision-with-other-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#comparision-with-other-packages" class="anchor"></a>Comparision with other packages</h3>
<p>GlobalStd algorithm in <code>pmd</code> package could be treated as a way to extract pseudospectra. You could use <code>getcluster</code> to get peaks groups information for all GlobalStd peaks. Then you could choose export peaks with the highest intensities in each GlobalStd peaks groups.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">stdcluster &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getcluster.html">getcluster</a></span>(std)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co"># extract pseudospectra for std peak 1</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(stdcluster<span class="op">$</span>cluster<span class="op">$</span>stdmassg[stdcluster<span class="op">$</span>cluster<span class="op">$</span>i<span class="op">==</span><span class="dv">42</span>],stdcluster<span class="op">$</span>cluster<span class="op">$</span>ins[stdcluster<span class="op">$</span>cluster<span class="op">$</span>i<span class="op">==</span><span class="dv">42</span>],<span class="dt">type =</span> <span class="st">'h'</span>,<span class="dt">xlab =</span> <span class="st">'m/z'</span>,<span class="dt">ylab =</span> <span class="st">'intensity'</span>,<span class="dt">main =</span> <span class="st">'pseudospectra for GlobalStd peak 42'</span>)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/comp-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># export peaks with the highest intensities in each GlobalStd peaks groups.</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">data &lt;-<span class="st"> </span>stdcluster<span class="op">$</span>data[stdcluster<span class="op">$</span>stdmassindex2,]</a></code></pre></div>
<p>You could also use <code>getcorcluster</code> to find peaks groups by correlation analysis only.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">corcluster &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getcorcluster.html">getcorcluster</a></span>(spmeinvivo)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co">#&gt; 75 retention time cluster found.</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data,<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(std<span class="op">$</span>group)),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(all peaks)"</span>)))</a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data[std<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(std<span class="op">$</span>group)),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))</a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data[corcluster<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(std<span class="op">$</span>group)),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks by correlationship)"</span>)))</a></code></pre></div>
<p><img src="globalstd_files/figure-html/corcomp-1.png" width="700"></p>
</div>
<div id="globalstd-algorithm-with-intensity-data" class="section level3">
<h3 class="hasAnchor">
<a href="#globalstd-algorithm-with-intensity-data" class="anchor"></a>GlobalStd algorithm with intensity data</h3>
<p>GlobalStd algorithm is designed to analysis data without intensity data. However, if you have intensity data, the independant peaks could be selected with more confindence. You could set up cutoff of Pearson Correlation Coefficient between peaks to refine the peaks selected by GlobalStd within same retention time groups.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">std2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getstd.html">getstd</a></span>(pmd,<span class="dt">corcutoff =</span> <span class="fl">0.9</span>)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="co">#&gt; 24 group(s) with multiple peaks while no isotope/paired relationship</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="co">#&gt; 12 group(s) with multiple peaks with isotope without paired relationship</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co">#&gt; 3 group(s) with paired relationship without isotope</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="co">#&gt; 28 group(s) with paired relationship and isotope</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co">#&gt; 116 std mass found.</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="co">#&gt; 8 retention group(s) have single peaks.</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std2<span class="op">$</span>data,<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(std2<span class="op">$</span>group)),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(all peaks)"</span>)))</a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std<span class="op">$</span>data[std<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(std<span class="op">$</span>group)),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))</a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/plotpca">plotpca</a></span>(std2<span class="op">$</span>data[std2<span class="op">$</span>stdmassindex,],<span class="dt">lv =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(std2<span class="op">$</span>group)),<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substitute">substitute</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/plotmath">italic</a></span>(<span class="st">'in vivo'</span>), <span class="st">" SPME samples(selected peaks)"</span>)))</a></code></pre></div>
<p><img src="globalstd_files/figure-html/globalcor-1.png" width="700"></p>
</div>
</div>
<div id="structurereaction-directed-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#structurereaction-directed-analysis" class="anchor"></a>Structure/Reaction directed analysis</h2>
<p><code>getsda</code> function could be used to perform Structure/reaction directed analysis. <code>freqcutoff</code> could be used to filter the PMD with high frequncy.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">sda &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getsda.html">getsda</a></span>(std, <span class="dt">freqcutoff =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="co">#&gt; Top 50 high frequency PMD groups were remained.</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="co">#&gt; 18 groups were found as high frequency PMD group.</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="co">#&gt; 0 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="co">#&gt; 1.98 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">#&gt; 2.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="co">#&gt; 13.98 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="co">#&gt; 14.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="co">#&gt; 14.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="co">#&gt; 15.99 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"><span class="co">#&gt; 16.03 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12"><span class="co">#&gt; 28.03 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13"><span class="co">#&gt; 30.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="co">#&gt; 42.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-15" data-line-number="15"><span class="co">#&gt; 49.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-16" data-line-number="16"><span class="co">#&gt; 58.04 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-17" data-line-number="17"><span class="co">#&gt; 66.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-18" data-line-number="18"><span class="co">#&gt; 68.06 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-19" data-line-number="19"><span class="co">#&gt; 82.08 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-20" data-line-number="20"><span class="co">#&gt; 116.08 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb14-21" data-line-number="21"><span class="co">#&gt; 126.14 were found as high frequency PMD.</span></a></code></pre></div>
<p>You could use <code>plotstdsda</code> to show the distribution of the selected paired peaks.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/stdsda-1.png" width="700"></p>
<p>You could also use index to show the distribution of certain PMDs.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>,<span class="dv">3</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">13.98</span>)</a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">15.99</span>)</a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">14.02</span>)</a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">28.03</span>)</a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sda,sda<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">58.04</span>)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/stdsdaidx-1.png" width="700"></p>
<p>Structure/reaction directed analysis could be directily performed on all the peaks, which is slow to process:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">sdaall &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getsda.html">getsda</a></span>(spmeinvivo)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>,<span class="dv">3</span>),<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">13.98</span>)</a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">15.99</span>)</a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">14.02</span>)</a>
<a class="sourceLine" id="cb17-7" data-line-number="7"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">28.03</span>)</a>
<a class="sourceLine" id="cb17-8" data-line-number="8"><span class="kw"><a href="../reference/plotstdsda.html">plotstdsda</a></span>(sdaall,sdaall<span class="op">$</span>sda<span class="op">$</span>diff2 <span class="op">==</span><span class="st"> </span><span class="fl">58.04</span>)</a></code></pre></div>
<div id="structurereaction-directed-analysis-for-peakscompounds-only" class="section level3">
<h3 class="hasAnchor">
<a href="#structurereaction-directed-analysis-for-peakscompounds-only" class="anchor"></a>Structure/reaction directed analysis for peaks/compounds only</h3>
<p>When you only have data of peaks without retention time or compounds list, structure/reaction directed analysis could also be done by <code>getrda</code> function.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">sda &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getrda.html">getrda</a></span>(spmeinvivo<span class="op">$</span>mz[std<span class="op">$</span>stdmassindex])</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="co">#&gt; 28374 pmd found.</span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="co">#&gt; 9 pmd used.</span></a></code></pre></div>
</div>
<div id="structurereaction-network" class="section level3">
<h3 class="hasAnchor">
<a href="#structurereaction-network" class="anchor"></a>Structure/Reaction Network</h3>
<p>One peak or compounds could be involved in multiple reactions. You could construct a network by such relationship.</p>
<p>If you have a specific compound and want to check the metabolites of certain PMD, you could use <code>getchain</code> to extract the network of that compounds</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(igraph)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="co">#&gt; Attaching package: 'igraph'</span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="co">#&gt; The following objects are masked from 'package:stats':</span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="co">#&gt;     decompose, spectrum</span></a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="co">#&gt; The following object is masked from 'package:base':</span></a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb19-9" data-line-number="9"><span class="co">#&gt;     union</span></a>
<a class="sourceLine" id="cb19-10" data-line-number="10"><span class="co"># check metabolites of C18H39NO</span></a>
<a class="sourceLine" id="cb19-11" data-line-number="11">chain &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getchain.html">getchain</a></span>(spmeinvivo,<span class="dt">diff =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">2.02</span>,<span class="fl">14.02</span>,<span class="fl">15.99</span>,<span class="fl">58.04</span>,<span class="fl">13.98</span>),<span class="dt">mass =</span> <span class="fl">286.3101</span>)</a>
<a class="sourceLine" id="cb19-12" data-line-number="12"><span class="co"># show as network</span></a>
<a class="sourceLine" id="cb19-13" data-line-number="13">net &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/graph_from_data_frame">graph_from_data_frame</a></span>(chain<span class="op">$</span>sdac,<span class="dt">directed =</span> F)</a>
<a class="sourceLine" id="cb19-14" data-line-number="14"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(net,<span class="dt">vertex.label=</span><span class="ot">NA</span>,<span class="dt">vertex.size =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>((<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/V">V</a></span>(net))))<span class="op">/</span><span class="dv">25</span>,<span class="dt">edge.width =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/E">E</a></span>(net)<span class="op">$</span>diff2<span class="op">/</span><span class="dv">20</span><span class="fl">+0.00001</span>)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/tarnet-1.png" width="700"></p>
<p>If you want to see all the independant peaksâ€™ high frequency PMDs as a network, the following code will help</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">sda &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getsda.html">getsda</a></span>(std, <span class="dt">freqcutoff =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="co">#&gt; Top 50 high frequency PMD groups were remained.</span></a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="co">#&gt; 18 groups were found as high frequency PMD group.</span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="co">#&gt; 0 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="co">#&gt; 1.98 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6"><span class="co">#&gt; 2.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="co">#&gt; 13.98 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="co">#&gt; 14.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="co">#&gt; 14.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-10" data-line-number="10"><span class="co">#&gt; 15.99 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-11" data-line-number="11"><span class="co">#&gt; 16.03 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-12" data-line-number="12"><span class="co">#&gt; 28.03 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-13" data-line-number="13"><span class="co">#&gt; 30.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-14" data-line-number="14"><span class="co">#&gt; 42.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-15" data-line-number="15"><span class="co">#&gt; 49.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-16" data-line-number="16"><span class="co">#&gt; 58.04 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-17" data-line-number="17"><span class="co">#&gt; 66.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-18" data-line-number="18"><span class="co">#&gt; 68.06 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-19" data-line-number="19"><span class="co">#&gt; 82.08 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-20" data-line-number="20"><span class="co">#&gt; 116.08 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb20-21" data-line-number="21"><span class="co">#&gt; 126.14 were found as high frequency PMD.</span></a>
<a class="sourceLine" id="cb20-22" data-line-number="22">df &lt;-<span class="st"> </span>sda<span class="op">$</span>sda</a>
<a class="sourceLine" id="cb20-23" data-line-number="23">net &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/graph_from_data_frame">graph_from_data_frame</a></span>(df,<span class="dt">directed =</span> F)</a>
<a class="sourceLine" id="cb20-24" data-line-number="24"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(net,<span class="dt">vertex.label=</span><span class="ot">NA</span>,<span class="dt">vertex.size =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>((<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/V">V</a></span>(net))))<span class="op">/</span><span class="dv">25</span>,<span class="dt">edge.width =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/E">E</a></span>(net)<span class="op">$</span>diff2<span class="op">/</span><span class="dv">20</span><span class="fl">+0.00001</span>)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/net-1.png" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="co"># Check the degree of the nodes</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="co"># Show the degree distribution of the vertices</span></a>
<a class="sourceLine" id="cb21-3" data-line-number="3">deg &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/degree">degree</a></span>(net, <span class="dt">mode=</span><span class="st">"all"</span>)</a>
<a class="sourceLine" id="cb21-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/degree">degree_distribution</a></span>(net)</a>
<a class="sourceLine" id="cb21-5" data-line-number="5"><span class="co">#&gt;  [1] 0.000000000 0.270270270 0.207207207 0.099099099 0.090090090</span></a>
<a class="sourceLine" id="cb21-6" data-line-number="6"><span class="co">#&gt;  [6] 0.072072072 0.054054054 0.081081081 0.027027027 0.054054054</span></a>
<a class="sourceLine" id="cb21-7" data-line-number="7"><span class="co">#&gt; [11] 0.009009009 0.000000000 0.009009009 0.000000000 0.000000000</span></a>
<a class="sourceLine" id="cb21-8" data-line-number="8"><span class="co">#&gt; [16] 0.000000000 0.018018018 0.000000000 0.000000000 0.000000000</span></a>
<a class="sourceLine" id="cb21-9" data-line-number="9"><span class="co">#&gt; [21] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000</span></a>
<a class="sourceLine" id="cb21-10" data-line-number="10"><span class="co">#&gt; [26] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000</span></a>
<a class="sourceLine" id="cb21-11" data-line-number="11"><span class="co">#&gt; [31] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000</span></a>
<a class="sourceLine" id="cb21-12" data-line-number="12"><span class="co">#&gt; [36] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000</span></a>
<a class="sourceLine" id="cb21-13" data-line-number="13"><span class="co">#&gt; [41] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000</span></a>
<a class="sourceLine" id="cb21-14" data-line-number="14"><span class="co">#&gt; [46] 0.000000000 0.000000000 0.000000000 0.009009009</span></a>
<a class="sourceLine" id="cb21-15" data-line-number="15"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(net, <span class="dt">vertex.size=</span>deg<span class="op">/</span><span class="dv">2</span>,<span class="dt">vertex.label=</span><span class="ot">NA</span>,<span class="dt">vertex.size =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>((<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/V">V</a></span>(net))))<span class="op">/</span><span class="dv">25</span>, <span class="dt">edge.width =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/E">E</a></span>(net)<span class="op">$</span>diff2<span class="op">/</span><span class="dv">20</span><span class="fl">+0.00001</span>)</a></code></pre></div>
<p><img src="globalstd_files/figure-html/net-2.png" width="700"></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="co"># network community structure detection</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2">ceb &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/cluster_edge_betweenness">cluster_edge_betweenness</a></span>(net,<span class="dt">weights =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/E">E</a></span>(net)<span class="op">$</span>cor), <span class="dt">directed =</span> F) </a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="co">#&gt; Warning in cluster_edge_betweenness(net, weights = abs(E(net)$cor),</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="co">#&gt; directed = F): At community.c:460 :Membership vector will be selected based</span></a>
<a class="sourceLine" id="cb22-5" data-line-number="5"><span class="co">#&gt; on the lowest modularity score.</span></a>
<a class="sourceLine" id="cb22-6" data-line-number="6"><span class="co">#&gt; Warning in cluster_edge_betweenness(net, weights = abs(E(net)$cor),</span></a>
<a class="sourceLine" id="cb22-7" data-line-number="7"><span class="co">#&gt; directed = F): At community.c:467 :Modularity calculation with weighted</span></a>
<a class="sourceLine" id="cb22-8" data-line-number="8"><span class="co">#&gt; edge betweenness community detection might not make sense -- modularity</span></a>
<a class="sourceLine" id="cb22-9" data-line-number="9"><span class="co">#&gt; treats edge weights as similarities while edge betwenness treats them as</span></a>
<a class="sourceLine" id="cb22-10" data-line-number="10"><span class="co">#&gt; distances</span></a>
<a class="sourceLine" id="cb22-11" data-line-number="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(ceb, net,<span class="dt">vertex.label=</span><span class="ot">NA</span>,) </a></code></pre></div>
<p><img src="globalstd_files/figure-html/net-3.png" width="700"></p>
</div>
</div>
<div id="parameters-selection" class="section level2">
<h2 class="hasAnchor">
<a href="#parameters-selection" class="anchor"></a>Parameters selection</h2>
<p>Retention time cluster cutoff should fit the peak picking algorithm. For HPLC, 10 is suggested and 5 could be used for UPLC.</p>
<p>Global PMDâ€™s retention time group numbers should be around 20 percent of the retention time cluster numbers. For example, if you find 100 retention time clusters, I suggested you use 20 as the empirical global PMDâ€™s retention time group numbers.</p>
<p>As for the cutoff of the frequency of PMDs, you could change the frequency until you find certain PMD which youâ€™re sure that it should appear in your dataset. For example, 16 should be considered as a good start. Any pmd with the frequency larger than PMD 16 could be further discussed.</p>
<p>Another important hint is that pre-filter your peak list by black samples or other quality control samples. Otherwise the running time would be long and lots of pmd relationship would be just from noise.</p>
</div>
<div id="wrap-function" class="section level2">
<h2 class="hasAnchor">
<a href="#wrap-function" class="anchor"></a>Wrap function</h2>
<p><code>globalstd</code> function is a wrap funtion to process GlobalStd algorithm and structure/reaction directed analysis in one line. All the plot function could be directly used on the <code>list</code> objects from <code>globalstd</code> function.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">result &lt;-<span class="st"> </span><span class="kw"><a href="../reference/globalstd.html">globalstd</a></span>(spmeinvivo)</a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="co">#&gt; 75 retention time cluster found.</span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="co">#&gt; 435 paired masses found</span></a>
<a class="sourceLine" id="cb23-4" data-line-number="4"><span class="co">#&gt; 10 unique within RT clusters high frequency PMD(s) used for further investigation.</span></a>
<a class="sourceLine" id="cb23-5" data-line-number="5"><span class="co">#&gt; 583 isotopologue(s) related paired mass found.</span></a>
<a class="sourceLine" id="cb23-6" data-line-number="6"><span class="co">#&gt; 685 multi-charger(s) related paired mass found.</span></a>
<a class="sourceLine" id="cb23-7" data-line-number="7"><span class="co">#&gt; 11 group(s) with multiple peaks while no isotope/paired relationship</span></a>
<a class="sourceLine" id="cb23-8" data-line-number="8"><span class="co">#&gt; 8 group(s) with multiple peaks with isotope without paired relationship</span></a>
<a class="sourceLine" id="cb23-9" data-line-number="9"><span class="co">#&gt; 4 group(s) with paired relationship without isotope</span></a>
<a class="sourceLine" id="cb23-10" data-line-number="10"><span class="co">#&gt; 44 group(s) with paired relationship and isotope</span></a>
<a class="sourceLine" id="cb23-11" data-line-number="11"><span class="co">#&gt; 257 std mass found.</span></a>
<a class="sourceLine" id="cb23-12" data-line-number="12"><span class="co">#&gt; 8 retention group(s) have single peaks.</span></a>
<a class="sourceLine" id="cb23-13" data-line-number="13"><span class="co">#&gt; Top 50 high frequency PMD groups were remained.</span></a>
<a class="sourceLine" id="cb23-14" data-line-number="14"><span class="co">#&gt; 18 groups were found as high frequency PMD group.</span></a>
<a class="sourceLine" id="cb23-15" data-line-number="15"><span class="co">#&gt; 0 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-16" data-line-number="16"><span class="co">#&gt; 1.98 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-17" data-line-number="17"><span class="co">#&gt; 2.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-18" data-line-number="18"><span class="co">#&gt; 13.98 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-19" data-line-number="19"><span class="co">#&gt; 14.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-20" data-line-number="20"><span class="co">#&gt; 14.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-21" data-line-number="21"><span class="co">#&gt; 15.99 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-22" data-line-number="22"><span class="co">#&gt; 16.03 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-23" data-line-number="23"><span class="co">#&gt; 28.03 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-24" data-line-number="24"><span class="co">#&gt; 30.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-25" data-line-number="25"><span class="co">#&gt; 42.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-26" data-line-number="26"><span class="co">#&gt; 49.02 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-27" data-line-number="27"><span class="co">#&gt; 58.04 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-28" data-line-number="28"><span class="co">#&gt; 66.05 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-29" data-line-number="29"><span class="co">#&gt; 68.06 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-30" data-line-number="30"><span class="co">#&gt; 82.08 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-31" data-line-number="31"><span class="co">#&gt; 116.08 were found as high frequency PMD. </span></a>
<a class="sourceLine" id="cb23-32" data-line-number="32"><span class="co">#&gt; 126.14 were found as high frequency PMD.</span></a></code></pre></div>
</div>
<div id="shiny-application" class="section level2">
<h2 class="hasAnchor">
<a href="#shiny-application" class="anchor"></a>Shiny application</h2>
<p>An interactive document has been included in this package to show PMD analysis. You could run <code><a href="../reference/runPMD.html">runPMD()</a></code> to start the Graphical user interface(GUI) for GlobalStd algorithm and structure/reaction directed analysis. You need to prepare a csv file with m/z and retention time of peaks. Such csv file could be generated by run <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrtcsv">enviGCMS::getmzrtcsv()</a></code> on the <code>list</code> object from <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt">enviGCMS::getmzrt(xset)</a></code> or <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt2">enviGCMS::getmzrt2(xset)</a></code> function. You could also generate the csv file by <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt">enviGCMS::getmzrt(xset,name = 'test')</a></code> or <code><a href="https://www.rdocumentation.org/packages/enviGCMS/topics/getmzrt2">enviGCMS::getmzrt2(xset, name = 'test')</a></code>. You will find the csv file in the working dictionary named <code>test.csv</code>.</p>
</div>
<div id="conclusion" class="section level2">
<h2 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h2>
<p><code>pmd</code> package could be used to reduce the redundancy peaks for GC/LC-MS based research and perform structure/reaction directed analysis to screen known and unknown important compounds or reactions.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction-of-paired-mass-distance-analysis">Introduction of Paired Mass Distance analysis</a></li>
      <li><a href="#data-format">Data format</a></li>
      <li><a href="#globalstd-algorithm">GlobalStd algorithm</a></li>
      <li><a href="#structurereaction-directed-analysis">Structure/Reaction directed analysis</a></li>
      <li><a href="#parameters-selection">Parameters selection</a></li>
      <li><a href="#wrap-function">Wrap function</a></li>
      <li><a href="#shiny-application">Shiny application</a></li>
      <li><a href="#conclusion">Conclusion</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Miao YU.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
